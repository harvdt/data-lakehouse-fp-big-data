2024-12-19 11:53:52,423 - __main__ - INFO - Starting enhanced model training process...
2024-12-19 11:54:05,444 - __main__ - INFO - Successfully loaded tables:
2024-12-19 11:54:05,445 - __main__ - INFO - Revenue: (25, 6)
2024-12-19 11:54:05,445 - __main__ - INFO - Discount: (25, 7)
2024-12-19 11:54:05,445 - __main__ - INFO - Price Correlation: (25, 6)
2024-12-19 11:54:05,445 - __main__ - INFO - Reviews: (25, 7)
2024-12-19 11:54:05,448 - __main__ - INFO - Found categories: ['ART AND CRAFTING MATERIALS', 'BATH AND BODY', 'BEDSHEETS', 'BICYCLES', 'BLANKETS', 'BOOKS', 'CANDLES', 'CLOTHING', 'COATS AND JACKETS', 'COOKWARE', 'DRINKWARE', 'ELECTRONICS', 'HOME & KITCHEN', 'MAKEUP', 'MOBILE PHONE ACCESSORIES', 'MOTOR VEHICLE PARTS', 'NAIL CARE', 'PERFUME AND COLOGNE', 'POSTERS AND ARTWORK', 'SKIN CARE', 'SOCKS', 'TOYS & GAMES', 'UNDERWEAR', 'VITAMINS AND SUPPLEMENTS', 'WINE']
2024-12-19 11:54:05,461 - __main__ - INFO - Final merged dataset shape: (25, 23)
2024-12-19 11:54:05,461 - __main__ - INFO - Available columns: ['Category', 'TotalRevenue', 'TotalSales', 'AveragePrice', 'ProductCount', 'AvgDiscountPercentage', 'AvgDiscountPercentage_disc', 'TotalDiscountedRevenue', 'PotentialRevenue', 'AvgSales', 'RevenueLossFromDiscount', 'DiscountROI', 'PriceRatingCorrelation', 'AvgPrice', 'AvgRating', 'AvgReviews', 'PriceRatingRelationship', 'TotalReviews', 'TotalSales_review', 'AvgRating_review', 'HighRatingCount', 'ReviewToSalesRatio', 'CustomerEngagementLevel']
2024-12-19 11:54:05,807 - __main__ - INFO - Created advanced features. Shape: (25, 44)
2024-12-19 11:54:05,807 - __main__ - INFO - Number of numeric features: 23
2024-12-19 11:54:05,807 - __main__ - INFO - Number of categorical features: 3
2024-12-19 11:54:05,811 - __main__ - INFO - Training stacked model...
2024-12-19 11:54:05,845 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 11:54:05,858 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 11:54:05,864 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 11:54:05,870 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 11:54:05,876 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 11:54:05,883 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 11:54:05,890 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 11:54:05,896 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 11:54:05,902 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 11:54:05,913 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 11:54:05,922 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 11:54:05,946 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 11:54:05,956 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 11:54:05,956 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 11:54:05,976 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 11:54:05,991 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 11:54:06,010 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 11:54:06,351 - py4j.clientserver - INFO - Error while sending or receiving.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer
2024-12-19 11:54:06,354 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 11:54:06,355 - root - INFO - Exception while sending command.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 506, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending
2024-12-19 11:54:06,362 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 11:54:09,808 - __main__ - INFO - Model Performance:
2024-12-19 11:54:09,808 - __main__ - INFO - RÂ² score: 0.9832
2024-12-19 11:54:09,808 - __main__ - INFO - MSE: 5020.8544
2024-12-19 11:54:09,809 - __main__ - INFO - RMSE: 70.8580
2024-12-19 11:54:09,809 - __main__ - INFO - MAE: 60.7211
2024-12-19 11:54:09,810 - __main__ - WARNING - Feature importance length mismatch: 3 vs 53
2024-12-19 11:54:09,812 - __main__ - INFO - 
Top 10 Most Important Features:
2024-12-19 11:54:09,812 - __main__ - INFO -                  feature  importance  importance_percentage
1  AvgDiscountPercentage    0.541399              54.139880
0           AveragePrice    0.408668              40.866799
2              AvgRating    0.049933               4.993321
2024-12-19 11:54:09,966 - __main__ - INFO - Model saved to /home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/src/models/training/trained_models/sales_predictor.joblib
2024-12-19 11:54:10,529 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 11:55:18,507 - __main__ - INFO - Starting enhanced model training process...
2024-12-19 11:55:26,750 - __main__ - INFO - Successfully loaded tables:
2024-12-19 11:55:26,750 - __main__ - INFO - Revenue: (25, 6)
2024-12-19 11:55:26,751 - __main__ - INFO - Discount: (25, 7)
2024-12-19 11:55:26,751 - __main__ - INFO - Price Correlation: (25, 6)
2024-12-19 11:55:26,752 - __main__ - INFO - Reviews: (25, 7)
2024-12-19 11:55:26,753 - __main__ - INFO - Found categories: ['ART AND CRAFTING MATERIALS', 'BATH AND BODY', 'BEDSHEETS', 'BICYCLES', 'BLANKETS', 'BOOKS', 'CANDLES', 'CLOTHING', 'COATS AND JACKETS', 'COOKWARE', 'DRINKWARE', 'ELECTRONICS', 'HOME & KITCHEN', 'MAKEUP', 'MOBILE PHONE ACCESSORIES', 'MOTOR VEHICLE PARTS', 'NAIL CARE', 'PERFUME AND COLOGNE', 'POSTERS AND ARTWORK', 'SKIN CARE', 'SOCKS', 'TOYS & GAMES', 'UNDERWEAR', 'VITAMINS AND SUPPLEMENTS', 'WINE']
2024-12-19 11:55:26,764 - __main__ - INFO - Final merged dataset shape: (25, 23)
2024-12-19 11:55:26,764 - __main__ - INFO - Available columns: ['Category', 'TotalRevenue', 'TotalSales', 'AveragePrice', 'ProductCount', 'AvgDiscountPercentage', 'AvgDiscountPercentage_disc', 'TotalDiscountedRevenue', 'PotentialRevenue', 'AvgSales', 'RevenueLossFromDiscount', 'DiscountROI', 'PriceRatingCorrelation', 'AvgPrice', 'AvgRating', 'AvgReviews', 'PriceRatingRelationship', 'TotalReviews', 'TotalSales_review', 'AvgRating_review', 'HighRatingCount', 'ReviewToSalesRatio', 'CustomerEngagementLevel']
2024-12-19 11:55:26,867 - __main__ - INFO - Created advanced features. Shape: (25, 44)
2024-12-19 11:55:26,867 - __main__ - INFO - Number of numeric features: 23
2024-12-19 11:55:26,867 - __main__ - INFO - Number of categorical features: 3
2024-12-19 11:55:26,871 - __main__ - INFO - Training stacked model...
2024-12-19 11:55:26,905 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 11:55:26,917 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 11:55:26,924 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 11:55:26,930 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 11:55:26,937 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 11:55:26,944 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 11:55:26,957 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 11:55:26,964 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 11:55:26,976 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 11:55:27,000 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 11:55:27,021 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 11:55:27,029 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 11:55:27,030 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 11:55:27,049 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 11:55:27,093 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 11:55:27,136 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 11:55:27,183 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 11:55:28,767 - py4j.clientserver - INFO - Error while sending or receiving.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer
2024-12-19 11:55:28,768 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 11:55:28,768 - root - INFO - Exception while sending command.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 506, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending
2024-12-19 11:55:28,771 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 11:55:30,823 - __main__ - INFO - Model Performance:
2024-12-19 11:55:30,823 - __main__ - INFO - RÂ² score: 0.9832
2024-12-19 11:55:30,823 - __main__ - INFO - MSE: 5020.8544
2024-12-19 11:55:30,824 - __main__ - INFO - RMSE: 70.8580
2024-12-19 11:55:30,824 - __main__ - INFO - MAE: 60.7211
2024-12-19 11:55:30,825 - __main__ - WARNING - Feature importance length mismatch: 3 vs 53
2024-12-19 11:55:30,827 - __main__ - INFO - 
Top 10 Most Important Features:
2024-12-19 11:55:30,827 - __main__ - INFO -                  feature  importance  importance_percentage
1  AvgDiscountPercentage    0.541399              54.139880
0           AveragePrice    0.408668              40.866799
2              AvgRating    0.049933               4.993321
2024-12-19 11:55:31,053 - __main__ - INFO - Model saved to /home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/src/models/training/trained_models/sales_predictor.joblib
2024-12-19 11:55:31,577 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:19:26,205 - __main__ - INFO - Starting enhanced model training process...
2024-12-19 12:19:39,475 - __main__ - INFO - Successfully loaded tables:
2024-12-19 12:19:39,476 - __main__ - INFO - Revenue: (25, 6)
2024-12-19 12:19:39,476 - __main__ - INFO - Discount: (25, 7)
2024-12-19 12:19:39,476 - __main__ - INFO - Price Correlation: (25, 6)
2024-12-19 12:19:39,476 - __main__ - INFO - Reviews: (25, 7)
2024-12-19 12:19:39,480 - __main__ - INFO - Found categories: ['ART AND CRAFTING MATERIALS', 'BATH AND BODY', 'BEDSHEETS', 'BICYCLES', 'BLANKETS', 'BOOKS', 'CANDLES', 'CLOTHING', 'COATS AND JACKETS', 'COOKWARE', 'DRINKWARE', 'ELECTRONICS', 'HOME & KITCHEN', 'MAKEUP', 'MOBILE PHONE ACCESSORIES', 'MOTOR VEHICLE PARTS', 'NAIL CARE', 'PERFUME AND COLOGNE', 'POSTERS AND ARTWORK', 'SKIN CARE', 'SOCKS', 'TOYS & GAMES', 'UNDERWEAR', 'VITAMINS AND SUPPLEMENTS', 'WINE']
2024-12-19 12:19:39,508 - __main__ - INFO - Final merged dataset shape: (25, 23)
2024-12-19 12:19:39,508 - __main__ - INFO - Available columns: ['Category', 'TotalRevenue', 'TotalSales', 'AveragePrice', 'ProductCount', 'AvgDiscountPercentage', 'AvgDiscountPercentage_disc', 'TotalDiscountedRevenue', 'PotentialRevenue', 'AvgSales', 'RevenueLossFromDiscount', 'DiscountROI', 'PriceRatingCorrelation', 'AvgPrice', 'AvgRating', 'AvgReviews', 'PriceRatingRelationship', 'TotalReviews', 'TotalSales_review', 'AvgRating_review', 'HighRatingCount', 'ReviewToSalesRatio', 'CustomerEngagementLevel']
2024-12-19 12:19:40,368 - __main__ - INFO - Created advanced features. Shape: (25, 44)
2024-12-19 12:19:40,369 - __main__ - INFO - Number of numeric features: 23
2024-12-19 12:19:40,369 - __main__ - INFO - Number of categorical features: 3
2024-12-19 12:19:40,378 - __main__ - INFO - Training stacked model...
2024-12-19 12:19:40,435 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:19:40,467 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:19:40,486 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:19:40,517 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:19:40,535 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:19:40,547 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:19:40,567 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:19:40,574 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:19:40,601 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:19:40,615 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:19:40,624 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:19:40,691 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:19:40,704 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:19:40,753 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:19:40,855 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:19:40,857 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:19:40,869 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:19:43,986 - py4j.clientserver - INFO - Error while sending or receiving.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer
2024-12-19 12:19:44,035 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:19:44,035 - root - INFO - Exception while sending command.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 506, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending
2024-12-19 12:19:44,048 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:19:46,617 - __main__ - INFO - Model Performance:
2024-12-19 12:19:46,617 - __main__ - INFO - RÂ² score: 0.9832
2024-12-19 12:19:46,617 - __main__ - INFO - MSE: 5020.8544
2024-12-19 12:19:46,617 - __main__ - INFO - RMSE: 70.8580
2024-12-19 12:19:46,618 - __main__ - INFO - MAE: 60.7211
2024-12-19 12:19:46,621 - __main__ - WARNING - Feature importance length mismatch: 3 vs 53
2024-12-19 12:19:46,631 - __main__ - INFO - 
Top 10 Most Important Features:
2024-12-19 12:19:46,631 - __main__ - INFO -                  feature  importance  importance_percentage
1  AvgDiscountPercentage    0.541399              54.139880
0           AveragePrice    0.408668              40.866799
2              AvgRating    0.049933               4.993321
2024-12-19 12:19:46,818 - __main__ - INFO - Model saved to /home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/src/models/training/trained_models/sales_predictor.joblib
2024-12-19 12:19:47,291 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:20:10,068 - __main__ - INFO - Starting enhanced model training process...
2024-12-19 12:20:21,912 - __main__ - INFO - Successfully loaded tables:
2024-12-19 12:20:21,913 - __main__ - INFO - Revenue: (25, 6)
2024-12-19 12:20:21,913 - __main__ - INFO - Discount: (25, 7)
2024-12-19 12:20:21,913 - __main__ - INFO - Price Correlation: (25, 6)
2024-12-19 12:20:21,913 - __main__ - INFO - Reviews: (25, 7)
2024-12-19 12:20:21,914 - __main__ - INFO - Found categories: ['ART AND CRAFTING MATERIALS', 'BATH AND BODY', 'BEDSHEETS', 'BICYCLES', 'BLANKETS', 'BOOKS', 'CANDLES', 'CLOTHING', 'COATS AND JACKETS', 'COOKWARE', 'DRINKWARE', 'ELECTRONICS', 'HOME & KITCHEN', 'MAKEUP', 'MOBILE PHONE ACCESSORIES', 'MOTOR VEHICLE PARTS', 'NAIL CARE', 'PERFUME AND COLOGNE', 'POSTERS AND ARTWORK', 'SKIN CARE', 'SOCKS', 'TOYS & GAMES', 'UNDERWEAR', 'VITAMINS AND SUPPLEMENTS', 'WINE']
2024-12-19 12:20:21,922 - __main__ - INFO - Final merged dataset shape: (25, 23)
2024-12-19 12:20:21,922 - __main__ - INFO - Available columns: ['Category', 'TotalRevenue', 'TotalSales', 'AveragePrice', 'ProductCount', 'AvgDiscountPercentage', 'AvgDiscountPercentage_disc', 'TotalDiscountedRevenue', 'PotentialRevenue', 'AvgSales', 'RevenueLossFromDiscount', 'DiscountROI', 'PriceRatingCorrelation', 'AvgPrice', 'AvgRating', 'AvgReviews', 'PriceRatingRelationship', 'TotalReviews', 'TotalSales_review', 'AvgRating_review', 'HighRatingCount', 'ReviewToSalesRatio', 'CustomerEngagementLevel']
2024-12-19 12:20:22,041 - __main__ - INFO - Created advanced features. Shape: (25, 44)
2024-12-19 12:20:22,042 - __main__ - INFO - Number of numeric features: 23
2024-12-19 12:20:22,042 - __main__ - INFO - Number of categorical features: 3
2024-12-19 12:20:22,049 - __main__ - INFO - Training stacked model...
2024-12-19 12:20:22,098 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:20:22,119 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:20:22,128 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:20:22,137 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:20:22,151 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:20:22,156 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:20:22,168 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:20:22,177 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:20:22,211 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:20:22,211 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:20:22,216 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:20:22,237 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:20:22,241 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:20:22,264 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:20:22,289 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:20:22,293 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:20:22,321 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:20:22,647 - py4j.clientserver - INFO - Error while sending or receiving.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer
2024-12-19 12:20:22,661 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:20:22,661 - root - INFO - Exception while sending command.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 506, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending
2024-12-19 12:20:22,672 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:20:25,988 - __main__ - INFO - Model Performance:
2024-12-19 12:20:25,988 - __main__ - INFO - RÂ² score: 0.9832
2024-12-19 12:20:25,988 - __main__ - INFO - MSE: 5020.8544
2024-12-19 12:20:25,988 - __main__ - INFO - RMSE: 70.8580
2024-12-19 12:20:25,988 - __main__ - INFO - MAE: 60.7211
2024-12-19 12:20:25,989 - __main__ - WARNING - Feature importance length mismatch: 3 vs 53
2024-12-19 12:20:25,991 - __main__ - INFO - 
Top 10 Most Important Features:
2024-12-19 12:20:25,991 - __main__ - INFO -                  feature  importance  importance_percentage
1  AvgDiscountPercentage    0.541399              54.139880
0           AveragePrice    0.408668              40.866799
2              AvgRating    0.049933               4.993321
2024-12-19 12:20:26,129 - __main__ - INFO - Model saved to /home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/src/models/training/trained_models/sales_predictor.joblib
2024-12-19 12:20:26,542 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:21:34,844 - __main__ - INFO - Starting enhanced model training process...
2024-12-19 12:21:44,607 - __main__ - INFO - Successfully loaded tables:
2024-12-19 12:21:44,607 - __main__ - INFO - Revenue: (25, 6)
2024-12-19 12:21:44,607 - __main__ - INFO - Discount: (25, 7)
2024-12-19 12:21:44,608 - __main__ - INFO - Price Correlation: (25, 6)
2024-12-19 12:21:44,608 - __main__ - INFO - Reviews: (25, 7)
2024-12-19 12:21:44,608 - __main__ - INFO - Found categories: ['ART AND CRAFTING MATERIALS', 'BATH AND BODY', 'BEDSHEETS', 'BICYCLES', 'BLANKETS', 'BOOKS', 'CANDLES', 'CLOTHING', 'COATS AND JACKETS', 'COOKWARE', 'DRINKWARE', 'ELECTRONICS', 'HOME & KITCHEN', 'MAKEUP', 'MOBILE PHONE ACCESSORIES', 'MOTOR VEHICLE PARTS', 'NAIL CARE', 'PERFUME AND COLOGNE', 'POSTERS AND ARTWORK', 'SKIN CARE', 'SOCKS', 'TOYS & GAMES', 'UNDERWEAR', 'VITAMINS AND SUPPLEMENTS', 'WINE']
2024-12-19 12:21:44,614 - __main__ - INFO - Final merged dataset shape: (25, 23)
2024-12-19 12:21:44,614 - __main__ - INFO - Available columns: ['Category', 'TotalRevenue', 'TotalSales', 'AveragePrice', 'ProductCount', 'AvgDiscountPercentage', 'AvgDiscountPercentage_disc', 'TotalDiscountedRevenue', 'PotentialRevenue', 'AvgSales', 'RevenueLossFromDiscount', 'DiscountROI', 'PriceRatingCorrelation', 'AvgPrice', 'AvgRating', 'AvgReviews', 'PriceRatingRelationship', 'TotalReviews', 'TotalSales_review', 'AvgRating_review', 'HighRatingCount', 'ReviewToSalesRatio', 'CustomerEngagementLevel']
2024-12-19 12:21:45,052 - __main__ - INFO - Created advanced features. Shape: (25, 44)
2024-12-19 12:21:45,052 - __main__ - INFO - Number of numeric features: 23
2024-12-19 12:21:45,052 - __main__ - INFO - Number of categorical features: 3
2024-12-19 12:21:45,055 - __main__ - INFO - Training stacked model...
2024-12-19 12:21:45,084 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:21:45,097 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:21:45,103 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:21:45,109 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:21:45,114 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:21:45,119 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:21:45,127 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:21:45,134 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:21:45,141 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:21:45,149 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:21:45,157 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:21:45,166 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:21:45,194 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:21:45,208 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:21:45,214 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:21:45,230 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:21:45,258 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:21:46,009 - py4j.clientserver - INFO - Error while sending or receiving.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer
2024-12-19 12:21:46,010 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:21:46,010 - root - INFO - Exception while sending command.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 506, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending
2024-12-19 12:21:46,012 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:21:49,401 - __main__ - INFO - Model Performance:
2024-12-19 12:21:49,401 - __main__ - INFO - RÂ² score: 0.9832
2024-12-19 12:21:49,401 - __main__ - INFO - MSE: 5020.8544
2024-12-19 12:21:49,401 - __main__ - INFO - RMSE: 70.8580
2024-12-19 12:21:49,401 - __main__ - INFO - MAE: 60.7211
2024-12-19 12:21:49,402 - __main__ - WARNING - Feature importance length mismatch: 3 vs 53
2024-12-19 12:21:49,404 - __main__ - INFO - 
Top 10 Most Important Features:
2024-12-19 12:21:49,404 - __main__ - INFO -                  feature  importance  importance_percentage
1  AvgDiscountPercentage    0.541399              54.139880
0           AveragePrice    0.408668              40.866799
2              AvgRating    0.049933               4.993321
2024-12-19 12:21:49,542 - __main__ - INFO - Model saved to /home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/src/models/training/trained_models/sales_predictor.joblib
2024-12-19 12:21:49,942 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:22:59,944 - __main__ - INFO - Starting enhanced model training process...
2024-12-19 12:23:11,303 - __main__ - INFO - Successfully loaded tables:
2024-12-19 12:23:11,304 - __main__ - INFO - Revenue: (25, 6)
2024-12-19 12:23:11,304 - __main__ - INFO - Discount: (25, 7)
2024-12-19 12:23:11,304 - __main__ - INFO - Price Correlation: (25, 6)
2024-12-19 12:23:11,304 - __main__ - INFO - Reviews: (25, 7)
2024-12-19 12:23:11,305 - __main__ - INFO - Found categories: ['ART AND CRAFTING MATERIALS', 'BATH AND BODY', 'BEDSHEETS', 'BICYCLES', 'BLANKETS', 'BOOKS', 'CANDLES', 'CLOTHING', 'COATS AND JACKETS', 'COOKWARE', 'DRINKWARE', 'ELECTRONICS', 'HOME & KITCHEN', 'MAKEUP', 'MOBILE PHONE ACCESSORIES', 'MOTOR VEHICLE PARTS', 'NAIL CARE', 'PERFUME AND COLOGNE', 'POSTERS AND ARTWORK', 'SKIN CARE', 'SOCKS', 'TOYS & GAMES', 'UNDERWEAR', 'VITAMINS AND SUPPLEMENTS', 'WINE']
2024-12-19 12:23:11,313 - __main__ - INFO - Final merged dataset shape: (25, 23)
2024-12-19 12:23:11,314 - __main__ - INFO - Available columns: ['Category', 'TotalRevenue', 'TotalSales', 'AveragePrice', 'ProductCount', 'AvgDiscountPercentage', 'AvgDiscountPercentage_disc', 'TotalDiscountedRevenue', 'PotentialRevenue', 'AvgSales', 'RevenueLossFromDiscount', 'DiscountROI', 'PriceRatingCorrelation', 'AvgPrice', 'AvgRating', 'AvgReviews', 'PriceRatingRelationship', 'TotalReviews', 'TotalSales_review', 'AvgRating_review', 'HighRatingCount', 'ReviewToSalesRatio', 'CustomerEngagementLevel']
2024-12-19 12:23:11,703 - __main__ - INFO - Created advanced features. Shape: (25, 44)
2024-12-19 12:23:11,703 - __main__ - INFO - Number of numeric features: 23
2024-12-19 12:23:11,703 - __main__ - INFO - Number of categorical features: 3
2024-12-19 12:23:11,706 - __main__ - INFO - Training stacked model...
2024-12-19 12:23:11,735 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:23:11,746 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:23:11,752 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:23:11,758 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:23:11,772 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:23:11,772 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:23:11,783 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:23:11,790 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:23:11,796 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:23:11,813 - py4j.clientserver - INFO - Error while sending or receiving.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer
2024-12-19 12:23:11,817 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:23:11,817 - root - INFO - Exception while sending command.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 506, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending
2024-12-19 12:23:11,823 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:23:11,829 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:23:11,836 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:23:11,912 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:23:11,913 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:23:11,941 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:23:13,887 - py4j.clientserver - INFO - Error while sending or receiving.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer
2024-12-19 12:23:13,888 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:23:13,889 - root - INFO - Exception while sending command.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 506, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending
2024-12-19 12:23:13,891 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:23:15,936 - __main__ - INFO - Model Performance:
2024-12-19 12:23:15,936 - __main__ - INFO - RÂ² score: 0.9832
2024-12-19 12:23:15,936 - __main__ - INFO - MSE: 5020.8544
2024-12-19 12:23:15,936 - __main__ - INFO - RMSE: 70.8580
2024-12-19 12:23:15,936 - __main__ - INFO - MAE: 60.7211
2024-12-19 12:23:15,937 - __main__ - WARNING - Feature importance length mismatch: 3 vs 53
2024-12-19 12:23:15,938 - __main__ - INFO - 
Top 10 Most Important Features:
2024-12-19 12:23:15,938 - __main__ - INFO -                  feature  importance  importance_percentage
1  AvgDiscountPercentage    0.541399              54.139880
0           AveragePrice    0.408668              40.866799
2              AvgRating    0.049933               4.993321
2024-12-19 12:23:16,080 - __main__ - INFO - Model saved to /home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/src/models/training/trained_models/sales_predictor.joblib
2024-12-19 12:23:16,465 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:24:15,315 - __main__ - INFO - Starting enhanced model training process...
2024-12-19 12:24:26,399 - __main__ - INFO - Successfully loaded tables:
2024-12-19 12:24:26,400 - __main__ - INFO - Revenue: (25, 6)
2024-12-19 12:24:26,400 - __main__ - INFO - Discount: (25, 7)
2024-12-19 12:24:26,400 - __main__ - INFO - Price Correlation: (25, 6)
2024-12-19 12:24:26,400 - __main__ - INFO - Reviews: (25, 7)
2024-12-19 12:24:26,400 - __main__ - INFO - Found categories: ['ART AND CRAFTING MATERIALS', 'BATH AND BODY', 'BEDSHEETS', 'BICYCLES', 'BLANKETS', 'BOOKS', 'CANDLES', 'CLOTHING', 'COATS AND JACKETS', 'COOKWARE', 'DRINKWARE', 'ELECTRONICS', 'HOME & KITCHEN', 'MAKEUP', 'MOBILE PHONE ACCESSORIES', 'MOTOR VEHICLE PARTS', 'NAIL CARE', 'PERFUME AND COLOGNE', 'POSTERS AND ARTWORK', 'SKIN CARE', 'SOCKS', 'TOYS & GAMES', 'UNDERWEAR', 'VITAMINS AND SUPPLEMENTS', 'WINE']
2024-12-19 12:24:26,408 - __main__ - INFO - Final merged dataset shape: (25, 23)
2024-12-19 12:24:26,408 - __main__ - INFO - Available columns: ['Category', 'TotalRevenue', 'TotalSales', 'AveragePrice', 'ProductCount', 'AvgDiscountPercentage', 'AvgDiscountPercentage_disc', 'TotalDiscountedRevenue', 'PotentialRevenue', 'AvgSales', 'RevenueLossFromDiscount', 'DiscountROI', 'PriceRatingCorrelation', 'AvgPrice', 'AvgRating', 'AvgReviews', 'PriceRatingRelationship', 'TotalReviews', 'TotalSales_review', 'AvgRating_review', 'HighRatingCount', 'ReviewToSalesRatio', 'CustomerEngagementLevel']
2024-12-19 12:24:26,524 - __main__ - INFO - Created advanced features. Shape: (25, 44)
2024-12-19 12:24:26,524 - __main__ - INFO - Number of numeric features: 23
2024-12-19 12:24:26,524 - __main__ - INFO - Number of categorical features: 3
2024-12-19 12:24:26,529 - __main__ - INFO - Training stacked model...
2024-12-19 12:24:26,569 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:24:26,582 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:24:26,588 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:24:26,593 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:24:26,598 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:24:26,604 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:24:26,623 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:24:26,624 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:24:26,649 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:24:26,655 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:24:26,659 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:24:26,679 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:24:26,693 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:24:26,699 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:24:26,716 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:24:26,759 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:24:26,784 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:24:26,972 - py4j.clientserver - INFO - Error while sending or receiving.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer
2024-12-19 12:24:26,976 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:24:26,976 - root - INFO - Exception while sending command.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 506, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending
2024-12-19 12:24:26,991 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:24:30,157 - __main__ - INFO - Model Performance:
2024-12-19 12:24:30,157 - __main__ - INFO - RÂ² score: 0.9832
2024-12-19 12:24:30,157 - __main__ - INFO - MSE: 5020.8544
2024-12-19 12:24:30,157 - __main__ - INFO - RMSE: 70.8580
2024-12-19 12:24:30,157 - __main__ - INFO - MAE: 60.7211
2024-12-19 12:24:30,159 - __main__ - WARNING - Feature importance length mismatch: 3 vs 53
2024-12-19 12:24:30,161 - __main__ - INFO - 
Top 10 Most Important Features:
2024-12-19 12:24:30,161 - __main__ - INFO -                  feature  importance  importance_percentage
1  AvgDiscountPercentage    0.541399              54.139880
0           AveragePrice    0.408668              40.866799
2              AvgRating    0.049933               4.993321
2024-12-19 12:24:30,430 - __main__ - INFO - Model saved to /home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/src/models/training/trained_models/sales_predictor.joblib
2024-12-19 12:24:30,854 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:25:11,789 - __main__ - INFO - Starting enhanced model training process...
2024-12-19 12:25:22,541 - __main__ - INFO - Successfully loaded tables:
2024-12-19 12:25:22,541 - __main__ - INFO - Revenue: (25, 6)
2024-12-19 12:25:22,541 - __main__ - INFO - Discount: (25, 7)
2024-12-19 12:25:22,541 - __main__ - INFO - Price Correlation: (25, 6)
2024-12-19 12:25:22,541 - __main__ - INFO - Reviews: (25, 7)
2024-12-19 12:25:22,542 - __main__ - INFO - Found categories: ['ART AND CRAFTING MATERIALS', 'BATH AND BODY', 'BEDSHEETS', 'BICYCLES', 'BLANKETS', 'BOOKS', 'CANDLES', 'CLOTHING', 'COATS AND JACKETS', 'COOKWARE', 'DRINKWARE', 'ELECTRONICS', 'HOME & KITCHEN', 'MAKEUP', 'MOBILE PHONE ACCESSORIES', 'MOTOR VEHICLE PARTS', 'NAIL CARE', 'PERFUME AND COLOGNE', 'POSTERS AND ARTWORK', 'SKIN CARE', 'SOCKS', 'TOYS & GAMES', 'UNDERWEAR', 'VITAMINS AND SUPPLEMENTS', 'WINE']
2024-12-19 12:25:22,547 - __main__ - INFO - Final merged dataset shape: (25, 23)
2024-12-19 12:25:22,548 - __main__ - INFO - Available columns: ['Category', 'TotalRevenue', 'TotalSales', 'AveragePrice', 'ProductCount', 'AvgDiscountPercentage', 'AvgDiscountPercentage_disc', 'TotalDiscountedRevenue', 'PotentialRevenue', 'AvgSales', 'RevenueLossFromDiscount', 'DiscountROI', 'PriceRatingCorrelation', 'AvgPrice', 'AvgRating', 'AvgReviews', 'PriceRatingRelationship', 'TotalReviews', 'TotalSales_review', 'AvgRating_review', 'HighRatingCount', 'ReviewToSalesRatio', 'CustomerEngagementLevel']
2024-12-19 12:25:23,060 - __main__ - INFO - Created advanced features. Shape: (25, 44)
2024-12-19 12:25:23,060 - __main__ - INFO - Number of numeric features: 23
2024-12-19 12:25:23,060 - __main__ - INFO - Number of categorical features: 3
2024-12-19 12:25:23,063 - __main__ - INFO - Training stacked model...
2024-12-19 12:25:23,102 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:25:23,118 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:25:23,124 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:25:23,131 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:25:23,139 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:25:23,147 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:25:23,155 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:25:23,163 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:25:23,169 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:25:23,176 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:25:23,183 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:25:23,193 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:25:23,207 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:25:23,218 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:25:23,246 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:25:23,257 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:25:23,289 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:25:24,854 - py4j.clientserver - INFO - Error while sending or receiving.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer
2024-12-19 12:25:24,856 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:25:24,856 - root - INFO - Exception while sending command.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 506, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending
2024-12-19 12:25:24,859 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:25:26,079 - __main__ - INFO - Model Performance:
2024-12-19 12:25:26,079 - __main__ - INFO - RÂ² score: 0.9832
2024-12-19 12:25:26,079 - __main__ - INFO - MSE: 5020.8544
2024-12-19 12:25:26,079 - __main__ - INFO - RMSE: 70.8580
2024-12-19 12:25:26,079 - __main__ - INFO - MAE: 60.7211
2024-12-19 12:25:26,080 - __main__ - WARNING - Feature importance length mismatch: 3 vs 53
2024-12-19 12:25:26,081 - __main__ - INFO - 
Top 10 Most Important Features:
2024-12-19 12:25:26,081 - __main__ - INFO -                  feature  importance  importance_percentage
1  AvgDiscountPercentage    0.541399              54.139880
0           AveragePrice    0.408668              40.866799
2              AvgRating    0.049933               4.993321
2024-12-19 12:25:26,197 - __main__ - INFO - Model saved to /home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/src/models/training/trained_models/sales_predictor.joblib
2024-12-19 12:25:26,586 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:26:35,052 - __main__ - INFO - Starting enhanced model training process...
2024-12-19 12:26:43,362 - __main__ - INFO - Successfully loaded tables:
2024-12-19 12:26:43,362 - __main__ - INFO - Revenue: (25, 6)
2024-12-19 12:26:43,363 - __main__ - INFO - Discount: (25, 7)
2024-12-19 12:26:43,363 - __main__ - INFO - Price Correlation: (25, 6)
2024-12-19 12:26:43,363 - __main__ - INFO - Reviews: (25, 7)
2024-12-19 12:26:43,363 - __main__ - INFO - Found categories: ['ART AND CRAFTING MATERIALS', 'BATH AND BODY', 'BEDSHEETS', 'BICYCLES', 'BLANKETS', 'BOOKS', 'CANDLES', 'CLOTHING', 'COATS AND JACKETS', 'COOKWARE', 'DRINKWARE', 'ELECTRONICS', 'HOME & KITCHEN', 'MAKEUP', 'MOBILE PHONE ACCESSORIES', 'MOTOR VEHICLE PARTS', 'NAIL CARE', 'PERFUME AND COLOGNE', 'POSTERS AND ARTWORK', 'SKIN CARE', 'SOCKS', 'TOYS & GAMES', 'UNDERWEAR', 'VITAMINS AND SUPPLEMENTS', 'WINE']
2024-12-19 12:26:43,368 - __main__ - INFO - Final merged dataset shape: (25, 23)
2024-12-19 12:26:43,368 - __main__ - INFO - Available columns: ['Category', 'TotalRevenue', 'TotalSales', 'AveragePrice', 'ProductCount', 'AvgDiscountPercentage', 'AvgDiscountPercentage_disc', 'TotalDiscountedRevenue', 'PotentialRevenue', 'AvgSales', 'RevenueLossFromDiscount', 'DiscountROI', 'PriceRatingCorrelation', 'AvgPrice', 'AvgRating', 'AvgReviews', 'PriceRatingRelationship', 'TotalReviews', 'TotalSales_review', 'AvgRating_review', 'HighRatingCount', 'ReviewToSalesRatio', 'CustomerEngagementLevel']
2024-12-19 12:26:43,539 - __main__ - INFO - Created advanced features. Shape: (25, 44)
2024-12-19 12:26:43,539 - __main__ - INFO - Number of numeric features: 23
2024-12-19 12:26:43,539 - __main__ - INFO - Number of categorical features: 3
2024-12-19 12:26:43,541 - __main__ - INFO - Training stacked model...
2024-12-19 12:26:43,568 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:26:43,580 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:26:43,585 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:26:43,590 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:26:43,596 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:26:43,602 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:26:43,607 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:26:43,613 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:26:43,620 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:26:43,627 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:26:43,634 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:26:43,642 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:26:43,660 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:26:43,670 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:26:43,680 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:26:43,687 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:26:43,690 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:26:43,802 - py4j.clientserver - INFO - Error while sending or receiving.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer
2024-12-19 12:26:43,804 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:26:43,804 - root - INFO - Exception while sending command.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 506, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending
2024-12-19 12:26:43,830 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:26:50,171 - __main__ - INFO - Model Performance:
2024-12-19 12:26:50,171 - __main__ - INFO - RÂ² score: 0.9832
2024-12-19 12:26:50,171 - __main__ - INFO - MSE: 5020.8544
2024-12-19 12:26:50,171 - __main__ - INFO - RMSE: 70.8580
2024-12-19 12:26:50,171 - __main__ - INFO - MAE: 60.7211
2024-12-19 12:26:50,172 - __main__ - WARNING - Feature importance length mismatch: 3 vs 53
2024-12-19 12:26:50,174 - __main__ - INFO - 
Top 10 Most Important Features:
2024-12-19 12:26:50,174 - __main__ - INFO -                  feature  importance  importance_percentage
1  AvgDiscountPercentage    0.541399              54.139880
0           AveragePrice    0.408668              40.866799
2              AvgRating    0.049933               4.993321
2024-12-19 12:26:50,332 - __main__ - INFO - Model saved to /home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/src/models/training/trained_models/sales_predictor.joblib
2024-12-19 12:26:50,717 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:27:44,378 - __main__ - INFO - Starting enhanced model training process...
2024-12-19 12:27:57,420 - __main__ - INFO - Successfully loaded tables:
2024-12-19 12:27:57,421 - __main__ - INFO - Revenue: (25, 6)
2024-12-19 12:27:57,421 - __main__ - INFO - Discount: (25, 7)
2024-12-19 12:27:57,421 - __main__ - INFO - Price Correlation: (25, 6)
2024-12-19 12:27:57,421 - __main__ - INFO - Reviews: (25, 7)
2024-12-19 12:27:57,422 - __main__ - INFO - Found categories: ['ART AND CRAFTING MATERIALS', 'BATH AND BODY', 'BEDSHEETS', 'BICYCLES', 'BLANKETS', 'BOOKS', 'CANDLES', 'CLOTHING', 'COATS AND JACKETS', 'COOKWARE', 'DRINKWARE', 'ELECTRONICS', 'HOME & KITCHEN', 'MAKEUP', 'MOBILE PHONE ACCESSORIES', 'MOTOR VEHICLE PARTS', 'NAIL CARE', 'PERFUME AND COLOGNE', 'POSTERS AND ARTWORK', 'SKIN CARE', 'SOCKS', 'TOYS & GAMES', 'UNDERWEAR', 'VITAMINS AND SUPPLEMENTS', 'WINE']
2024-12-19 12:27:57,428 - __main__ - INFO - Final merged dataset shape: (25, 23)
2024-12-19 12:27:57,428 - __main__ - INFO - Available columns: ['Category', 'TotalRevenue', 'TotalSales', 'AveragePrice', 'ProductCount', 'AvgDiscountPercentage', 'AvgDiscountPercentage_disc', 'TotalDiscountedRevenue', 'PotentialRevenue', 'AvgSales', 'RevenueLossFromDiscount', 'DiscountROI', 'PriceRatingCorrelation', 'AvgPrice', 'AvgRating', 'AvgReviews', 'PriceRatingRelationship', 'TotalReviews', 'TotalSales_review', 'AvgRating_review', 'HighRatingCount', 'ReviewToSalesRatio', 'CustomerEngagementLevel']
2024-12-19 12:27:57,668 - __main__ - INFO - Created advanced features. Shape: (25, 44)
2024-12-19 12:27:57,668 - __main__ - INFO - Number of numeric features: 23
2024-12-19 12:27:57,668 - __main__ - INFO - Number of categorical features: 3
2024-12-19 12:27:57,671 - __main__ - INFO - Training stacked model...
2024-12-19 12:27:57,709 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:27:57,728 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:27:57,734 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:27:57,741 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:27:57,742 - py4j.clientserver - INFO - Error while sending or receiving.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer
2024-12-19 12:27:57,753 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:27:57,763 - root - INFO - Exception while sending command.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 506, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending
2024-12-19 12:27:57,788 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:27:57,883 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:27:57,909 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:27:57,919 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:27:57,949 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:27:57,960 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:27:57,979 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:27:58,853 - py4j.clientserver - INFO - Error while sending or receiving.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer
2024-12-19 12:27:58,854 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:27:58,854 - root - INFO - Exception while sending command.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 506, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending
2024-12-19 12:27:58,856 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:28:01,361 - __main__ - INFO - Model Performance:
2024-12-19 12:28:01,361 - __main__ - INFO - RÂ² score: 0.9832
2024-12-19 12:28:01,361 - __main__ - INFO - MSE: 5020.8544
2024-12-19 12:28:01,361 - __main__ - INFO - RMSE: 70.8580
2024-12-19 12:28:01,361 - __main__ - INFO - MAE: 60.7211
2024-12-19 12:28:01,363 - __main__ - WARNING - Feature importance length mismatch: 3 vs 53
2024-12-19 12:28:01,364 - __main__ - INFO - 
Top 10 Most Important Features:
2024-12-19 12:28:01,365 - __main__ - INFO -                  feature  importance  importance_percentage
1  AvgDiscountPercentage    0.541399              54.139880
0           AveragePrice    0.408668              40.866799
2              AvgRating    0.049933               4.993321
2024-12-19 12:28:01,531 - __main__ - INFO - Model saved to /home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/src/models/training/trained_models/sales_predictor.joblib
2024-12-19 12:28:02,105 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:29:00,009 - __main__ - INFO - Starting enhanced model training process...
2024-12-19 12:29:12,925 - __main__ - INFO - Successfully loaded tables:
2024-12-19 12:29:12,925 - __main__ - INFO - Revenue: (25, 6)
2024-12-19 12:29:12,925 - __main__ - INFO - Discount: (25, 7)
2024-12-19 12:29:12,925 - __main__ - INFO - Price Correlation: (25, 6)
2024-12-19 12:29:12,926 - __main__ - INFO - Reviews: (25, 7)
2024-12-19 12:29:12,926 - __main__ - INFO - Found categories: ['ART AND CRAFTING MATERIALS', 'BATH AND BODY', 'BEDSHEETS', 'BICYCLES', 'BLANKETS', 'BOOKS', 'CANDLES', 'CLOTHING', 'COATS AND JACKETS', 'COOKWARE', 'DRINKWARE', 'ELECTRONICS', 'HOME & KITCHEN', 'MAKEUP', 'MOBILE PHONE ACCESSORIES', 'MOTOR VEHICLE PARTS', 'NAIL CARE', 'PERFUME AND COLOGNE', 'POSTERS AND ARTWORK', 'SKIN CARE', 'SOCKS', 'TOYS & GAMES', 'UNDERWEAR', 'VITAMINS AND SUPPLEMENTS', 'WINE']
2024-12-19 12:29:12,931 - __main__ - INFO - Final merged dataset shape: (25, 23)
2024-12-19 12:29:12,931 - __main__ - INFO - Available columns: ['Category', 'TotalRevenue', 'TotalSales', 'AveragePrice', 'ProductCount', 'AvgDiscountPercentage', 'AvgDiscountPercentage_disc', 'TotalDiscountedRevenue', 'PotentialRevenue', 'AvgSales', 'RevenueLossFromDiscount', 'DiscountROI', 'PriceRatingCorrelation', 'AvgPrice', 'AvgRating', 'AvgReviews', 'PriceRatingRelationship', 'TotalReviews', 'TotalSales_review', 'AvgRating_review', 'HighRatingCount', 'ReviewToSalesRatio', 'CustomerEngagementLevel']
2024-12-19 12:29:13,020 - __main__ - INFO - Created advanced features. Shape: (25, 44)
2024-12-19 12:29:13,020 - __main__ - INFO - Number of numeric features: 23
2024-12-19 12:29:13,020 - __main__ - INFO - Number of categorical features: 3
2024-12-19 12:29:13,024 - __main__ - INFO - Training stacked model...
2024-12-19 12:29:13,052 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:29:13,066 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:29:13,073 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:29:13,079 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:29:13,088 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:29:13,097 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:29:13,114 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:29:13,126 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:29:13,136 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:29:13,143 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:29:13,151 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:29:13,183 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:29:13,189 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:29:13,200 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:29:13,210 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:29:13,213 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:29:13,234 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:29:13,394 - py4j.clientserver - INFO - Error while sending or receiving.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer
2024-12-19 12:29:13,396 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:29:13,396 - root - INFO - Exception while sending command.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 506, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending
2024-12-19 12:29:13,423 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:29:15,999 - __main__ - INFO - Model Performance:
2024-12-19 12:29:15,999 - __main__ - INFO - RÂ² score: 0.9832
2024-12-19 12:29:16,000 - __main__ - INFO - MSE: 5020.8544
2024-12-19 12:29:16,000 - __main__ - INFO - RMSE: 70.8580
2024-12-19 12:29:16,000 - __main__ - INFO - MAE: 60.7211
2024-12-19 12:29:16,001 - __main__ - WARNING - Feature importance length mismatch: 3 vs 53
2024-12-19 12:29:16,002 - __main__ - INFO - 
Top 10 Most Important Features:
2024-12-19 12:29:16,002 - __main__ - INFO -                  feature  importance  importance_percentage
1  AvgDiscountPercentage    0.541399              54.139880
0           AveragePrice    0.408668              40.866799
2              AvgRating    0.049933               4.993321
2024-12-19 12:29:16,121 - __main__ - INFO - Model saved to /home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/src/models/training/trained_models/sales_predictor.joblib
2024-12-19 12:29:16,460 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:30:10,845 - __main__ - INFO - Starting enhanced model training process...
2024-12-19 12:30:22,309 - __main__ - INFO - Successfully loaded tables:
2024-12-19 12:30:22,309 - __main__ - INFO - Revenue: (25, 6)
2024-12-19 12:30:22,310 - __main__ - INFO - Discount: (25, 7)
2024-12-19 12:30:22,310 - __main__ - INFO - Price Correlation: (25, 6)
2024-12-19 12:30:22,310 - __main__ - INFO - Reviews: (25, 7)
2024-12-19 12:30:22,311 - __main__ - INFO - Found categories: ['ART AND CRAFTING MATERIALS', 'BATH AND BODY', 'BEDSHEETS', 'BICYCLES', 'BLANKETS', 'BOOKS', 'CANDLES', 'CLOTHING', 'COATS AND JACKETS', 'COOKWARE', 'DRINKWARE', 'ELECTRONICS', 'HOME & KITCHEN', 'MAKEUP', 'MOBILE PHONE ACCESSORIES', 'MOTOR VEHICLE PARTS', 'NAIL CARE', 'PERFUME AND COLOGNE', 'POSTERS AND ARTWORK', 'SKIN CARE', 'SOCKS', 'TOYS & GAMES', 'UNDERWEAR', 'VITAMINS AND SUPPLEMENTS', 'WINE']
2024-12-19 12:30:22,319 - __main__ - INFO - Final merged dataset shape: (25, 23)
2024-12-19 12:30:22,319 - __main__ - INFO - Available columns: ['Category', 'TotalRevenue', 'TotalSales', 'AveragePrice', 'ProductCount', 'AvgDiscountPercentage', 'AvgDiscountPercentage_disc', 'TotalDiscountedRevenue', 'PotentialRevenue', 'AvgSales', 'RevenueLossFromDiscount', 'DiscountROI', 'PriceRatingCorrelation', 'AvgPrice', 'AvgRating', 'AvgReviews', 'PriceRatingRelationship', 'TotalReviews', 'TotalSales_review', 'AvgRating_review', 'HighRatingCount', 'ReviewToSalesRatio', 'CustomerEngagementLevel']
2024-12-19 12:30:22,408 - __main__ - INFO - Created advanced features. Shape: (25, 44)
2024-12-19 12:30:22,409 - __main__ - INFO - Number of numeric features: 23
2024-12-19 12:30:22,409 - __main__ - INFO - Number of categorical features: 3
2024-12-19 12:30:22,411 - __main__ - INFO - Training stacked model...
2024-12-19 12:30:22,447 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:30:22,460 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:30:22,465 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:30:22,471 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:30:22,481 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:30:22,487 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:30:22,494 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:30:22,501 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:30:22,508 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:30:22,519 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:30:22,531 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:30:22,542 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:30:22,568 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:30:22,599 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:30:22,614 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:30:22,628 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:30:22,649 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:30:24,334 - py4j.clientserver - INFO - Error while sending or receiving.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer
2024-12-19 12:30:24,336 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:30:24,336 - root - INFO - Exception while sending command.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 506, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending
2024-12-19 12:30:24,339 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:30:25,700 - __main__ - INFO - Model Performance:
2024-12-19 12:30:25,700 - __main__ - INFO - RÂ² score: 0.9832
2024-12-19 12:30:25,701 - __main__ - INFO - MSE: 5020.8544
2024-12-19 12:30:25,701 - __main__ - INFO - RMSE: 70.8580
2024-12-19 12:30:25,701 - __main__ - INFO - MAE: 60.7211
2024-12-19 12:30:25,702 - __main__ - WARNING - Feature importance length mismatch: 3 vs 53
2024-12-19 12:30:25,704 - __main__ - INFO - 
Top 10 Most Important Features:
2024-12-19 12:30:25,705 - __main__ - INFO -                  feature  importance  importance_percentage
1  AvgDiscountPercentage    0.541399              54.139880
0           AveragePrice    0.408668              40.866799
2              AvgRating    0.049933               4.993321
2024-12-19 12:30:25,859 - __main__ - INFO - Model saved to /home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/src/models/training/trained_models/sales_predictor.joblib
2024-12-19 12:30:26,279 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:31:18,508 - __main__ - INFO - Starting enhanced model training process...
2024-12-19 12:31:30,104 - __main__ - INFO - Successfully loaded tables:
2024-12-19 12:31:30,104 - __main__ - INFO - Revenue: (25, 6)
2024-12-19 12:31:30,104 - __main__ - INFO - Discount: (25, 7)
2024-12-19 12:31:30,104 - __main__ - INFO - Price Correlation: (25, 6)
2024-12-19 12:31:30,105 - __main__ - INFO - Reviews: (25, 7)
2024-12-19 12:31:30,105 - __main__ - INFO - Found categories: ['ART AND CRAFTING MATERIALS', 'BATH AND BODY', 'BEDSHEETS', 'BICYCLES', 'BLANKETS', 'BOOKS', 'CANDLES', 'CLOTHING', 'COATS AND JACKETS', 'COOKWARE', 'DRINKWARE', 'ELECTRONICS', 'HOME & KITCHEN', 'MAKEUP', 'MOBILE PHONE ACCESSORIES', 'MOTOR VEHICLE PARTS', 'NAIL CARE', 'PERFUME AND COLOGNE', 'POSTERS AND ARTWORK', 'SKIN CARE', 'SOCKS', 'TOYS & GAMES', 'UNDERWEAR', 'VITAMINS AND SUPPLEMENTS', 'WINE']
2024-12-19 12:31:30,117 - __main__ - INFO - Final merged dataset shape: (25, 23)
2024-12-19 12:31:30,117 - __main__ - INFO - Available columns: ['Category', 'TotalRevenue', 'TotalSales', 'AveragePrice', 'ProductCount', 'AvgDiscountPercentage', 'AvgDiscountPercentage_disc', 'TotalDiscountedRevenue', 'PotentialRevenue', 'AvgSales', 'RevenueLossFromDiscount', 'DiscountROI', 'PriceRatingCorrelation', 'AvgPrice', 'AvgRating', 'AvgReviews', 'PriceRatingRelationship', 'TotalReviews', 'TotalSales_review', 'AvgRating_review', 'HighRatingCount', 'ReviewToSalesRatio', 'CustomerEngagementLevel']
2024-12-19 12:31:30,502 - __main__ - INFO - Created advanced features. Shape: (25, 44)
2024-12-19 12:31:30,502 - __main__ - INFO - Number of numeric features: 23
2024-12-19 12:31:30,502 - __main__ - INFO - Number of categorical features: 3
2024-12-19 12:31:30,505 - __main__ - INFO - Training stacked model...
2024-12-19 12:31:30,535 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:31:30,546 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:31:30,552 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:31:30,559 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:31:30,565 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:31:30,571 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:31:30,576 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:31:30,582 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:31:30,588 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:31:30,595 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:31:30,600 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:31:30,608 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:31:30,621 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:31:30,654 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:31:30,664 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:31:30,664 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:31:30,676 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:31:32,374 - py4j.clientserver - INFO - Error while sending or receiving.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer
2024-12-19 12:31:32,378 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:31:32,378 - root - INFO - Exception while sending command.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 506, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending
2024-12-19 12:31:32,391 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:31:34,773 - __main__ - INFO - Model Performance:
2024-12-19 12:31:34,774 - __main__ - INFO - RÂ² score: 0.9832
2024-12-19 12:31:34,774 - __main__ - INFO - MSE: 5020.8544
2024-12-19 12:31:34,774 - __main__ - INFO - RMSE: 70.8580
2024-12-19 12:31:34,774 - __main__ - INFO - MAE: 60.7211
2024-12-19 12:31:34,775 - __main__ - WARNING - Feature importance length mismatch: 3 vs 53
2024-12-19 12:31:34,777 - __main__ - INFO - 
Top 10 Most Important Features:
2024-12-19 12:31:34,778 - __main__ - INFO -                  feature  importance  importance_percentage
1  AvgDiscountPercentage    0.541399              54.139880
0           AveragePrice    0.408668              40.866799
2              AvgRating    0.049933               4.993321
2024-12-19 12:31:34,935 - __main__ - INFO - Model saved to /home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/src/models/training/trained_models/sales_predictor.joblib
2024-12-19 12:31:35,369 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:32:29,993 - __main__ - INFO - Starting enhanced model training process...
2024-12-19 12:32:40,338 - __main__ - INFO - Successfully loaded tables:
2024-12-19 12:32:40,338 - __main__ - INFO - Revenue: (25, 6)
2024-12-19 12:32:40,338 - __main__ - INFO - Discount: (25, 7)
2024-12-19 12:32:40,339 - __main__ - INFO - Price Correlation: (25, 6)
2024-12-19 12:32:40,339 - __main__ - INFO - Reviews: (25, 7)
2024-12-19 12:32:40,343 - __main__ - INFO - Found categories: ['ART AND CRAFTING MATERIALS', 'BATH AND BODY', 'BEDSHEETS', 'BICYCLES', 'BLANKETS', 'BOOKS', 'CANDLES', 'CLOTHING', 'COATS AND JACKETS', 'COOKWARE', 'DRINKWARE', 'ELECTRONICS', 'HOME & KITCHEN', 'MAKEUP', 'MOBILE PHONE ACCESSORIES', 'MOTOR VEHICLE PARTS', 'NAIL CARE', 'PERFUME AND COLOGNE', 'POSTERS AND ARTWORK', 'SKIN CARE', 'SOCKS', 'TOYS & GAMES', 'UNDERWEAR', 'VITAMINS AND SUPPLEMENTS', 'WINE']
2024-12-19 12:32:40,363 - __main__ - INFO - Final merged dataset shape: (25, 23)
2024-12-19 12:32:40,363 - __main__ - INFO - Available columns: ['Category', 'TotalRevenue', 'TotalSales', 'AveragePrice', 'ProductCount', 'AvgDiscountPercentage', 'AvgDiscountPercentage_disc', 'TotalDiscountedRevenue', 'PotentialRevenue', 'AvgSales', 'RevenueLossFromDiscount', 'DiscountROI', 'PriceRatingCorrelation', 'AvgPrice', 'AvgRating', 'AvgReviews', 'PriceRatingRelationship', 'TotalReviews', 'TotalSales_review', 'AvgRating_review', 'HighRatingCount', 'ReviewToSalesRatio', 'CustomerEngagementLevel']
2024-12-19 12:32:40,993 - __main__ - INFO - Created advanced features. Shape: (25, 44)
2024-12-19 12:32:40,993 - __main__ - INFO - Number of numeric features: 23
2024-12-19 12:32:40,993 - __main__ - INFO - Number of categorical features: 3
2024-12-19 12:32:40,998 - __main__ - INFO - Training stacked model...
2024-12-19 12:32:41,038 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:32:41,052 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:32:41,058 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:32:41,065 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:32:41,072 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:32:41,079 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:32:41,087 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:32:41,095 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:32:41,103 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:32:41,111 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:32:41,120 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:32:41,128 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:32:41,145 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:32:41,151 - py4j.clientserver - INFO - Error while sending or receiving.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer
2024-12-19 12:32:41,156 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:32:41,156 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:32:41,156 - root - INFO - Exception while sending command.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 506, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending
2024-12-19 12:32:41,198 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:32:44,753 - __main__ - INFO - Model Performance:
2024-12-19 12:32:44,753 - __main__ - INFO - RÂ² score: 0.9832
2024-12-19 12:32:44,754 - __main__ - INFO - MSE: 5020.8544
2024-12-19 12:32:44,754 - __main__ - INFO - RMSE: 70.8580
2024-12-19 12:32:44,754 - __main__ - INFO - MAE: 60.7211
2024-12-19 12:32:44,755 - __main__ - WARNING - Feature importance length mismatch: 3 vs 53
2024-12-19 12:32:44,757 - __main__ - INFO - 
Top 10 Most Important Features:
2024-12-19 12:32:44,758 - __main__ - INFO -                  feature  importance  importance_percentage
1  AvgDiscountPercentage    0.541399              54.139880
0           AveragePrice    0.408668              40.866799
2              AvgRating    0.049933               4.993321
2024-12-19 12:32:44,960 - __main__ - INFO - Model saved to /home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/src/models/training/trained_models/sales_predictor.joblib
2024-12-19 12:32:45,507 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:33:44,273 - __main__ - INFO - Starting enhanced model training process...
2024-12-19 12:33:57,503 - __main__ - INFO - Successfully loaded tables:
2024-12-19 12:33:57,503 - __main__ - INFO - Revenue: (25, 6)
2024-12-19 12:33:57,504 - __main__ - INFO - Discount: (25, 7)
2024-12-19 12:33:57,504 - __main__ - INFO - Price Correlation: (25, 6)
2024-12-19 12:33:57,504 - __main__ - INFO - Reviews: (25, 7)
2024-12-19 12:33:57,504 - __main__ - INFO - Found categories: ['ART AND CRAFTING MATERIALS', 'BATH AND BODY', 'BEDSHEETS', 'BICYCLES', 'BLANKETS', 'BOOKS', 'CANDLES', 'CLOTHING', 'COATS AND JACKETS', 'COOKWARE', 'DRINKWARE', 'ELECTRONICS', 'HOME & KITCHEN', 'MAKEUP', 'MOBILE PHONE ACCESSORIES', 'MOTOR VEHICLE PARTS', 'NAIL CARE', 'PERFUME AND COLOGNE', 'POSTERS AND ARTWORK', 'SKIN CARE', 'SOCKS', 'TOYS & GAMES', 'UNDERWEAR', 'VITAMINS AND SUPPLEMENTS', 'WINE']
2024-12-19 12:33:57,511 - __main__ - INFO - Final merged dataset shape: (25, 23)
2024-12-19 12:33:57,511 - __main__ - INFO - Available columns: ['Category', 'TotalRevenue', 'TotalSales', 'AveragePrice', 'ProductCount', 'AvgDiscountPercentage', 'AvgDiscountPercentage_disc', 'TotalDiscountedRevenue', 'PotentialRevenue', 'AvgSales', 'RevenueLossFromDiscount', 'DiscountROI', 'PriceRatingCorrelation', 'AvgPrice', 'AvgRating', 'AvgReviews', 'PriceRatingRelationship', 'TotalReviews', 'TotalSales_review', 'AvgRating_review', 'HighRatingCount', 'ReviewToSalesRatio', 'CustomerEngagementLevel']
2024-12-19 12:33:57,862 - __main__ - INFO - Created advanced features. Shape: (25, 44)
2024-12-19 12:33:57,863 - __main__ - INFO - Number of numeric features: 23
2024-12-19 12:33:57,863 - __main__ - INFO - Number of categorical features: 3
2024-12-19 12:33:57,871 - __main__ - INFO - Training stacked model...
2024-12-19 12:33:57,934 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:33:57,957 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:33:57,966 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:33:57,974 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:33:57,997 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:33:58,005 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:33:58,010 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:33:58,033 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:33:58,044 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:33:58,059 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:33:58,060 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:33:58,073 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:33:58,109 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:33:58,124 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:33:58,173 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:33:58,224 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:33:58,231 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:33:58,440 - py4j.clientserver - INFO - Error while sending or receiving.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer
2024-12-19 12:33:58,442 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:33:58,443 - root - INFO - Exception while sending command.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 506, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending
2024-12-19 12:33:58,468 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:34:05,155 - __main__ - INFO - Model Performance:
2024-12-19 12:34:05,155 - __main__ - INFO - RÂ² score: 0.9832
2024-12-19 12:34:05,156 - __main__ - INFO - MSE: 5020.8544
2024-12-19 12:34:05,156 - __main__ - INFO - RMSE: 70.8580
2024-12-19 12:34:05,156 - __main__ - INFO - MAE: 60.7211
2024-12-19 12:34:05,158 - __main__ - WARNING - Feature importance length mismatch: 3 vs 53
2024-12-19 12:34:05,160 - __main__ - INFO - 
Top 10 Most Important Features:
2024-12-19 12:34:05,160 - __main__ - INFO -                  feature  importance  importance_percentage
1  AvgDiscountPercentage    0.541399              54.139880
0           AveragePrice    0.408668              40.866799
2              AvgRating    0.049933               4.993321
2024-12-19 12:34:05,299 - __main__ - INFO - Model saved to /home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/src/models/training/trained_models/sales_predictor.joblib
2024-12-19 12:34:05,696 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:34:53,900 - __main__ - INFO - Starting enhanced model training process...
2024-12-19 12:35:04,673 - __main__ - INFO - Successfully loaded tables:
2024-12-19 12:35:04,673 - __main__ - INFO - Revenue: (25, 6)
2024-12-19 12:35:04,673 - __main__ - INFO - Discount: (25, 7)
2024-12-19 12:35:04,674 - __main__ - INFO - Price Correlation: (25, 6)
2024-12-19 12:35:04,674 - __main__ - INFO - Reviews: (25, 7)
2024-12-19 12:35:04,674 - __main__ - INFO - Found categories: ['ART AND CRAFTING MATERIALS', 'BATH AND BODY', 'BEDSHEETS', 'BICYCLES', 'BLANKETS', 'BOOKS', 'CANDLES', 'CLOTHING', 'COATS AND JACKETS', 'COOKWARE', 'DRINKWARE', 'ELECTRONICS', 'HOME & KITCHEN', 'MAKEUP', 'MOBILE PHONE ACCESSORIES', 'MOTOR VEHICLE PARTS', 'NAIL CARE', 'PERFUME AND COLOGNE', 'POSTERS AND ARTWORK', 'SKIN CARE', 'SOCKS', 'TOYS & GAMES', 'UNDERWEAR', 'VITAMINS AND SUPPLEMENTS', 'WINE']
2024-12-19 12:35:04,680 - __main__ - INFO - Final merged dataset shape: (25, 23)
2024-12-19 12:35:04,680 - __main__ - INFO - Available columns: ['Category', 'TotalRevenue', 'TotalSales', 'AveragePrice', 'ProductCount', 'AvgDiscountPercentage', 'AvgDiscountPercentage_disc', 'TotalDiscountedRevenue', 'PotentialRevenue', 'AvgSales', 'RevenueLossFromDiscount', 'DiscountROI', 'PriceRatingCorrelation', 'AvgPrice', 'AvgRating', 'AvgReviews', 'PriceRatingRelationship', 'TotalReviews', 'TotalSales_review', 'AvgRating_review', 'HighRatingCount', 'ReviewToSalesRatio', 'CustomerEngagementLevel']
2024-12-19 12:35:05,192 - __main__ - INFO - Created advanced features. Shape: (25, 44)
2024-12-19 12:35:05,192 - __main__ - INFO - Number of numeric features: 23
2024-12-19 12:35:05,193 - __main__ - INFO - Number of categorical features: 3
2024-12-19 12:35:05,198 - __main__ - INFO - Training stacked model...
2024-12-19 12:35:06,449 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:35:06,466 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:35:06,473 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:35:06,481 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:35:06,488 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:35:06,503 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:35:06,511 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:35:06,541 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:35:06,553 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:35:06,554 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:35:06,568 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:35:06,584 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:35:06,584 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:35:06,604 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:35:08,738 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:35:08,763 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:35:08,770 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:35:08,778 - py4j.clientserver - INFO - Error while sending or receiving.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer
2024-12-19 12:35:08,781 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:35:08,781 - root - INFO - Exception while sending command.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 506, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending
2024-12-19 12:35:08,788 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:35:13,290 - __main__ - INFO - Model Performance:
2024-12-19 12:35:13,291 - __main__ - INFO - RÂ² score: 0.9832
2024-12-19 12:35:13,291 - __main__ - INFO - MSE: 5020.8544
2024-12-19 12:35:13,291 - __main__ - INFO - RMSE: 70.8580
2024-12-19 12:35:13,291 - __main__ - INFO - MAE: 60.7211
2024-12-19 12:35:13,292 - __main__ - WARNING - Feature importance length mismatch: 3 vs 53
2024-12-19 12:35:13,294 - __main__ - INFO - 
Top 10 Most Important Features:
2024-12-19 12:35:13,294 - __main__ - INFO -                  feature  importance  importance_percentage
1  AvgDiscountPercentage    0.541399              54.139880
0           AveragePrice    0.408668              40.866799
2              AvgRating    0.049933               4.993321
2024-12-19 12:35:13,456 - __main__ - INFO - Model saved to /home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/src/models/training/trained_models/sales_predictor.joblib
2024-12-19 12:35:13,929 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:36:03,115 - __main__ - INFO - Starting enhanced model training process...
2024-12-19 12:36:17,726 - __main__ - INFO - Successfully loaded tables:
2024-12-19 12:36:17,726 - __main__ - INFO - Revenue: (25, 6)
2024-12-19 12:36:17,727 - __main__ - INFO - Discount: (25, 7)
2024-12-19 12:36:17,727 - __main__ - INFO - Price Correlation: (25, 6)
2024-12-19 12:36:17,727 - __main__ - INFO - Reviews: (25, 7)
2024-12-19 12:36:17,727 - __main__ - INFO - Found categories: ['ART AND CRAFTING MATERIALS', 'BATH AND BODY', 'BEDSHEETS', 'BICYCLES', 'BLANKETS', 'BOOKS', 'CANDLES', 'CLOTHING', 'COATS AND JACKETS', 'COOKWARE', 'DRINKWARE', 'ELECTRONICS', 'HOME & KITCHEN', 'MAKEUP', 'MOBILE PHONE ACCESSORIES', 'MOTOR VEHICLE PARTS', 'NAIL CARE', 'PERFUME AND COLOGNE', 'POSTERS AND ARTWORK', 'SKIN CARE', 'SOCKS', 'TOYS & GAMES', 'UNDERWEAR', 'VITAMINS AND SUPPLEMENTS', 'WINE']
2024-12-19 12:36:17,739 - __main__ - INFO - Final merged dataset shape: (25, 23)
2024-12-19 12:36:17,740 - __main__ - INFO - Available columns: ['Category', 'TotalRevenue', 'TotalSales', 'AveragePrice', 'ProductCount', 'AvgDiscountPercentage', 'AvgDiscountPercentage_disc', 'TotalDiscountedRevenue', 'PotentialRevenue', 'AvgSales', 'RevenueLossFromDiscount', 'DiscountROI', 'PriceRatingCorrelation', 'AvgPrice', 'AvgRating', 'AvgReviews', 'PriceRatingRelationship', 'TotalReviews', 'TotalSales_review', 'AvgRating_review', 'HighRatingCount', 'ReviewToSalesRatio', 'CustomerEngagementLevel']
2024-12-19 12:36:17,942 - __main__ - INFO - Created advanced features. Shape: (25, 44)
2024-12-19 12:36:17,942 - __main__ - INFO - Number of numeric features: 23
2024-12-19 12:36:17,942 - __main__ - INFO - Number of categorical features: 3
2024-12-19 12:36:17,946 - __main__ - INFO - Training stacked model...
2024-12-19 12:36:17,986 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:36:18,002 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:36:18,009 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:36:18,018 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:36:18,029 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:36:18,034 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:36:18,041 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:36:18,048 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:36:18,055 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:36:18,064 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:36:18,074 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:36:18,094 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:36:18,097 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:36:18,112 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:36:18,116 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:36:18,128 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:36:18,148 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:36:19,907 - py4j.clientserver - INFO - Error while sending or receiving.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer
2024-12-19 12:36:19,910 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:36:19,910 - root - INFO - Exception while sending command.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 506, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending
2024-12-19 12:36:19,915 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:36:21,963 - __main__ - INFO - Model Performance:
2024-12-19 12:36:21,963 - __main__ - INFO - RÂ² score: 0.9832
2024-12-19 12:36:21,963 - __main__ - INFO - MSE: 5020.8544
2024-12-19 12:36:21,963 - __main__ - INFO - RMSE: 70.8580
2024-12-19 12:36:21,963 - __main__ - INFO - MAE: 60.7211
2024-12-19 12:36:21,965 - __main__ - WARNING - Feature importance length mismatch: 3 vs 53
2024-12-19 12:36:21,967 - __main__ - INFO - 
Top 10 Most Important Features:
2024-12-19 12:36:21,970 - __main__ - INFO -                  feature  importance  importance_percentage
1  AvgDiscountPercentage    0.541399              54.139880
0           AveragePrice    0.408668              40.866799
2              AvgRating    0.049933               4.993321
2024-12-19 12:36:22,127 - __main__ - INFO - Model saved to /home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/src/models/training/trained_models/sales_predictor.joblib
2024-12-19 12:36:22,628 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:37:13,329 - __main__ - INFO - Starting enhanced model training process...
2024-12-19 12:37:25,368 - __main__ - INFO - Successfully loaded tables:
2024-12-19 12:37:25,368 - __main__ - INFO - Revenue: (25, 6)
2024-12-19 12:37:25,368 - __main__ - INFO - Discount: (25, 7)
2024-12-19 12:37:25,368 - __main__ - INFO - Price Correlation: (25, 6)
2024-12-19 12:37:25,368 - __main__ - INFO - Reviews: (25, 7)
2024-12-19 12:37:25,369 - __main__ - INFO - Found categories: ['ART AND CRAFTING MATERIALS', 'BATH AND BODY', 'BEDSHEETS', 'BICYCLES', 'BLANKETS', 'BOOKS', 'CANDLES', 'CLOTHING', 'COATS AND JACKETS', 'COOKWARE', 'DRINKWARE', 'ELECTRONICS', 'HOME & KITCHEN', 'MAKEUP', 'MOBILE PHONE ACCESSORIES', 'MOTOR VEHICLE PARTS', 'NAIL CARE', 'PERFUME AND COLOGNE', 'POSTERS AND ARTWORK', 'SKIN CARE', 'SOCKS', 'TOYS & GAMES', 'UNDERWEAR', 'VITAMINS AND SUPPLEMENTS', 'WINE']
2024-12-19 12:37:25,377 - __main__ - INFO - Final merged dataset shape: (25, 23)
2024-12-19 12:37:25,377 - __main__ - INFO - Available columns: ['Category', 'TotalRevenue', 'TotalSales', 'AveragePrice', 'ProductCount', 'AvgDiscountPercentage', 'AvgDiscountPercentage_disc', 'TotalDiscountedRevenue', 'PotentialRevenue', 'AvgSales', 'RevenueLossFromDiscount', 'DiscountROI', 'PriceRatingCorrelation', 'AvgPrice', 'AvgRating', 'AvgReviews', 'PriceRatingRelationship', 'TotalReviews', 'TotalSales_review', 'AvgRating_review', 'HighRatingCount', 'ReviewToSalesRatio', 'CustomerEngagementLevel']
2024-12-19 12:37:25,822 - __main__ - INFO - Created advanced features. Shape: (25, 44)
2024-12-19 12:37:25,822 - __main__ - INFO - Number of numeric features: 23
2024-12-19 12:37:25,822 - __main__ - INFO - Number of categorical features: 3
2024-12-19 12:37:25,826 - __main__ - INFO - Training stacked model...
2024-12-19 12:37:25,888 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:37:25,908 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:37:25,917 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:37:25,926 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:37:25,947 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:37:25,949 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:37:25,954 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:37:25,972 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:37:25,981 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:37:25,985 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:37:26,001 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:37:26,004 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:37:26,013 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:37:26,029 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:37:26,031 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:37:26,041 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:37:26,049 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:37:27,627 - py4j.clientserver - INFO - Error while sending or receiving.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer
2024-12-19 12:37:27,629 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:37:27,629 - root - INFO - Exception while sending command.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 506, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending
2024-12-19 12:37:27,640 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:37:30,424 - __main__ - INFO - Model Performance:
2024-12-19 12:37:30,424 - __main__ - INFO - RÂ² score: 0.9832
2024-12-19 12:37:30,424 - __main__ - INFO - MSE: 5020.8544
2024-12-19 12:37:30,424 - __main__ - INFO - RMSE: 70.8580
2024-12-19 12:37:30,424 - __main__ - INFO - MAE: 60.7211
2024-12-19 12:37:30,426 - __main__ - WARNING - Feature importance length mismatch: 3 vs 53
2024-12-19 12:37:30,428 - __main__ - INFO - 
Top 10 Most Important Features:
2024-12-19 12:37:30,428 - __main__ - INFO -                  feature  importance  importance_percentage
1  AvgDiscountPercentage    0.541399              54.139880
0           AveragePrice    0.408668              40.866799
2              AvgRating    0.049933               4.993321
2024-12-19 12:37:30,674 - __main__ - INFO - Model saved to /home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/src/models/training/trained_models/sales_predictor.joblib
2024-12-19 12:37:31,125 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:38:31,759 - __main__ - INFO - Starting enhanced model training process...
2024-12-19 12:38:43,655 - __main__ - INFO - Successfully loaded tables:
2024-12-19 12:38:43,656 - __main__ - INFO - Revenue: (25, 6)
2024-12-19 12:38:43,656 - __main__ - INFO - Discount: (25, 7)
2024-12-19 12:38:43,656 - __main__ - INFO - Price Correlation: (25, 6)
2024-12-19 12:38:43,656 - __main__ - INFO - Reviews: (25, 7)
2024-12-19 12:38:43,657 - __main__ - INFO - Found categories: ['ART AND CRAFTING MATERIALS', 'BATH AND BODY', 'BEDSHEETS', 'BICYCLES', 'BLANKETS', 'BOOKS', 'CANDLES', 'CLOTHING', 'COATS AND JACKETS', 'COOKWARE', 'DRINKWARE', 'ELECTRONICS', 'HOME & KITCHEN', 'MAKEUP', 'MOBILE PHONE ACCESSORIES', 'MOTOR VEHICLE PARTS', 'NAIL CARE', 'PERFUME AND COLOGNE', 'POSTERS AND ARTWORK', 'SKIN CARE', 'SOCKS', 'TOYS & GAMES', 'UNDERWEAR', 'VITAMINS AND SUPPLEMENTS', 'WINE']
2024-12-19 12:38:43,665 - __main__ - INFO - Final merged dataset shape: (25, 23)
2024-12-19 12:38:43,665 - __main__ - INFO - Available columns: ['Category', 'TotalRevenue', 'TotalSales', 'AveragePrice', 'ProductCount', 'AvgDiscountPercentage', 'AvgDiscountPercentage_disc', 'TotalDiscountedRevenue', 'PotentialRevenue', 'AvgSales', 'RevenueLossFromDiscount', 'DiscountROI', 'PriceRatingCorrelation', 'AvgPrice', 'AvgRating', 'AvgReviews', 'PriceRatingRelationship', 'TotalReviews', 'TotalSales_review', 'AvgRating_review', 'HighRatingCount', 'ReviewToSalesRatio', 'CustomerEngagementLevel']
2024-12-19 12:38:44,114 - __main__ - INFO - Created advanced features. Shape: (25, 44)
2024-12-19 12:38:44,115 - __main__ - INFO - Number of numeric features: 23
2024-12-19 12:38:44,115 - __main__ - INFO - Number of categorical features: 3
2024-12-19 12:38:44,120 - __main__ - INFO - Training stacked model...
2024-12-19 12:38:44,171 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:38:44,191 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:38:44,199 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:38:44,208 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:38:44,219 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:38:44,229 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:38:44,236 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:38:44,244 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:38:44,254 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:38:44,259 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:38:44,284 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:38:44,284 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:38:44,294 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:38:44,304 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:38:44,314 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:38:44,318 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:38:44,334 - py4j.clientserver - INFO - Error while sending or receiving.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer
2024-12-19 12:38:44,337 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:38:44,338 - root - INFO - Exception while sending command.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 506, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending
2024-12-19 12:38:44,344 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:38:44,356 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:38:47,698 - __main__ - INFO - Model Performance:
2024-12-19 12:38:47,699 - __main__ - INFO - RÂ² score: 0.9832
2024-12-19 12:38:47,699 - __main__ - INFO - MSE: 5020.8544
2024-12-19 12:38:47,699 - __main__ - INFO - RMSE: 70.8580
2024-12-19 12:38:47,699 - __main__ - INFO - MAE: 60.7211
2024-12-19 12:38:47,700 - __main__ - WARNING - Feature importance length mismatch: 3 vs 53
2024-12-19 12:38:47,702 - __main__ - INFO - 
Top 10 Most Important Features:
2024-12-19 12:38:47,702 - __main__ - INFO -                  feature  importance  importance_percentage
1  AvgDiscountPercentage    0.541399              54.139880
0           AveragePrice    0.408668              40.866799
2              AvgRating    0.049933               4.993321
2024-12-19 12:38:47,843 - __main__ - INFO - Model saved to /home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/src/models/training/trained_models/sales_predictor.joblib
2024-12-19 12:38:48,271 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:39:40,030 - __main__ - INFO - Starting enhanced model training process...
2024-12-19 12:39:48,663 - __main__ - INFO - Successfully loaded tables:
2024-12-19 12:39:48,663 - __main__ - INFO - Revenue: (25, 6)
2024-12-19 12:39:48,663 - __main__ - INFO - Discount: (25, 7)
2024-12-19 12:39:48,663 - __main__ - INFO - Price Correlation: (25, 6)
2024-12-19 12:39:48,663 - __main__ - INFO - Reviews: (25, 7)
2024-12-19 12:39:48,664 - __main__ - INFO - Found categories: ['ART AND CRAFTING MATERIALS', 'BATH AND BODY', 'BEDSHEETS', 'BICYCLES', 'BLANKETS', 'BOOKS', 'CANDLES', 'CLOTHING', 'COATS AND JACKETS', 'COOKWARE', 'DRINKWARE', 'ELECTRONICS', 'HOME & KITCHEN', 'MAKEUP', 'MOBILE PHONE ACCESSORIES', 'MOTOR VEHICLE PARTS', 'NAIL CARE', 'PERFUME AND COLOGNE', 'POSTERS AND ARTWORK', 'SKIN CARE', 'SOCKS', 'TOYS & GAMES', 'UNDERWEAR', 'VITAMINS AND SUPPLEMENTS', 'WINE']
2024-12-19 12:39:48,672 - __main__ - INFO - Final merged dataset shape: (25, 23)
2024-12-19 12:39:48,672 - __main__ - INFO - Available columns: ['Category', 'TotalRevenue', 'TotalSales', 'AveragePrice', 'ProductCount', 'AvgDiscountPercentage', 'AvgDiscountPercentage_disc', 'TotalDiscountedRevenue', 'PotentialRevenue', 'AvgSales', 'RevenueLossFromDiscount', 'DiscountROI', 'PriceRatingCorrelation', 'AvgPrice', 'AvgRating', 'AvgReviews', 'PriceRatingRelationship', 'TotalReviews', 'TotalSales_review', 'AvgRating_review', 'HighRatingCount', 'ReviewToSalesRatio', 'CustomerEngagementLevel']
2024-12-19 12:39:48,826 - __main__ - INFO - Created advanced features. Shape: (25, 44)
2024-12-19 12:39:48,826 - __main__ - INFO - Number of numeric features: 23
2024-12-19 12:39:48,826 - __main__ - INFO - Number of categorical features: 3
2024-12-19 12:39:48,830 - __main__ - INFO - Training stacked model...
2024-12-19 12:39:48,894 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:39:48,917 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:39:48,926 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:39:48,935 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:39:48,956 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:39:48,955 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:39:48,976 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:39:48,999 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:39:49,006 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:39:49,009 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:39:49,016 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:39:49,026 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:39:49,047 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:39:49,054 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:39:49,070 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:39:49,076 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:39:49,086 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:39:49,164 - py4j.clientserver - INFO - Error while sending or receiving.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer
2024-12-19 12:39:49,165 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:39:49,166 - root - INFO - Exception while sending command.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 506, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending
2024-12-19 12:39:49,186 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:39:53,096 - __main__ - INFO - Model Performance:
2024-12-19 12:39:53,096 - __main__ - INFO - RÂ² score: 0.9832
2024-12-19 12:39:53,096 - __main__ - INFO - MSE: 5020.8544
2024-12-19 12:39:53,096 - __main__ - INFO - RMSE: 70.8580
2024-12-19 12:39:53,097 - __main__ - INFO - MAE: 60.7211
2024-12-19 12:39:53,099 - __main__ - WARNING - Feature importance length mismatch: 3 vs 53
2024-12-19 12:39:53,102 - __main__ - INFO - 
Top 10 Most Important Features:
2024-12-19 12:39:53,102 - __main__ - INFO -                  feature  importance  importance_percentage
1  AvgDiscountPercentage    0.541399              54.139880
0           AveragePrice    0.408668              40.866799
2              AvgRating    0.049933               4.993321
2024-12-19 12:39:53,322 - __main__ - INFO - Model saved to /home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/src/models/training/trained_models/sales_predictor.joblib
2024-12-19 12:39:53,885 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:40:48,602 - __main__ - INFO - Starting enhanced model training process...
2024-12-19 12:40:56,240 - __main__ - INFO - Successfully loaded tables:
2024-12-19 12:40:56,240 - __main__ - INFO - Revenue: (25, 6)
2024-12-19 12:40:56,240 - __main__ - INFO - Discount: (25, 7)
2024-12-19 12:40:56,240 - __main__ - INFO - Price Correlation: (25, 6)
2024-12-19 12:40:56,240 - __main__ - INFO - Reviews: (25, 7)
2024-12-19 12:40:56,240 - __main__ - INFO - Found categories: ['ART AND CRAFTING MATERIALS', 'BATH AND BODY', 'BEDSHEETS', 'BICYCLES', 'BLANKETS', 'BOOKS', 'CANDLES', 'CLOTHING', 'COATS AND JACKETS', 'COOKWARE', 'DRINKWARE', 'ELECTRONICS', 'HOME & KITCHEN', 'MAKEUP', 'MOBILE PHONE ACCESSORIES', 'MOTOR VEHICLE PARTS', 'NAIL CARE', 'PERFUME AND COLOGNE', 'POSTERS AND ARTWORK', 'SKIN CARE', 'SOCKS', 'TOYS & GAMES', 'UNDERWEAR', 'VITAMINS AND SUPPLEMENTS', 'WINE']
2024-12-19 12:40:56,245 - __main__ - INFO - Final merged dataset shape: (25, 23)
2024-12-19 12:40:56,245 - __main__ - INFO - Available columns: ['Category', 'TotalRevenue', 'TotalSales', 'AveragePrice', 'ProductCount', 'AvgDiscountPercentage', 'AvgDiscountPercentage_disc', 'TotalDiscountedRevenue', 'PotentialRevenue', 'AvgSales', 'RevenueLossFromDiscount', 'DiscountROI', 'PriceRatingCorrelation', 'AvgPrice', 'AvgRating', 'AvgReviews', 'PriceRatingRelationship', 'TotalReviews', 'TotalSales_review', 'AvgRating_review', 'HighRatingCount', 'ReviewToSalesRatio', 'CustomerEngagementLevel']
2024-12-19 12:40:56,416 - __main__ - INFO - Created advanced features. Shape: (25, 44)
2024-12-19 12:40:56,416 - __main__ - INFO - Number of numeric features: 23
2024-12-19 12:40:56,416 - __main__ - INFO - Number of categorical features: 3
2024-12-19 12:40:56,419 - __main__ - INFO - Training stacked model...
2024-12-19 12:40:56,463 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:40:56,475 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:40:56,479 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:40:56,485 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:40:56,490 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:40:56,495 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:40:56,500 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:40:56,506 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:40:56,512 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:40:56,518 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:40:56,524 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:40:56,530 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:40:56,537 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:40:56,550 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:40:56,589 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:40:56,592 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:40:56,594 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:40:56,637 - py4j.clientserver - INFO - Error while sending or receiving.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer
2024-12-19 12:40:56,640 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:40:56,640 - root - INFO - Exception while sending command.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 506, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending
2024-12-19 12:40:56,671 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:40:59,522 - __main__ - INFO - Model Performance:
2024-12-19 12:40:59,522 - __main__ - INFO - RÂ² score: 0.9832
2024-12-19 12:40:59,522 - __main__ - INFO - MSE: 5020.8544
2024-12-19 12:40:59,522 - __main__ - INFO - RMSE: 70.8580
2024-12-19 12:40:59,522 - __main__ - INFO - MAE: 60.7211
2024-12-19 12:40:59,523 - __main__ - WARNING - Feature importance length mismatch: 3 vs 53
2024-12-19 12:40:59,524 - __main__ - INFO - 
Top 10 Most Important Features:
2024-12-19 12:40:59,524 - __main__ - INFO -                  feature  importance  importance_percentage
1  AvgDiscountPercentage    0.541399              54.139880
0           AveragePrice    0.408668              40.866799
2              AvgRating    0.049933               4.993321
2024-12-19 12:40:59,654 - __main__ - INFO - Model saved to /home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/src/models/training/trained_models/sales_predictor.joblib
2024-12-19 12:41:00,041 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:41:01,810 - __main__ - INFO - Starting enhanced model training process...
2024-12-19 12:41:04,716 - root - ERROR - KeyboardInterrupt while sending command.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
                          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.11/socket.py", line 718, in readinto
    return self._sock.recv_into(b)
           ^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt
2024-12-19 12:41:04,719 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:41:04,719 - __main__ - ERROR - Error in model training: 'Builder' object has no attribute 'stop'
2024-12-19 12:41:04,719 - __main__ - ERROR - Error in main: 'Builder' object has no attribute 'stop'
2024-12-19 12:41:04,789 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:41:17,200 - __main__ - INFO - Starting enhanced model training process...
2024-12-19 12:41:23,644 - __main__ - INFO - Successfully loaded tables:
2024-12-19 12:41:23,644 - __main__ - INFO - Revenue: (25, 6)
2024-12-19 12:41:23,644 - __main__ - INFO - Discount: (25, 7)
2024-12-19 12:41:23,644 - __main__ - INFO - Price Correlation: (25, 6)
2024-12-19 12:41:23,644 - __main__ - INFO - Reviews: (25, 7)
2024-12-19 12:41:23,645 - __main__ - INFO - Found categories: ['ART AND CRAFTING MATERIALS', 'BATH AND BODY', 'BEDSHEETS', 'BICYCLES', 'BLANKETS', 'BOOKS', 'CANDLES', 'CLOTHING', 'COATS AND JACKETS', 'COOKWARE', 'DRINKWARE', 'ELECTRONICS', 'HOME & KITCHEN', 'MAKEUP', 'MOBILE PHONE ACCESSORIES', 'MOTOR VEHICLE PARTS', 'NAIL CARE', 'PERFUME AND COLOGNE', 'POSTERS AND ARTWORK', 'SKIN CARE', 'SOCKS', 'TOYS & GAMES', 'UNDERWEAR', 'VITAMINS AND SUPPLEMENTS', 'WINE']
2024-12-19 12:41:23,649 - __main__ - INFO - Final merged dataset shape: (25, 23)
2024-12-19 12:41:23,650 - __main__ - INFO - Available columns: ['Category', 'TotalRevenue', 'TotalSales', 'AveragePrice', 'ProductCount', 'AvgDiscountPercentage', 'AvgDiscountPercentage_disc', 'TotalDiscountedRevenue', 'PotentialRevenue', 'AvgSales', 'RevenueLossFromDiscount', 'DiscountROI', 'PriceRatingCorrelation', 'AvgPrice', 'AvgRating', 'AvgReviews', 'PriceRatingRelationship', 'TotalReviews', 'TotalSales_review', 'AvgRating_review', 'HighRatingCount', 'ReviewToSalesRatio', 'CustomerEngagementLevel']
2024-12-19 12:41:23,836 - __main__ - INFO - Created advanced features. Shape: (25, 44)
2024-12-19 12:41:23,836 - __main__ - INFO - Number of numeric features: 23
2024-12-19 12:41:23,836 - __main__ - INFO - Number of categorical features: 3
2024-12-19 12:41:23,838 - __main__ - INFO - Training stacked model...
2024-12-19 12:41:23,863 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:41:23,876 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:41:23,885 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:41:23,891 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:41:23,898 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:41:23,905 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:41:23,912 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:41:23,920 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:41:23,928 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:41:23,935 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:41:23,936 - py4j.clientserver - INFO - Error while sending or receiving.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer
2024-12-19 12:41:23,952 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:41:23,952 - root - INFO - Exception while sending command.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 506, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending
2024-12-19 12:41:23,975 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:41:24,018 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:41:24,025 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:41:25,000 - py4j.clientserver - INFO - Error while sending or receiving.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer
2024-12-19 12:41:25,001 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:41:25,001 - root - INFO - Exception while sending command.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 506, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending
2024-12-19 12:41:25,003 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:41:26,391 - __main__ - INFO - Model Performance:
2024-12-19 12:41:26,391 - __main__ - INFO - RÂ² score: 0.9832
2024-12-19 12:41:26,392 - __main__ - INFO - MSE: 5020.8544
2024-12-19 12:41:26,392 - __main__ - INFO - RMSE: 70.8580
2024-12-19 12:41:26,392 - __main__ - INFO - MAE: 60.7211
2024-12-19 12:41:26,393 - __main__ - WARNING - Feature importance length mismatch: 3 vs 53
2024-12-19 12:41:26,394 - __main__ - INFO - 
Top 10 Most Important Features:
2024-12-19 12:41:26,394 - __main__ - INFO -                  feature  importance  importance_percentage
1  AvgDiscountPercentage    0.541399              54.139880
0           AveragePrice    0.408668              40.866799
2              AvgRating    0.049933               4.993321
2024-12-19 12:41:26,520 - __main__ - INFO - Model saved to /home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/src/models/training/trained_models/sales_predictor.joblib
2024-12-19 12:41:26,832 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:43:03,594 - __main__ - INFO - Starting enhanced model training process...
2024-12-19 12:43:09,646 - __main__ - INFO - Successfully loaded tables:
2024-12-19 12:43:09,646 - __main__ - INFO - Revenue: (25, 6)
2024-12-19 12:43:09,646 - __main__ - INFO - Discount: (25, 7)
2024-12-19 12:43:09,646 - __main__ - INFO - Price Correlation: (25, 6)
2024-12-19 12:43:09,646 - __main__ - INFO - Reviews: (25, 7)
2024-12-19 12:43:09,647 - __main__ - INFO - Found categories: ['ART AND CRAFTING MATERIALS', 'BATH AND BODY', 'BEDSHEETS', 'BICYCLES', 'BLANKETS', 'BOOKS', 'CANDLES', 'CLOTHING', 'COATS AND JACKETS', 'COOKWARE', 'DRINKWARE', 'ELECTRONICS', 'HOME & KITCHEN', 'MAKEUP', 'MOBILE PHONE ACCESSORIES', 'MOTOR VEHICLE PARTS', 'NAIL CARE', 'PERFUME AND COLOGNE', 'POSTERS AND ARTWORK', 'SKIN CARE', 'SOCKS', 'TOYS & GAMES', 'UNDERWEAR', 'VITAMINS AND SUPPLEMENTS', 'WINE']
2024-12-19 12:43:09,651 - __main__ - INFO - Final merged dataset shape: (25, 23)
2024-12-19 12:43:09,651 - __main__ - INFO - Available columns: ['Category', 'TotalRevenue', 'TotalSales', 'AveragePrice', 'ProductCount', 'AvgDiscountPercentage', 'AvgDiscountPercentage_disc', 'TotalDiscountedRevenue', 'PotentialRevenue', 'AvgSales', 'RevenueLossFromDiscount', 'DiscountROI', 'PriceRatingCorrelation', 'AvgPrice', 'AvgRating', 'AvgReviews', 'PriceRatingRelationship', 'TotalReviews', 'TotalSales_review', 'AvgRating_review', 'HighRatingCount', 'ReviewToSalesRatio', 'CustomerEngagementLevel']
2024-12-19 12:43:09,819 - __main__ - INFO - Created advanced features. Shape: (25, 44)
2024-12-19 12:43:09,819 - __main__ - INFO - Number of numeric features: 23
2024-12-19 12:43:09,819 - __main__ - INFO - Number of categorical features: 3
2024-12-19 12:43:09,821 - __main__ - INFO - Training stacked model...
2024-12-19 12:43:09,846 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:43:09,856 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:43:09,861 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:43:09,865 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:43:09,870 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:43:09,874 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:43:09,880 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:43:09,886 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:43:09,892 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:43:09,899 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:43:09,905 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:43:09,913 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:43:09,940 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:43:09,951 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:43:09,970 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:43:09,985 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:43:09,996 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:43:10,427 - py4j.clientserver - INFO - Error while sending or receiving.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer
2024-12-19 12:43:10,428 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:43:10,428 - root - INFO - Exception while sending command.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 506, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending
2024-12-19 12:43:10,432 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:43:12,354 - __main__ - INFO - Model Performance:
2024-12-19 12:43:12,355 - __main__ - INFO - RÂ² score: 0.9832
2024-12-19 12:43:12,355 - __main__ - INFO - MSE: 5020.8544
2024-12-19 12:43:12,355 - __main__ - INFO - RMSE: 70.8580
2024-12-19 12:43:12,355 - __main__ - INFO - MAE: 60.7211
2024-12-19 12:43:12,356 - __main__ - WARNING - Feature importance length mismatch: 3 vs 53
2024-12-19 12:43:12,357 - __main__ - INFO - 
Top 10 Most Important Features:
2024-12-19 12:43:12,357 - __main__ - INFO -                  feature  importance  importance_percentage
1  AvgDiscountPercentage    0.541399              54.139880
0           AveragePrice    0.408668              40.866799
2              AvgRating    0.049933               4.993321
2024-12-19 12:43:12,494 - __main__ - INFO - Model saved to /home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/src/models/training/trained_models/sales_predictor.joblib
2024-12-19 12:43:12,849 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:44:47,582 - __main__ - INFO - Starting enhanced model training process...
2024-12-19 12:44:53,570 - __main__ - INFO - Successfully loaded tables:
2024-12-19 12:44:53,571 - __main__ - INFO - Revenue: (25, 6)
2024-12-19 12:44:53,571 - __main__ - INFO - Discount: (25, 7)
2024-12-19 12:44:53,572 - __main__ - INFO - Price Correlation: (25, 6)
2024-12-19 12:44:53,572 - __main__ - INFO - Reviews: (25, 7)
2024-12-19 12:44:53,572 - __main__ - INFO - Found categories: ['ART AND CRAFTING MATERIALS', 'BATH AND BODY', 'BEDSHEETS', 'BICYCLES', 'BLANKETS', 'BOOKS', 'CANDLES', 'CLOTHING', 'COATS AND JACKETS', 'COOKWARE', 'DRINKWARE', 'ELECTRONICS', 'HOME & KITCHEN', 'MAKEUP', 'MOBILE PHONE ACCESSORIES', 'MOTOR VEHICLE PARTS', 'NAIL CARE', 'PERFUME AND COLOGNE', 'POSTERS AND ARTWORK', 'SKIN CARE', 'SOCKS', 'TOYS & GAMES', 'UNDERWEAR', 'VITAMINS AND SUPPLEMENTS', 'WINE']
2024-12-19 12:44:53,591 - __main__ - INFO - Final merged dataset shape: (25, 23)
2024-12-19 12:44:53,591 - __main__ - INFO - Available columns: ['Category', 'TotalRevenue', 'TotalSales', 'AveragePrice', 'ProductCount', 'AvgDiscountPercentage', 'AvgDiscountPercentage_disc', 'TotalDiscountedRevenue', 'PotentialRevenue', 'AvgSales', 'RevenueLossFromDiscount', 'DiscountROI', 'PriceRatingCorrelation', 'AvgPrice', 'AvgRating', 'AvgReviews', 'PriceRatingRelationship', 'TotalReviews', 'TotalSales_review', 'AvgRating_review', 'HighRatingCount', 'ReviewToSalesRatio', 'CustomerEngagementLevel']
2024-12-19 12:44:54,080 - __main__ - INFO - Created advanced features. Shape: (25, 44)
2024-12-19 12:44:54,081 - __main__ - INFO - Number of numeric features: 23
2024-12-19 12:44:54,081 - __main__ - INFO - Number of categorical features: 3
2024-12-19 12:44:54,083 - __main__ - INFO - Training stacked model...
2024-12-19 12:44:54,109 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:44:54,119 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:44:54,123 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:44:54,128 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:44:54,132 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:44:54,137 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:44:54,142 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:44:54,147 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:44:54,153 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:44:54,159 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:44:54,166 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:44:54,172 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:44:54,179 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:44:54,187 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:44:54,212 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:44:54,216 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:44:54,216 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:44:54,214 - py4j.clientserver - INFO - Error while sending or receiving.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer
2024-12-19 12:44:54,218 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:44:54,219 - root - INFO - Exception while sending command.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 506, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending
2024-12-19 12:44:54,233 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:44:56,444 - __main__ - INFO - Model Performance:
2024-12-19 12:44:56,444 - __main__ - INFO - RÂ² score: 0.9832
2024-12-19 12:44:56,444 - __main__ - INFO - MSE: 5020.8544
2024-12-19 12:44:56,444 - __main__ - INFO - RMSE: 70.8580
2024-12-19 12:44:56,444 - __main__ - INFO - MAE: 60.7211
2024-12-19 12:44:56,445 - __main__ - WARNING - Feature importance length mismatch: 3 vs 53
2024-12-19 12:44:56,446 - __main__ - INFO - 
Top 10 Most Important Features:
2024-12-19 12:44:56,446 - __main__ - INFO -                  feature  importance  importance_percentage
1  AvgDiscountPercentage    0.541399              54.139880
0           AveragePrice    0.408668              40.866799
2              AvgRating    0.049933               4.993321
2024-12-19 12:44:56,544 - __main__ - INFO - Model saved to /home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/src/models/training/trained_models/sales_predictor.joblib
2024-12-19 12:44:56,825 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:46:25,737 - __main__ - INFO - Starting enhanced model training process...
2024-12-19 12:46:35,961 - __main__ - WARNING - Error reading as Delta format: An error occurred while calling o41.collectToPython.
: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 1.0 failed 1 times, most recent failure: Lost task 0.0 in stage 1.0 (TID 1) (10.255.255.254 executor driver): org.apache.spark.SparkFileNotFoundException: File file:/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/src/data/gold/revenue_per_category_parquet/part-00000-65276640-d026-4bc7-88fd-3fcebc004670-c000.snappy.parquet does not exist
It is possible the underlying files have been updated. You can explicitly invalidate the cache in Spark by running 'REFRESH TABLE tableName' command in SQL or by recreating the Dataset/DataFrame involved.
	at org.apache.spark.sql.errors.QueryExecutionErrors$.readCurrentFileNotFoundError(QueryExecutionErrors.scala:780)
	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.org$apache$spark$sql$execution$datasources$FileScanRDD$$anon$$readCurrentFile(FileScanRDD.scala:220)
	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.nextIterator(FileScanRDD.scala:279)
	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.hasNext(FileScanRDD.scala:129)
	at org.apache.spark.sql.execution.FileSourceScanExec$$anon$1.hasNext(DataSourceScanExec.scala:593)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.columnartorow_nextBatch_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenEvaluatorFactory$WholeStageCodegenPartitionEvaluator$$anon$1.hasNext(WholeStageCodegenEvaluatorFactory.scala:43)
	at org.apache.spark.sql.execution.SparkPlan.$anonfun$getByteArrayRdd$1(SparkPlan.scala:388)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2(RDD.scala:890)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2$adapted(RDD.scala:890)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)
	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)
	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:161)
	at org.apache.spark.scheduler.Task.run(Task.scala:141)
	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)

Driver stacktrace:
	at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2844)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2780)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2779)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2779)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1242)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1242)
	at scala.Option.foreach(Option.scala:407)
	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1242)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:3048)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2982)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2971)
	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)
	at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:984)
	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2398)
	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2419)
	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2438)
	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2463)
	at org.apache.spark.rdd.RDD.$anonfun$collect$1(RDD.scala:1046)
	at org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:151)
	at org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:112)
	at org.apache.spark.rdd.RDD.withScope(RDD.scala:407)
	at org.apache.spark.rdd.RDD.collect(RDD.scala:1045)
	at org.apache.spark.sql.execution.SparkPlan.executeCollect(SparkPlan.scala:448)
	at org.apache.spark.sql.Dataset.$anonfun$collectToPython$1(Dataset.scala:4160)
	at org.apache.spark.sql.Dataset.$anonfun$withAction$2(Dataset.scala:4334)
	at org.apache.spark.sql.execution.QueryExecution$.withInternalError(QueryExecution.scala:546)
	at org.apache.spark.sql.Dataset.$anonfun$withAction$1(Dataset.scala:4332)
	at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$6(SQLExecution.scala:125)
	at org.apache.spark.sql.execution.SQLExecution$.withSQLConfPropagated(SQLExecution.scala:201)
	at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$1(SQLExecution.scala:108)
	at org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:900)
	at org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:66)
	at org.apache.spark.sql.Dataset.withAction(Dataset.scala:4332)
	at org.apache.spark.sql.Dataset.collectToPython(Dataset.scala:4157)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: org.apache.spark.SparkFileNotFoundException: File file:/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/src/data/gold/revenue_per_category_parquet/part-00000-65276640-d026-4bc7-88fd-3fcebc004670-c000.snappy.parquet does not exist
It is possible the underlying files have been updated. You can explicitly invalidate the cache in Spark by running 'REFRESH TABLE tableName' command in SQL or by recreating the Dataset/DataFrame involved.
	at org.apache.spark.sql.errors.QueryExecutionErrors$.readCurrentFileNotFoundError(QueryExecutionErrors.scala:780)
	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.org$apache$spark$sql$execution$datasources$FileScanRDD$$anon$$readCurrentFile(FileScanRDD.scala:220)
	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.nextIterator(FileScanRDD.scala:279)
	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.hasNext(FileScanRDD.scala:129)
	at org.apache.spark.sql.execution.FileSourceScanExec$$anon$1.hasNext(DataSourceScanExec.scala:593)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.columnartorow_nextBatch_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenEvaluatorFactory$WholeStageCodegenPartitionEvaluator$$anon$1.hasNext(WholeStageCodegenEvaluatorFactory.scala:43)
	at org.apache.spark.sql.execution.SparkPlan.$anonfun$getByteArrayRdd$1(SparkPlan.scala:388)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2(RDD.scala:890)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2$adapted(RDD.scala:890)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)
	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)
	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:161)
	at org.apache.spark.scheduler.Task.run(Task.scala:141)
	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	... 1 more

2024-12-19 12:46:35,962 - __main__ - INFO - Trying to read as parquet format...
2024-12-19 12:46:35,962 - __main__ - ERROR - Error in load_data: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2024-12-19 12:46:36,479 - __main__ - ERROR - Error in model training: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2024-12-19 12:46:36,479 - __main__ - ERROR - Error in main: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2024-12-19 12:46:36,532 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:47:11,380 - __main__ - INFO - Starting enhanced model training process...
2024-12-19 12:47:23,935 - __main__ - INFO - Successfully loaded tables:
2024-12-19 12:47:23,936 - __main__ - INFO - Revenue: (25, 6)
2024-12-19 12:47:23,936 - __main__ - INFO - Discount: (25, 7)
2024-12-19 12:47:23,936 - __main__ - INFO - Price Correlation: (25, 6)
2024-12-19 12:47:23,936 - __main__ - INFO - Reviews: (25, 7)
2024-12-19 12:47:23,936 - __main__ - INFO - Found categories: ['ART AND CRAFTING MATERIALS', 'BATH AND BODY', 'BEDSHEETS', 'BICYCLES', 'BLANKETS', 'BOOKS', 'CANDLES', 'CLOTHING', 'COATS AND JACKETS', 'COOKWARE', 'DRINKWARE', 'ELECTRONICS', 'HOME & KITCHEN', 'MAKEUP', 'MOBILE PHONE ACCESSORIES', 'MOTOR VEHICLE PARTS', 'NAIL CARE', 'PERFUME AND COLOGNE', 'POSTERS AND ARTWORK', 'SKIN CARE', 'SOCKS', 'TOYS & GAMES', 'UNDERWEAR', 'VITAMINS AND SUPPLEMENTS', 'WINE']
2024-12-19 12:47:23,943 - __main__ - INFO - Final merged dataset shape: (25, 23)
2024-12-19 12:47:23,944 - __main__ - INFO - Available columns: ['Category', 'TotalRevenue', 'TotalSales', 'AveragePrice', 'ProductCount', 'AvgDiscountPercentage', 'AvgDiscountPercentage_disc', 'TotalDiscountedRevenue', 'PotentialRevenue', 'AvgSales', 'RevenueLossFromDiscount', 'DiscountROI', 'PriceRatingCorrelation', 'AvgPrice', 'AvgRating', 'AvgReviews', 'PriceRatingRelationship', 'TotalReviews', 'TotalSales_review', 'AvgRating_review', 'HighRatingCount', 'ReviewToSalesRatio', 'CustomerEngagementLevel']
2024-12-19 12:47:24,495 - __main__ - INFO - Created advanced features. Shape: (25, 44)
2024-12-19 12:47:24,495 - __main__ - INFO - Number of numeric features: 23
2024-12-19 12:47:24,495 - __main__ - INFO - Number of categorical features: 3
2024-12-19 12:47:24,498 - __main__ - INFO - Training stacked model...
2024-12-19 12:47:24,531 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:47:24,541 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:47:24,545 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:47:24,550 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:47:24,554 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:47:24,560 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:47:24,565 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:47:24,570 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:47:24,576 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:47:24,583 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:47:24,591 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:47:24,598 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:47:24,600 - py4j.clientserver - INFO - Error while sending or receiving.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer
2024-12-19 12:47:24,621 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:47:24,623 - root - INFO - Exception while sending command.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 506, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending
2024-12-19 12:47:24,658 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:47:27,139 - __main__ - INFO - Model Performance:
2024-12-19 12:47:27,139 - __main__ - INFO - RÂ² score: 0.9832
2024-12-19 12:47:27,139 - __main__ - INFO - MSE: 5020.8544
2024-12-19 12:47:27,139 - __main__ - INFO - RMSE: 70.8580
2024-12-19 12:47:27,139 - __main__ - INFO - MAE: 60.7211
2024-12-19 12:47:27,140 - __main__ - WARNING - Feature importance length mismatch: 3 vs 53
2024-12-19 12:47:27,141 - __main__ - INFO - 
Top 10 Most Important Features:
2024-12-19 12:47:27,141 - __main__ - INFO -                  feature  importance  importance_percentage
1  AvgDiscountPercentage    0.541399              54.139880
0           AveragePrice    0.408668              40.866799
2              AvgRating    0.049933               4.993321
2024-12-19 12:47:27,261 - __main__ - INFO - Model saved to /home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/src/models/training/trained_models/sales_predictor.joblib
2024-12-19 12:47:27,587 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:48:30,023 - __main__ - INFO - Starting enhanced model training process...
2024-12-19 12:48:38,314 - __main__ - INFO - Successfully loaded tables:
2024-12-19 12:48:38,315 - __main__ - INFO - Revenue: (25, 6)
2024-12-19 12:48:38,315 - __main__ - INFO - Discount: (25, 7)
2024-12-19 12:48:38,315 - __main__ - INFO - Price Correlation: (25, 6)
2024-12-19 12:48:38,315 - __main__ - INFO - Reviews: (25, 7)
2024-12-19 12:48:38,316 - __main__ - INFO - Found categories: ['ART AND CRAFTING MATERIALS', 'BATH AND BODY', 'BEDSHEETS', 'BICYCLES', 'BLANKETS', 'BOOKS', 'CANDLES', 'CLOTHING', 'COATS AND JACKETS', 'COOKWARE', 'DRINKWARE', 'ELECTRONICS', 'HOME & KITCHEN', 'MAKEUP', 'MOBILE PHONE ACCESSORIES', 'MOTOR VEHICLE PARTS', 'NAIL CARE', 'PERFUME AND COLOGNE', 'POSTERS AND ARTWORK', 'SKIN CARE', 'SOCKS', 'TOYS & GAMES', 'UNDERWEAR', 'VITAMINS AND SUPPLEMENTS', 'WINE']
2024-12-19 12:48:38,325 - __main__ - INFO - Final merged dataset shape: (25, 23)
2024-12-19 12:48:38,325 - __main__ - INFO - Available columns: ['Category', 'TotalRevenue', 'TotalSales', 'AveragePrice', 'ProductCount', 'AvgDiscountPercentage', 'AvgDiscountPercentage_disc', 'TotalDiscountedRevenue', 'PotentialRevenue', 'AvgSales', 'RevenueLossFromDiscount', 'DiscountROI', 'PriceRatingCorrelation', 'AvgPrice', 'AvgRating', 'AvgReviews', 'PriceRatingRelationship', 'TotalReviews', 'TotalSales_review', 'AvgRating_review', 'HighRatingCount', 'ReviewToSalesRatio', 'CustomerEngagementLevel']
2024-12-19 12:48:38,439 - __main__ - INFO - Created advanced features. Shape: (25, 44)
2024-12-19 12:48:38,439 - __main__ - INFO - Number of numeric features: 23
2024-12-19 12:48:38,439 - __main__ - INFO - Number of categorical features: 3
2024-12-19 12:48:38,443 - __main__ - INFO - Training stacked model...
2024-12-19 12:48:38,479 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:48:38,490 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:48:38,496 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:48:38,501 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:48:38,507 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:48:38,513 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:48:38,518 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:48:38,525 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:48:38,532 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:48:38,539 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:48:38,545 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:48:38,551 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:48:38,573 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:48:38,578 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:48:38,580 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:48:38,600 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:48:38,605 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:48:38,798 - py4j.clientserver - INFO - Error while sending or receiving.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer
2024-12-19 12:48:38,799 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:48:38,800 - root - INFO - Exception while sending command.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 506, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending
2024-12-19 12:48:38,825 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:48:41,656 - __main__ - INFO - Model Performance:
2024-12-19 12:48:41,656 - __main__ - INFO - RÂ² score: 0.9832
2024-12-19 12:48:41,656 - __main__ - INFO - MSE: 5020.8544
2024-12-19 12:48:41,656 - __main__ - INFO - RMSE: 70.8580
2024-12-19 12:48:41,656 - __main__ - INFO - MAE: 60.7211
2024-12-19 12:48:41,657 - __main__ - WARNING - Feature importance length mismatch: 3 vs 53
2024-12-19 12:48:41,658 - __main__ - INFO - 
Top 10 Most Important Features:
2024-12-19 12:48:41,658 - __main__ - INFO -                  feature  importance  importance_percentage
1  AvgDiscountPercentage    0.541399              54.139880
0           AveragePrice    0.408668              40.866799
2              AvgRating    0.049933               4.993321
2024-12-19 12:48:41,782 - __main__ - INFO - Model saved to /home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/src/models/training/trained_models/sales_predictor.joblib
2024-12-19 12:48:42,153 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:49:41,987 - __main__ - INFO - Starting enhanced model training process...
2024-12-19 12:49:48,001 - __main__ - INFO - Successfully loaded tables:
2024-12-19 12:49:48,001 - __main__ - INFO - Revenue: (25, 6)
2024-12-19 12:49:48,001 - __main__ - INFO - Discount: (25, 7)
2024-12-19 12:49:48,001 - __main__ - INFO - Price Correlation: (25, 6)
2024-12-19 12:49:48,001 - __main__ - INFO - Reviews: (25, 7)
2024-12-19 12:49:48,002 - __main__ - INFO - Found categories: ['ART AND CRAFTING MATERIALS', 'BATH AND BODY', 'BEDSHEETS', 'BICYCLES', 'BLANKETS', 'BOOKS', 'CANDLES', 'CLOTHING', 'COATS AND JACKETS', 'COOKWARE', 'DRINKWARE', 'ELECTRONICS', 'HOME & KITCHEN', 'MAKEUP', 'MOBILE PHONE ACCESSORIES', 'MOTOR VEHICLE PARTS', 'NAIL CARE', 'PERFUME AND COLOGNE', 'POSTERS AND ARTWORK', 'SKIN CARE', 'SOCKS', 'TOYS & GAMES', 'UNDERWEAR', 'VITAMINS AND SUPPLEMENTS', 'WINE']
2024-12-19 12:49:48,007 - __main__ - INFO - Final merged dataset shape: (25, 23)
2024-12-19 12:49:48,007 - __main__ - INFO - Available columns: ['Category', 'TotalRevenue', 'TotalSales', 'AveragePrice', 'ProductCount', 'AvgDiscountPercentage', 'AvgDiscountPercentage_disc', 'TotalDiscountedRevenue', 'PotentialRevenue', 'AvgSales', 'RevenueLossFromDiscount', 'DiscountROI', 'PriceRatingCorrelation', 'AvgPrice', 'AvgRating', 'AvgReviews', 'PriceRatingRelationship', 'TotalReviews', 'TotalSales_review', 'AvgRating_review', 'HighRatingCount', 'ReviewToSalesRatio', 'CustomerEngagementLevel']
2024-12-19 12:49:48,062 - __main__ - INFO - Created advanced features. Shape: (25, 44)
2024-12-19 12:49:48,063 - __main__ - INFO - Number of numeric features: 23
2024-12-19 12:49:48,063 - __main__ - INFO - Number of categorical features: 3
2024-12-19 12:49:48,065 - __main__ - INFO - Training stacked model...
2024-12-19 12:49:48,090 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:49:48,101 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:49:48,106 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:49:48,111 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:49:48,116 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:49:48,121 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:49:48,126 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:49:48,132 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:49:48,137 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:49:48,144 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:49:48,151 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:49:48,158 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:49:48,181 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:49:48,182 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:49:48,194 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:49:48,201 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:49:48,203 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:49:48,616 - py4j.clientserver - INFO - Error while sending or receiving.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer
2024-12-19 12:49:48,618 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:49:48,618 - root - INFO - Exception while sending command.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 506, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending
2024-12-19 12:49:48,623 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:49:50,650 - __main__ - INFO - Model Performance:
2024-12-19 12:49:50,650 - __main__ - INFO - RÂ² score: 0.9832
2024-12-19 12:49:50,650 - __main__ - INFO - MSE: 5020.8544
2024-12-19 12:49:50,650 - __main__ - INFO - RMSE: 70.8580
2024-12-19 12:49:50,650 - __main__ - INFO - MAE: 60.7211
2024-12-19 12:49:50,651 - __main__ - WARNING - Feature importance length mismatch: 3 vs 53
2024-12-19 12:49:50,652 - __main__ - INFO - 
Top 10 Most Important Features:
2024-12-19 12:49:50,653 - __main__ - INFO -                  feature  importance  importance_percentage
1  AvgDiscountPercentage    0.541399              54.139880
0           AveragePrice    0.408668              40.866799
2              AvgRating    0.049933               4.993321
2024-12-19 12:49:50,765 - __main__ - INFO - Model saved to /home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/src/models/training/trained_models/sales_predictor.joblib
2024-12-19 12:49:51,078 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:50:56,520 - __main__ - INFO - Starting enhanced model training process...
2024-12-19 12:51:00,938 - __main__ - WARNING - Error reading as Delta format: [PATH_NOT_FOUND] Path does not exist: file:/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/src/data/gold/revenue_per_category_parquet.
2024-12-19 12:51:00,938 - __main__ - INFO - Trying to read as parquet format...
2024-12-19 12:51:00,948 - __main__ - ERROR - Error in load_data: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2024-12-19 12:51:01,174 - __main__ - ERROR - Error in model training: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2024-12-19 12:51:01,175 - __main__ - ERROR - Error in main: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2024-12-19 12:51:01,187 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:51:04,653 - __main__ - INFO - Starting enhanced model training process...
2024-12-19 12:51:10,305 - __main__ - WARNING - Error reading as Delta format: [PATH_NOT_FOUND] Path does not exist: file:/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/src/data/gold/revenue_per_category_parquet.
2024-12-19 12:51:10,306 - __main__ - INFO - Trying to read as parquet format...
2024-12-19 12:51:10,311 - __main__ - ERROR - Error in load_data: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2024-12-19 12:51:10,512 - __main__ - ERROR - Error in model training: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2024-12-19 12:51:10,512 - __main__ - ERROR - Error in main: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2024-12-19 12:51:10,519 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:51:16,371 - __main__ - INFO - Starting enhanced model training process...
2024-12-19 12:51:20,446 - __main__ - WARNING - Error reading as Delta format: [PATH_NOT_FOUND] Path does not exist: file:/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/src/data/gold/revenue_per_category_parquet.
2024-12-19 12:51:20,446 - __main__ - INFO - Trying to read as parquet format...
2024-12-19 12:51:20,452 - __main__ - ERROR - Error in load_data: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2024-12-19 12:51:20,976 - __main__ - ERROR - Error in model training: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2024-12-19 12:51:20,976 - __main__ - ERROR - Error in main: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2024-12-19 12:51:20,981 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:52:05,573 - __main__ - INFO - Starting enhanced model training process...
2024-12-19 12:52:13,866 - __main__ - INFO - Successfully loaded tables:
2024-12-19 12:52:13,866 - __main__ - INFO - Revenue: (3, 6)
2024-12-19 12:52:13,866 - __main__ - INFO - Discount: (3, 7)
2024-12-19 12:52:13,867 - __main__ - INFO - Price Correlation: (3, 6)
2024-12-19 12:52:13,867 - __main__ - INFO - Reviews: (3, 7)
2024-12-19 12:52:13,867 - __main__ - INFO - Found categories: ['MOTOR VEHICLE PARTS', 'NAIL CARE', 'UNDERWEAR']
2024-12-19 12:52:13,874 - __main__ - INFO - Final merged dataset shape: (3, 23)
2024-12-19 12:52:13,875 - __main__ - INFO - Available columns: ['Category', 'TotalRevenue', 'TotalSales', 'AveragePrice', 'ProductCount', 'AvgDiscountPercentage', 'AvgDiscountPercentage_disc', 'TotalDiscountedRevenue', 'PotentialRevenue', 'AvgSales', 'RevenueLossFromDiscount', 'DiscountROI', 'PriceRatingCorrelation', 'AvgPrice', 'AvgRating', 'AvgReviews', 'PriceRatingRelationship', 'TotalReviews', 'TotalSales_review', 'AvgRating_review', 'HighRatingCount', 'ReviewToSalesRatio', 'CustomerEngagementLevel']
2024-12-19 12:52:13,983 - __main__ - INFO - Created advanced features. Shape: (3, 44)
2024-12-19 12:52:13,984 - __main__ - INFO - Number of numeric features: 23
2024-12-19 12:52:13,984 - __main__ - INFO - Number of categorical features: 3
2024-12-19 12:52:13,986 - __main__ - INFO - Training stacked model...
2024-12-19 12:52:14,028 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:52:14,039 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:52:14,039 - py4j.clientserver - INFO - Error while sending or receiving.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer
2024-12-19 12:52:14,042 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:52:14,051 - root - INFO - Exception while sending command.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 506, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending
2024-12-19 12:52:14,080 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:52:14,085 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:52:15,392 - __main__ - ERROR - Error in model training: Cannot have number of splits n_splits=5 greater than the number of samples: n_samples=2.
2024-12-19 12:52:15,393 - __main__ - ERROR - Error in main: Cannot have number of splits n_splits=5 greater than the number of samples: n_samples=2.
2024-12-19 12:52:15,397 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:52:21,588 - __main__ - INFO - Starting enhanced model training process...
2024-12-19 12:52:31,853 - __main__ - INFO - Successfully loaded tables:
2024-12-19 12:52:31,853 - __main__ - INFO - Revenue: (3, 6)
2024-12-19 12:52:31,854 - __main__ - INFO - Discount: (3, 7)
2024-12-19 12:52:31,854 - __main__ - INFO - Price Correlation: (3, 6)
2024-12-19 12:52:31,854 - __main__ - INFO - Reviews: (3, 7)
2024-12-19 12:52:31,854 - __main__ - INFO - Found categories: ['MOTOR VEHICLE PARTS', 'NAIL CARE', 'UNDERWEAR']
2024-12-19 12:52:31,860 - __main__ - INFO - Final merged dataset shape: (3, 23)
2024-12-19 12:52:31,860 - __main__ - INFO - Available columns: ['Category', 'TotalRevenue', 'TotalSales', 'AveragePrice', 'ProductCount', 'AvgDiscountPercentage', 'AvgDiscountPercentage_disc', 'TotalDiscountedRevenue', 'PotentialRevenue', 'AvgSales', 'RevenueLossFromDiscount', 'DiscountROI', 'PriceRatingCorrelation', 'AvgPrice', 'AvgRating', 'AvgReviews', 'PriceRatingRelationship', 'TotalReviews', 'TotalSales_review', 'AvgRating_review', 'HighRatingCount', 'ReviewToSalesRatio', 'CustomerEngagementLevel']
2024-12-19 12:52:32,282 - __main__ - INFO - Created advanced features. Shape: (3, 44)
2024-12-19 12:52:32,283 - __main__ - INFO - Number of numeric features: 23
2024-12-19 12:52:32,283 - __main__ - INFO - Number of categorical features: 3
2024-12-19 12:52:32,288 - __main__ - INFO - Training stacked model...
2024-12-19 12:52:32,372 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:52:32,380 - py4j.clientserver - INFO - Error while sending or receiving.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer
2024-12-19 12:52:32,385 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:52:32,387 - root - INFO - Exception while sending command.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 506, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending
2024-12-19 12:52:32,413 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:52:32,585 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:52:32,605 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:52:32,610 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:52:32,634 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:52:32,641 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:52:33,561 - py4j.clientserver - INFO - Error while sending or receiving.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer
2024-12-19 12:52:33,562 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:52:33,562 - root - INFO - Exception while sending command.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 506, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending
2024-12-19 12:52:33,564 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:52:34,402 - __main__ - ERROR - Error in model training: Cannot have number of splits n_splits=5 greater than the number of samples: n_samples=2.
2024-12-19 12:52:34,402 - __main__ - ERROR - Error in main: Cannot have number of splits n_splits=5 greater than the number of samples: n_samples=2.
2024-12-19 12:52:34,405 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:53:13,689 - __main__ - INFO - Starting enhanced model training process...
2024-12-19 12:53:23,436 - __main__ - INFO - Successfully loaded tables:
2024-12-19 12:53:23,436 - __main__ - INFO - Revenue: (5, 6)
2024-12-19 12:53:23,437 - __main__ - INFO - Discount: (5, 7)
2024-12-19 12:53:23,437 - __main__ - INFO - Price Correlation: (5, 6)
2024-12-19 12:53:23,437 - __main__ - INFO - Reviews: (5, 7)
2024-12-19 12:53:23,437 - __main__ - INFO - Found categories: ['BLANKETS', 'MOBILE PHONE ACCESSORIES', 'MOTOR VEHICLE PARTS', 'NAIL CARE', 'UNDERWEAR']
2024-12-19 12:53:23,442 - __main__ - INFO - Final merged dataset shape: (5, 23)
2024-12-19 12:53:23,443 - __main__ - INFO - Available columns: ['Category', 'TotalRevenue', 'TotalSales', 'AveragePrice', 'ProductCount', 'AvgDiscountPercentage', 'AvgDiscountPercentage_disc', 'TotalDiscountedRevenue', 'PotentialRevenue', 'AvgSales', 'RevenueLossFromDiscount', 'DiscountROI', 'PriceRatingCorrelation', 'AvgPrice', 'AvgRating', 'AvgReviews', 'PriceRatingRelationship', 'TotalReviews', 'TotalSales_review', 'AvgRating_review', 'HighRatingCount', 'ReviewToSalesRatio', 'CustomerEngagementLevel']
2024-12-19 12:53:23,510 - __main__ - INFO - Created advanced features. Shape: (5, 44)
2024-12-19 12:53:23,510 - __main__ - INFO - Number of numeric features: 23
2024-12-19 12:53:23,510 - __main__ - INFO - Number of categorical features: 3
2024-12-19 12:53:23,513 - __main__ - INFO - Training stacked model...
2024-12-19 12:53:23,557 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:53:23,568 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:53:23,574 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:53:23,581 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:53:23,587 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:53:23,593 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:53:23,600 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:53:23,607 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:53:23,615 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:53:23,622 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:53:23,629 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:53:23,645 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:53:23,648 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:53:23,667 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:53:23,667 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:53:23,677 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:53:23,704 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:53:23,828 - py4j.clientserver - INFO - Error while sending or receiving.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer
2024-12-19 12:53:23,838 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:53:23,839 - root - INFO - Exception while sending command.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 506, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending
2024-12-19 12:53:23,860 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:53:28,629 - __main__ - ERROR - Error in model training: Cannot have number of splits n_splits=5 greater than the number of samples: n_samples=4.
2024-12-19 12:53:28,629 - __main__ - ERROR - Error in main: Cannot have number of splits n_splits=5 greater than the number of samples: n_samples=4.
2024-12-19 12:53:28,632 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:53:35,636 - __main__ - INFO - Starting enhanced model training process...
2024-12-19 12:53:43,875 - __main__ - WARNING - Error reading as Delta format: An error occurred while calling o41.collectToPython.
: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 1.0 failed 1 times, most recent failure: Lost task 0.0 in stage 1.0 (TID 1) (10.255.255.254 executor driver): org.apache.spark.SparkException: Encountered error while reading file file:///home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/src/data/gold/revenue_per_category_parquet/part-00000-512a0beb-403b-4ecf-81d7-76a6bea4119b-c000.snappy.parquet. Details:
	at org.apache.spark.sql.errors.QueryExecutionErrors$.cannotReadFilesError(QueryExecutionErrors.scala:863)
	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.nextIterator(FileScanRDD.scala:293)
	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.hasNext(FileScanRDD.scala:129)
	at org.apache.spark.sql.execution.FileSourceScanExec$$anon$1.hasNext(DataSourceScanExec.scala:593)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.columnartorow_nextBatch_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenEvaluatorFactory$WholeStageCodegenPartitionEvaluator$$anon$1.hasNext(WholeStageCodegenEvaluatorFactory.scala:43)
	at org.apache.spark.sql.execution.SparkPlan.$anonfun$getByteArrayRdd$1(SparkPlan.scala:388)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2(RDD.scala:890)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2$adapted(RDD.scala:890)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)
	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)
	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:161)
	at org.apache.spark.scheduler.Task.run(Task.scala:141)
	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: java.io.FileNotFoundException: File file:/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/src/data/gold/revenue_per_category_parquet/part-00000-512a0beb-403b-4ecf-81d7-76a6bea4119b-c000.snappy.parquet does not exist
	at org.apache.hadoop.fs.RawLocalFileSystem.deprecatedGetFileStatus(RawLocalFileSystem.java:779)
	at org.apache.hadoop.fs.RawLocalFileSystem.getFileLinkStatusInternal(RawLocalFileSystem.java:1100)
	at org.apache.hadoop.fs.RawLocalFileSystem.getFileStatus(RawLocalFileSystem.java:769)
	at org.apache.hadoop.fs.FilterFileSystem.getFileStatus(FilterFileSystem.java:462)
	at org.apache.hadoop.fs.FileSystem.getContentSummary(FileSystem.java:1818)
	at org.apache.hadoop.fs.ChecksumFileSystem$FSDataBoundedInputStream.getFileLength(ChecksumFileSystem.java:310)
	at org.apache.hadoop.fs.ChecksumFileSystem$FSDataBoundedInputStream.seek(ChecksumFileSystem.java:353)
	at org.apache.parquet.hadoop.util.H1SeekableInputStream.seek(H1SeekableInputStream.java:46)
	at org.apache.parquet.hadoop.ParquetFileReader$ConsecutivePartList.readAll(ParquetFileReader.java:1833)
	at org.apache.parquet.hadoop.ParquetFileReader.internalReadRowGroup(ParquetFileReader.java:990)
	at org.apache.parquet.hadoop.ParquetFileReader.readNextRowGroup(ParquetFileReader.java:940)
	at org.apache.parquet.hadoop.ParquetFileReader.readNextFilteredRowGroup(ParquetFileReader.java:1082)
	at org.apache.spark.sql.execution.datasources.parquet.SpecificParquetRecordReaderBase$ParquetRowGroupReaderImpl.readNextRowGroup(SpecificParquetRecordReaderBase.java:284)
	at org.apache.spark.sql.execution.datasources.parquet.VectorizedParquetRecordReader.checkEndOfRowGroup(VectorizedParquetRecordReader.java:418)
	at org.apache.spark.sql.execution.datasources.parquet.VectorizedParquetRecordReader.nextBatch(VectorizedParquetRecordReader.java:335)
	at org.apache.spark.sql.execution.datasources.parquet.VectorizedParquetRecordReader.nextKeyValue(VectorizedParquetRecordReader.java:233)
	at org.apache.spark.sql.execution.datasources.RecordReaderIterator.hasNext(RecordReaderIterator.scala:39)
	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.hasNext(FileScanRDD.scala:129)
	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.nextIterator(FileScanRDD.scala:283)
	... 23 more

Driver stacktrace:
	at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2844)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2780)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2779)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2779)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1242)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1242)
	at scala.Option.foreach(Option.scala:407)
	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1242)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:3048)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2982)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2971)
	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)
	at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:984)
	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2398)
	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2419)
	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2438)
	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2463)
	at org.apache.spark.rdd.RDD.$anonfun$collect$1(RDD.scala:1046)
	at org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:151)
	at org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:112)
	at org.apache.spark.rdd.RDD.withScope(RDD.scala:407)
	at org.apache.spark.rdd.RDD.collect(RDD.scala:1045)
	at org.apache.spark.sql.execution.SparkPlan.executeCollect(SparkPlan.scala:448)
	at org.apache.spark.sql.Dataset.$anonfun$collectToPython$1(Dataset.scala:4160)
	at org.apache.spark.sql.Dataset.$anonfun$withAction$2(Dataset.scala:4334)
	at org.apache.spark.sql.execution.QueryExecution$.withInternalError(QueryExecution.scala:546)
	at org.apache.spark.sql.Dataset.$anonfun$withAction$1(Dataset.scala:4332)
	at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$6(SQLExecution.scala:125)
	at org.apache.spark.sql.execution.SQLExecution$.withSQLConfPropagated(SQLExecution.scala:201)
	at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$1(SQLExecution.scala:108)
	at org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:900)
	at org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:66)
	at org.apache.spark.sql.Dataset.withAction(Dataset.scala:4332)
	at org.apache.spark.sql.Dataset.collectToPython(Dataset.scala:4157)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: org.apache.spark.SparkException: Encountered error while reading file file:///home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/src/data/gold/revenue_per_category_parquet/part-00000-512a0beb-403b-4ecf-81d7-76a6bea4119b-c000.snappy.parquet. Details:
	at org.apache.spark.sql.errors.QueryExecutionErrors$.cannotReadFilesError(QueryExecutionErrors.scala:863)
	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.nextIterator(FileScanRDD.scala:293)
	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.hasNext(FileScanRDD.scala:129)
	at org.apache.spark.sql.execution.FileSourceScanExec$$anon$1.hasNext(DataSourceScanExec.scala:593)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.columnartorow_nextBatch_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenEvaluatorFactory$WholeStageCodegenPartitionEvaluator$$anon$1.hasNext(WholeStageCodegenEvaluatorFactory.scala:43)
	at org.apache.spark.sql.execution.SparkPlan.$anonfun$getByteArrayRdd$1(SparkPlan.scala:388)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2(RDD.scala:890)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2$adapted(RDD.scala:890)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)
	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)
	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:161)
	at org.apache.spark.scheduler.Task.run(Task.scala:141)
	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	... 1 more
Caused by: java.io.FileNotFoundException: File file:/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/src/data/gold/revenue_per_category_parquet/part-00000-512a0beb-403b-4ecf-81d7-76a6bea4119b-c000.snappy.parquet does not exist
	at org.apache.hadoop.fs.RawLocalFileSystem.deprecatedGetFileStatus(RawLocalFileSystem.java:779)
	at org.apache.hadoop.fs.RawLocalFileSystem.getFileLinkStatusInternal(RawLocalFileSystem.java:1100)
	at org.apache.hadoop.fs.RawLocalFileSystem.getFileStatus(RawLocalFileSystem.java:769)
	at org.apache.hadoop.fs.FilterFileSystem.getFileStatus(FilterFileSystem.java:462)
	at org.apache.hadoop.fs.FileSystem.getContentSummary(FileSystem.java:1818)
	at org.apache.hadoop.fs.ChecksumFileSystem$FSDataBoundedInputStream.getFileLength(ChecksumFileSystem.java:310)
	at org.apache.hadoop.fs.ChecksumFileSystem$FSDataBoundedInputStream.seek(ChecksumFileSystem.java:353)
	at org.apache.parquet.hadoop.util.H1SeekableInputStream.seek(H1SeekableInputStream.java:46)
	at org.apache.parquet.hadoop.ParquetFileReader$ConsecutivePartList.readAll(ParquetFileReader.java:1833)
	at org.apache.parquet.hadoop.ParquetFileReader.internalReadRowGroup(ParquetFileReader.java:990)
	at org.apache.parquet.hadoop.ParquetFileReader.readNextRowGroup(ParquetFileReader.java:940)
	at org.apache.parquet.hadoop.ParquetFileReader.readNextFilteredRowGroup(ParquetFileReader.java:1082)
	at org.apache.spark.sql.execution.datasources.parquet.SpecificParquetRecordReaderBase$ParquetRowGroupReaderImpl.readNextRowGroup(SpecificParquetRecordReaderBase.java:284)
	at org.apache.spark.sql.execution.datasources.parquet.VectorizedParquetRecordReader.checkEndOfRowGroup(VectorizedParquetRecordReader.java:418)
	at org.apache.spark.sql.execution.datasources.parquet.VectorizedParquetRecordReader.nextBatch(VectorizedParquetRecordReader.java:335)
	at org.apache.spark.sql.execution.datasources.parquet.VectorizedParquetRecordReader.nextKeyValue(VectorizedParquetRecordReader.java:233)
	at org.apache.spark.sql.execution.datasources.RecordReaderIterator.hasNext(RecordReaderIterator.scala:39)
	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.hasNext(FileScanRDD.scala:129)
	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.nextIterator(FileScanRDD.scala:283)
	... 23 more

2024-12-19 12:53:43,876 - __main__ - INFO - Trying to read as parquet format...
2024-12-19 12:53:43,876 - __main__ - ERROR - Error in load_data: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2024-12-19 12:53:44,390 - __main__ - ERROR - Error in model training: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2024-12-19 12:53:44,390 - __main__ - ERROR - Error in main: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2024-12-19 12:53:44,447 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:54:20,567 - __main__ - INFO - Starting enhanced model training process...
2024-12-19 12:54:27,982 - __main__ - INFO - Successfully loaded tables:
2024-12-19 12:54:27,982 - __main__ - INFO - Revenue: (8, 6)
2024-12-19 12:54:27,983 - __main__ - INFO - Discount: (8, 7)
2024-12-19 12:54:27,983 - __main__ - INFO - Price Correlation: (8, 6)
2024-12-19 12:54:27,983 - __main__ - INFO - Reviews: (8, 7)
2024-12-19 12:54:27,983 - __main__ - INFO - Found categories: ['BLANKETS', 'CLOTHING', 'ELECTRONICS', 'HOME & KITCHEN', 'MOBILE PHONE ACCESSORIES', 'MOTOR VEHICLE PARTS', 'NAIL CARE', 'UNDERWEAR']
2024-12-19 12:54:27,990 - __main__ - INFO - Final merged dataset shape: (8, 23)
2024-12-19 12:54:27,990 - __main__ - INFO - Available columns: ['Category', 'TotalRevenue', 'TotalSales', 'AveragePrice', 'ProductCount', 'AvgDiscountPercentage', 'AvgDiscountPercentage_disc', 'TotalDiscountedRevenue', 'PotentialRevenue', 'AvgSales', 'RevenueLossFromDiscount', 'DiscountROI', 'PriceRatingCorrelation', 'AvgPrice', 'AvgRating', 'AvgReviews', 'PriceRatingRelationship', 'TotalReviews', 'TotalSales_review', 'AvgRating_review', 'HighRatingCount', 'ReviewToSalesRatio', 'CustomerEngagementLevel']
2024-12-19 12:54:28,170 - __main__ - INFO - Created advanced features. Shape: (8, 44)
2024-12-19 12:54:28,170 - __main__ - INFO - Number of numeric features: 23
2024-12-19 12:54:28,170 - __main__ - INFO - Number of categorical features: 3
2024-12-19 12:54:28,174 - __main__ - INFO - Training stacked model...
2024-12-19 12:54:28,215 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:54:28,228 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:54:28,233 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:54:28,240 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:54:28,246 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:54:28,253 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:54:28,260 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:54:28,267 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:54:28,276 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:54:28,283 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:54:28,290 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:54:28,300 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:54:28,308 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:54:28,326 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:54:28,352 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:54:28,373 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:54:28,390 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:54:28,601 - py4j.clientserver - INFO - Error while sending or receiving.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer
2024-12-19 12:54:28,602 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:54:28,603 - root - INFO - Exception while sending command.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 506, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending
2024-12-19 12:54:28,621 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:54:35,161 - __main__ - INFO - Model Performance:
2024-12-19 12:54:35,161 - __main__ - INFO - RÂ² score: -2.2568
2024-12-19 12:54:35,162 - __main__ - INFO - MSE: 211770.3001
2024-12-19 12:54:35,162 - __main__ - INFO - RMSE: 460.1851
2024-12-19 12:54:35,162 - __main__ - INFO - MAE: 426.0124
2024-12-19 12:54:35,165 - __main__ - WARNING - Feature importance length mismatch: 3 vs 36
2024-12-19 12:54:35,168 - __main__ - INFO - 
Top 10 Most Important Features:
2024-12-19 12:54:35,168 - __main__ - INFO -                  feature  importance  importance_percentage
0           AveragePrice    0.992132              99.213177
1  AvgDiscountPercentage    0.005227               0.522700
2              AvgRating    0.002641               0.264123
2024-12-19 12:54:35,411 - __main__ - INFO - Model saved to /home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/src/models/training/trained_models/sales_predictor.joblib
2024-12-19 12:54:35,830 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:54:48,897 - __main__ - INFO - Starting enhanced model training process...
2024-12-19 12:54:58,153 - __main__ - INFO - Successfully loaded tables:
2024-12-19 12:54:58,154 - __main__ - INFO - Revenue: (10, 6)
2024-12-19 12:54:58,154 - __main__ - INFO - Discount: (10, 7)
2024-12-19 12:54:58,154 - __main__ - INFO - Price Correlation: (10, 6)
2024-12-19 12:54:58,154 - __main__ - INFO - Reviews: (10, 7)
2024-12-19 12:54:58,154 - __main__ - INFO - Found categories: ['BLANKETS', 'BOOKS', 'CLOTHING', 'ELECTRONICS', 'HOME & KITCHEN', 'MOBILE PHONE ACCESSORIES', 'MOTOR VEHICLE PARTS', 'NAIL CARE', 'TOYS & GAMES', 'UNDERWEAR']
2024-12-19 12:54:58,162 - __main__ - INFO - Final merged dataset shape: (10, 23)
2024-12-19 12:54:58,162 - __main__ - INFO - Available columns: ['Category', 'TotalRevenue', 'TotalSales', 'AveragePrice', 'ProductCount', 'AvgDiscountPercentage', 'AvgDiscountPercentage_disc', 'TotalDiscountedRevenue', 'PotentialRevenue', 'AvgSales', 'RevenueLossFromDiscount', 'DiscountROI', 'PriceRatingCorrelation', 'AvgPrice', 'AvgRating', 'AvgReviews', 'PriceRatingRelationship', 'TotalReviews', 'TotalSales_review', 'AvgRating_review', 'HighRatingCount', 'ReviewToSalesRatio', 'CustomerEngagementLevel']
2024-12-19 12:54:58,617 - __main__ - INFO - Created advanced features. Shape: (10, 44)
2024-12-19 12:54:58,618 - __main__ - INFO - Number of numeric features: 23
2024-12-19 12:54:58,618 - __main__ - INFO - Number of categorical features: 3
2024-12-19 12:54:58,624 - __main__ - INFO - Training stacked model...
2024-12-19 12:54:58,685 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:54:58,706 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:54:58,722 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:54:58,724 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:54:58,731 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:54:58,740 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:54:58,748 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:54:58,764 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:54:58,771 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:54:58,773 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:54:58,802 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:54:58,804 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:54:58,811 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:54:58,820 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:54:58,823 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:54:58,861 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:54:58,883 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:54:59,677 - py4j.clientserver - INFO - Error while sending or receiving.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer
2024-12-19 12:54:59,678 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:54:59,679 - root - INFO - Exception while sending command.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 506, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending
2024-12-19 12:54:59,683 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:55:01,529 - __main__ - INFO - Model Performance:
2024-12-19 12:55:01,529 - __main__ - INFO - RÂ² score: -6.5263
2024-12-19 12:55:01,529 - __main__ - INFO - MSE: 611321.8769
2024-12-19 12:55:01,529 - __main__ - INFO - RMSE: 781.8708
2024-12-19 12:55:01,529 - __main__ - INFO - MAE: 663.6911
2024-12-19 12:55:01,530 - __main__ - WARNING - Feature importance length mismatch: 3 vs 38
2024-12-19 12:55:01,531 - __main__ - INFO - 
Top 10 Most Important Features:
2024-12-19 12:55:01,532 - __main__ - INFO -                  feature  importance  importance_percentage
0           AveragePrice    0.876891              87.689075
2              AvgRating    0.101835              10.183456
1  AvgDiscountPercentage    0.021275               2.127469
2024-12-19 12:55:01,658 - __main__ - INFO - Model saved to /home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/src/models/training/trained_models/sales_predictor.joblib
2024-12-19 12:55:02,094 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:55:09,973 - __main__ - INFO - Starting enhanced model training process...
2024-12-19 12:55:20,538 - __main__ - INFO - Successfully loaded tables:
2024-12-19 12:55:20,539 - __main__ - INFO - Revenue: (10, 6)
2024-12-19 12:55:20,539 - __main__ - INFO - Discount: (10, 7)
2024-12-19 12:55:20,539 - __main__ - INFO - Price Correlation: (10, 6)
2024-12-19 12:55:20,539 - __main__ - INFO - Reviews: (10, 7)
2024-12-19 12:55:20,539 - __main__ - INFO - Found categories: ['BLANKETS', 'BOOKS', 'CLOTHING', 'ELECTRONICS', 'HOME & KITCHEN', 'MOBILE PHONE ACCESSORIES', 'MOTOR VEHICLE PARTS', 'NAIL CARE', 'TOYS & GAMES', 'UNDERWEAR']
2024-12-19 12:55:20,547 - __main__ - INFO - Final merged dataset shape: (10, 23)
2024-12-19 12:55:20,547 - __main__ - INFO - Available columns: ['Category', 'TotalRevenue', 'TotalSales', 'AveragePrice', 'ProductCount', 'AvgDiscountPercentage', 'AvgDiscountPercentage_disc', 'TotalDiscountedRevenue', 'PotentialRevenue', 'AvgSales', 'RevenueLossFromDiscount', 'DiscountROI', 'PriceRatingCorrelation', 'AvgPrice', 'AvgRating', 'AvgReviews', 'PriceRatingRelationship', 'TotalReviews', 'TotalSales_review', 'AvgRating_review', 'HighRatingCount', 'ReviewToSalesRatio', 'CustomerEngagementLevel']
2024-12-19 12:55:21,028 - __main__ - INFO - Created advanced features. Shape: (10, 44)
2024-12-19 12:55:21,028 - __main__ - INFO - Number of numeric features: 23
2024-12-19 12:55:21,028 - __main__ - INFO - Number of categorical features: 3
2024-12-19 12:55:21,032 - __main__ - INFO - Training stacked model...
2024-12-19 12:55:21,093 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:55:21,099 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:55:21,106 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:55:21,113 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:55:21,120 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:55:21,127 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:55:21,133 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:55:21,140 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:55:21,148 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:55:21,155 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:55:21,176 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:55:21,180 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:55:21,185 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:55:21,190 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:55:21,217 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:55:21,247 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:55:23,086 - py4j.clientserver - INFO - Error while sending or receiving.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer
2024-12-19 12:55:23,088 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:55:23,089 - root - INFO - Exception while sending command.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 506, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending
2024-12-19 12:55:23,093 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:55:25,946 - __main__ - INFO - Model Performance:
2024-12-19 12:55:25,947 - __main__ - INFO - RÂ² score: -6.5263
2024-12-19 12:55:25,947 - __main__ - INFO - MSE: 611321.8769
2024-12-19 12:55:25,947 - __main__ - INFO - RMSE: 781.8708
2024-12-19 12:55:25,947 - __main__ - INFO - MAE: 663.6911
2024-12-19 12:55:25,947 - __main__ - WARNING - Feature importance length mismatch: 3 vs 38
2024-12-19 12:55:25,948 - __main__ - INFO - 
Top 10 Most Important Features:
2024-12-19 12:55:25,949 - __main__ - INFO -                  feature  importance  importance_percentage
0           AveragePrice    0.876891              87.689075
2              AvgRating    0.101835              10.183456
1  AvgDiscountPercentage    0.021275               2.127469
2024-12-19 12:55:26,084 - __main__ - INFO - Model saved to /home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/src/models/training/trained_models/sales_predictor.joblib
2024-12-19 12:55:26,469 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:55:58,947 - __main__ - INFO - Starting enhanced model training process...
2024-12-19 12:56:06,445 - __main__ - INFO - Successfully loaded tables:
2024-12-19 12:56:06,445 - __main__ - INFO - Revenue: (13, 6)
2024-12-19 12:56:06,445 - __main__ - INFO - Discount: (13, 7)
2024-12-19 12:56:06,445 - __main__ - INFO - Price Correlation: (13, 6)
2024-12-19 12:56:06,445 - __main__ - INFO - Reviews: (13, 7)
2024-12-19 12:56:06,445 - __main__ - INFO - Found categories: ['BLANKETS', 'BOOKS', 'CLOTHING', 'ELECTRONICS', 'HOME & KITCHEN', 'MAKEUP', 'MOBILE PHONE ACCESSORIES', 'MOTOR VEHICLE PARTS', 'NAIL CARE', 'SKIN CARE', 'TOYS & GAMES', 'UNDERWEAR', 'VITAMINS AND SUPPLEMENTS']
2024-12-19 12:56:06,450 - __main__ - INFO - Final merged dataset shape: (13, 23)
2024-12-19 12:56:06,451 - __main__ - INFO - Available columns: ['Category', 'TotalRevenue', 'TotalSales', 'AveragePrice', 'ProductCount', 'AvgDiscountPercentage', 'AvgDiscountPercentage_disc', 'TotalDiscountedRevenue', 'PotentialRevenue', 'AvgSales', 'RevenueLossFromDiscount', 'DiscountROI', 'PriceRatingCorrelation', 'AvgPrice', 'AvgRating', 'AvgReviews', 'PriceRatingRelationship', 'TotalReviews', 'TotalSales_review', 'AvgRating_review', 'HighRatingCount', 'ReviewToSalesRatio', 'CustomerEngagementLevel']
2024-12-19 12:56:06,595 - __main__ - INFO - Created advanced features. Shape: (13, 44)
2024-12-19 12:56:06,596 - __main__ - INFO - Number of numeric features: 23
2024-12-19 12:56:06,596 - __main__ - INFO - Number of categorical features: 3
2024-12-19 12:56:06,598 - __main__ - INFO - Training stacked model...
2024-12-19 12:56:06,624 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:56:06,634 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:56:06,639 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:56:06,643 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:56:06,647 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:56:06,653 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:56:06,658 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:56:06,663 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:56:06,669 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:56:06,676 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:56:06,683 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:56:06,690 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:56:06,697 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:56:06,709 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:56:06,707 - py4j.clientserver - INFO - Error while sending or receiving.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer
2024-12-19 12:56:06,710 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:56:06,711 - root - INFO - Exception while sending command.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 506, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending
2024-12-19 12:56:06,729 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:56:06,761 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:56:07,732 - py4j.clientserver - INFO - Error while sending or receiving.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer
2024-12-19 12:56:07,733 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:56:07,733 - root - INFO - Exception while sending command.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 506, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending
2024-12-19 12:56:07,736 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:56:09,796 - __main__ - INFO - Model Performance:
2024-12-19 12:56:09,796 - __main__ - INFO - RÂ² score: -382.1244
2024-12-19 12:56:09,796 - __main__ - INFO - MSE: 7083544.9982
2024-12-19 12:56:09,796 - __main__ - INFO - RMSE: 2661.4930
2024-12-19 12:56:09,796 - __main__ - INFO - MAE: 2061.1841
2024-12-19 12:56:09,797 - __main__ - WARNING - Feature importance length mismatch: 3 vs 41
2024-12-19 12:56:09,798 - __main__ - INFO - 
Top 10 Most Important Features:
2024-12-19 12:56:09,798 - __main__ - INFO -                  feature  importance  importance_percentage
0           AveragePrice    0.569925              56.992526
2              AvgRating    0.397162              39.716232
1  AvgDiscountPercentage    0.032912               3.291242
2024-12-19 12:56:09,909 - __main__ - INFO - Model saved to /home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/src/models/training/trained_models/sales_predictor.joblib
2024-12-19 12:56:10,218 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:56:32,747 - __main__ - INFO - Starting enhanced model training process...
2024-12-19 12:56:52,737 - __main__ - INFO - Successfully loaded tables:
2024-12-19 12:56:52,737 - __main__ - INFO - Revenue: (13, 6)
2024-12-19 12:56:52,738 - __main__ - INFO - Discount: (13, 7)
2024-12-19 12:56:52,738 - __main__ - INFO - Price Correlation: (13, 6)
2024-12-19 12:56:52,738 - __main__ - INFO - Reviews: (13, 7)
2024-12-19 12:56:52,738 - __main__ - INFO - Found categories: ['BLANKETS', 'BOOKS', 'CLOTHING', 'ELECTRONICS', 'HOME & KITCHEN', 'MAKEUP', 'MOBILE PHONE ACCESSORIES', 'MOTOR VEHICLE PARTS', 'NAIL CARE', 'SKIN CARE', 'TOYS & GAMES', 'UNDERWEAR', 'VITAMINS AND SUPPLEMENTS']
2024-12-19 12:56:52,743 - __main__ - INFO - Final merged dataset shape: (13, 23)
2024-12-19 12:56:52,743 - __main__ - INFO - Available columns: ['Category', 'TotalRevenue', 'TotalSales', 'AveragePrice', 'ProductCount', 'AvgDiscountPercentage', 'AvgDiscountPercentage_disc', 'TotalDiscountedRevenue', 'PotentialRevenue', 'AvgSales', 'RevenueLossFromDiscount', 'DiscountROI', 'PriceRatingCorrelation', 'AvgPrice', 'AvgRating', 'AvgReviews', 'PriceRatingRelationship', 'TotalReviews', 'TotalSales_review', 'AvgRating_review', 'HighRatingCount', 'ReviewToSalesRatio', 'CustomerEngagementLevel']
2024-12-19 12:56:53,148 - __main__ - INFO - Created advanced features. Shape: (13, 44)
2024-12-19 12:56:53,148 - __main__ - INFO - Number of numeric features: 23
2024-12-19 12:56:53,148 - __main__ - INFO - Number of categorical features: 3
2024-12-19 12:56:53,150 - __main__ - INFO - Training stacked model...
2024-12-19 12:56:53,196 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:56:53,201 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:56:53,205 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:56:53,210 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:56:53,215 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:56:53,221 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:56:53,227 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:56:53,234 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:56:53,241 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:56:53,259 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:56:53,271 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:56:53,272 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:56:53,293 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:56:53,300 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:56:53,319 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:56:53,329 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:56:54,193 - py4j.clientserver - INFO - Error while sending or receiving.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer
2024-12-19 12:56:54,194 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:56:54,194 - root - INFO - Exception while sending command.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 506, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending
2024-12-19 12:56:54,196 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:56:55,560 - __main__ - INFO - Model Performance:
2024-12-19 12:56:55,560 - __main__ - INFO - RÂ² score: -382.1244
2024-12-19 12:56:55,560 - __main__ - INFO - MSE: 7083544.9982
2024-12-19 12:56:55,560 - __main__ - INFO - RMSE: 2661.4930
2024-12-19 12:56:55,560 - __main__ - INFO - MAE: 2061.1841
2024-12-19 12:56:55,561 - __main__ - WARNING - Feature importance length mismatch: 3 vs 41
2024-12-19 12:56:55,562 - __main__ - INFO - 
Top 10 Most Important Features:
2024-12-19 12:56:55,562 - __main__ - INFO -                  feature  importance  importance_percentage
0           AveragePrice    0.569925              56.992526
2              AvgRating    0.397162              39.716232
1  AvgDiscountPercentage    0.032912               3.291242
2024-12-19 12:56:55,678 - __main__ - INFO - Model saved to /home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/src/models/training/trained_models/sales_predictor.joblib
2024-12-19 12:56:58,997 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:57:40,706 - __main__ - INFO - Starting enhanced model training process...
2024-12-19 12:57:40,717 - __main__ - INFO - Starting enhanced model training process...
2024-12-19 12:57:52,715 - __main__ - INFO - Successfully loaded tables:
2024-12-19 12:57:52,715 - __main__ - INFO - Revenue: (13, 6)
2024-12-19 12:57:52,715 - __main__ - INFO - Discount: (13, 7)
2024-12-19 12:57:52,716 - __main__ - INFO - Price Correlation: (13, 6)
2024-12-19 12:57:52,716 - __main__ - INFO - Reviews: (13, 7)
2024-12-19 12:57:52,716 - __main__ - INFO - Found categories: ['BLANKETS', 'BOOKS', 'CLOTHING', 'ELECTRONICS', 'HOME & KITCHEN', 'MAKEUP', 'MOBILE PHONE ACCESSORIES', 'MOTOR VEHICLE PARTS', 'NAIL CARE', 'SKIN CARE', 'TOYS & GAMES', 'UNDERWEAR', 'VITAMINS AND SUPPLEMENTS']
2024-12-19 12:57:52,728 - __main__ - INFO - Final merged dataset shape: (13, 23)
2024-12-19 12:57:52,728 - __main__ - INFO - Available columns: ['Category', 'TotalRevenue', 'TotalSales', 'AveragePrice', 'ProductCount', 'AvgDiscountPercentage', 'AvgDiscountPercentage_disc', 'TotalDiscountedRevenue', 'PotentialRevenue', 'AvgSales', 'RevenueLossFromDiscount', 'DiscountROI', 'PriceRatingCorrelation', 'AvgPrice', 'AvgRating', 'AvgReviews', 'PriceRatingRelationship', 'TotalReviews', 'TotalSales_review', 'AvgRating_review', 'HighRatingCount', 'ReviewToSalesRatio', 'CustomerEngagementLevel']
2024-12-19 12:57:52,871 - __main__ - INFO - Successfully loaded tables:
2024-12-19 12:57:52,871 - __main__ - INFO - Revenue: (13, 6)
2024-12-19 12:57:52,871 - __main__ - INFO - Discount: (13, 7)
2024-12-19 12:57:52,871 - __main__ - INFO - Price Correlation: (13, 6)
2024-12-19 12:57:52,872 - __main__ - INFO - Reviews: (13, 7)
2024-12-19 12:57:52,872 - __main__ - INFO - Found categories: ['BLANKETS', 'BOOKS', 'CLOTHING', 'ELECTRONICS', 'HOME & KITCHEN', 'MAKEUP', 'MOBILE PHONE ACCESSORIES', 'MOTOR VEHICLE PARTS', 'NAIL CARE', 'SKIN CARE', 'TOYS & GAMES', 'UNDERWEAR', 'VITAMINS AND SUPPLEMENTS']
2024-12-19 12:57:52,880 - __main__ - INFO - Final merged dataset shape: (13, 23)
2024-12-19 12:57:52,880 - __main__ - INFO - Available columns: ['Category', 'TotalRevenue', 'TotalSales', 'AveragePrice', 'ProductCount', 'AvgDiscountPercentage', 'AvgDiscountPercentage_disc', 'TotalDiscountedRevenue', 'PotentialRevenue', 'AvgSales', 'RevenueLossFromDiscount', 'DiscountROI', 'PriceRatingCorrelation', 'AvgPrice', 'AvgRating', 'AvgReviews', 'PriceRatingRelationship', 'TotalReviews', 'TotalSales_review', 'AvgRating_review', 'HighRatingCount', 'ReviewToSalesRatio', 'CustomerEngagementLevel']
2024-12-19 12:57:52,904 - __main__ - INFO - Created advanced features. Shape: (13, 44)
2024-12-19 12:57:52,904 - __main__ - INFO - Number of numeric features: 23
2024-12-19 12:57:52,905 - __main__ - INFO - Number of categorical features: 3
2024-12-19 12:57:52,909 - __main__ - INFO - Training stacked model...
2024-12-19 12:57:53,000 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:57:53,017 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:57:53,029 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:57:53,036 - __main__ - INFO - Created advanced features. Shape: (13, 44)
2024-12-19 12:57:53,037 - __main__ - INFO - Number of numeric features: 23
2024-12-19 12:57:53,037 - __main__ - INFO - Number of categorical features: 3
2024-12-19 12:57:53,037 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:57:53,048 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:57:53,052 - __main__ - INFO - Training stacked model...
2024-12-19 12:57:53,061 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:57:53,081 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:57:53,103 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:57:53,103 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:57:53,122 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:57:53,136 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:57:53,162 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:57:53,163 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:57:53,164 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:57:53,173 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:57:53,181 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:57:53,191 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:57:53,252 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:57:53,312 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:57:53,354 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:57:53,355 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:57:53,362 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:57:53,362 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:57:53,401 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:57:53,402 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:57:53,403 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:57:53,448 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:57:53,472 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:57:53,502 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:57:53,501 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:57:53,585 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:57:53,612 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:57:53,661 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:57:56,012 - py4j.clientserver - INFO - Error while sending or receiving.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer
2024-12-19 12:57:56,015 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:57:56,015 - root - INFO - Exception while sending command.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 506, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending
2024-12-19 12:57:56,033 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:57:56,033 - py4j.clientserver - INFO - Error while sending or receiving.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer
2024-12-19 12:57:56,035 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:57:56,036 - root - INFO - Exception while sending command.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 506, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending
2024-12-19 12:57:56,057 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:57:59,339 - __main__ - INFO - Model Performance:
2024-12-19 12:57:59,346 - __main__ - INFO - RÂ² score: -382.1244
2024-12-19 12:57:59,346 - __main__ - INFO - MSE: 7083544.9982
2024-12-19 12:57:59,346 - __main__ - INFO - RMSE: 2661.4930
2024-12-19 12:57:59,346 - __main__ - INFO - MAE: 2061.1841
2024-12-19 12:57:59,350 - __main__ - WARNING - Feature importance length mismatch: 3 vs 41
2024-12-19 12:57:59,357 - __main__ - INFO - 
Top 10 Most Important Features:
2024-12-19 12:57:59,358 - __main__ - INFO -                  feature  importance  importance_percentage
0           AveragePrice    0.569925              56.992526
2              AvgRating    0.397162              39.716232
1  AvgDiscountPercentage    0.032912               3.291242
2024-12-19 12:57:59,816 - __main__ - INFO - Model saved to /home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/src/models/training/trained_models/sales_predictor.joblib
2024-12-19 12:57:59,913 - __main__ - INFO - Model Performance:
2024-12-19 12:57:59,915 - __main__ - INFO - RÂ² score: -382.1244
2024-12-19 12:57:59,915 - __main__ - INFO - MSE: 7083544.9982
2024-12-19 12:57:59,915 - __main__ - INFO - RMSE: 2661.4930
2024-12-19 12:57:59,915 - __main__ - INFO - MAE: 2061.1841
2024-12-19 12:57:59,921 - __main__ - WARNING - Feature importance length mismatch: 3 vs 41
2024-12-19 12:58:00,000 - __main__ - INFO - 
Top 10 Most Important Features:
2024-12-19 12:58:00,000 - __main__ - INFO -                  feature  importance  importance_percentage
0           AveragePrice    0.569925              56.992526
2              AvgRating    0.397162              39.716232
1  AvgDiscountPercentage    0.032912               3.291242
2024-12-19 12:58:00,367 - __main__ - INFO - Model saved to /home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/src/models/training/trained_models/sales_predictor.joblib
2024-12-19 12:58:00,576 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:58:00,892 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:58:53,564 - __main__ - INFO - Starting enhanced model training process...
2024-12-19 12:59:07,002 - __main__ - INFO - Successfully loaded tables:
2024-12-19 12:59:07,002 - __main__ - INFO - Revenue: (13, 6)
2024-12-19 12:59:07,002 - __main__ - INFO - Discount: (13, 7)
2024-12-19 12:59:07,002 - __main__ - INFO - Price Correlation: (13, 6)
2024-12-19 12:59:07,002 - __main__ - INFO - Reviews: (13, 7)
2024-12-19 12:59:07,005 - __main__ - INFO - Found categories: ['BLANKETS', 'BOOKS', 'CLOTHING', 'ELECTRONICS', 'HOME & KITCHEN', 'MAKEUP', 'MOBILE PHONE ACCESSORIES', 'MOTOR VEHICLE PARTS', 'NAIL CARE', 'SKIN CARE', 'TOYS & GAMES', 'UNDERWEAR', 'VITAMINS AND SUPPLEMENTS']
2024-12-19 12:59:07,016 - __main__ - INFO - Final merged dataset shape: (13, 23)
2024-12-19 12:59:07,017 - __main__ - INFO - Available columns: ['Category', 'TotalRevenue', 'TotalSales', 'AveragePrice', 'ProductCount', 'AvgDiscountPercentage', 'AvgDiscountPercentage_disc', 'TotalDiscountedRevenue', 'PotentialRevenue', 'AvgSales', 'RevenueLossFromDiscount', 'DiscountROI', 'PriceRatingCorrelation', 'AvgPrice', 'AvgRating', 'AvgReviews', 'PriceRatingRelationship', 'TotalReviews', 'TotalSales_review', 'AvgRating_review', 'HighRatingCount', 'ReviewToSalesRatio', 'CustomerEngagementLevel']
2024-12-19 12:59:07,582 - __main__ - INFO - Created advanced features. Shape: (13, 44)
2024-12-19 12:59:07,582 - __main__ - INFO - Number of numeric features: 23
2024-12-19 12:59:07,582 - __main__ - INFO - Number of categorical features: 3
2024-12-19 12:59:07,585 - __main__ - INFO - Training stacked model...
2024-12-19 12:59:07,620 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:59:07,633 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:59:07,638 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:59:07,643 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:59:07,650 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:59:07,657 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:59:07,662 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:59:07,668 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:59:07,675 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:59:07,683 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:59:07,690 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:59:07,715 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:59:07,715 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:59:07,718 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:59:07,741 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:59:07,747 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:59:07,764 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:59:07,964 - py4j.clientserver - INFO - Error while sending or receiving.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer
2024-12-19 12:59:07,967 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:59:07,967 - root - INFO - Exception while sending command.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 506, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending
2024-12-19 12:59:07,979 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:59:10,385 - __main__ - INFO - Model Performance:
2024-12-19 12:59:10,385 - __main__ - INFO - RÂ² score: -382.1244
2024-12-19 12:59:10,385 - __main__ - INFO - MSE: 7083544.9982
2024-12-19 12:59:10,385 - __main__ - INFO - RMSE: 2661.4930
2024-12-19 12:59:10,385 - __main__ - INFO - MAE: 2061.1841
2024-12-19 12:59:10,386 - __main__ - WARNING - Feature importance length mismatch: 3 vs 41
2024-12-19 12:59:10,388 - __main__ - INFO - 
Top 10 Most Important Features:
2024-12-19 12:59:10,388 - __main__ - INFO -                  feature  importance  importance_percentage
0           AveragePrice    0.569925              56.992526
2              AvgRating    0.397162              39.716232
1  AvgDiscountPercentage    0.032912               3.291242
2024-12-19 12:59:10,508 - __main__ - INFO - Model saved to /home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/src/models/training/trained_models/sales_predictor.joblib
2024-12-19 12:59:10,866 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:59:24,085 - __main__ - INFO - Starting enhanced model training process...
2024-12-19 12:59:36,093 - __main__ - INFO - Successfully loaded tables:
2024-12-19 12:59:36,093 - __main__ - INFO - Revenue: (13, 6)
2024-12-19 12:59:36,093 - __main__ - INFO - Discount: (13, 7)
2024-12-19 12:59:36,094 - __main__ - INFO - Price Correlation: (13, 6)
2024-12-19 12:59:36,094 - __main__ - INFO - Reviews: (13, 7)
2024-12-19 12:59:36,094 - __main__ - INFO - Found categories: ['BLANKETS', 'BOOKS', 'CLOTHING', 'ELECTRONICS', 'HOME & KITCHEN', 'MAKEUP', 'MOBILE PHONE ACCESSORIES', 'MOTOR VEHICLE PARTS', 'NAIL CARE', 'SKIN CARE', 'TOYS & GAMES', 'UNDERWEAR', 'VITAMINS AND SUPPLEMENTS']
2024-12-19 12:59:36,106 - __main__ - INFO - Final merged dataset shape: (13, 23)
2024-12-19 12:59:36,106 - __main__ - INFO - Available columns: ['Category', 'TotalRevenue', 'TotalSales', 'AveragePrice', 'ProductCount', 'AvgDiscountPercentage', 'AvgDiscountPercentage_disc', 'TotalDiscountedRevenue', 'PotentialRevenue', 'AvgSales', 'RevenueLossFromDiscount', 'DiscountROI', 'PriceRatingCorrelation', 'AvgPrice', 'AvgRating', 'AvgReviews', 'PriceRatingRelationship', 'TotalReviews', 'TotalSales_review', 'AvgRating_review', 'HighRatingCount', 'ReviewToSalesRatio', 'CustomerEngagementLevel']
2024-12-19 12:59:36,461 - __main__ - INFO - Created advanced features. Shape: (13, 44)
2024-12-19 12:59:36,461 - __main__ - INFO - Number of numeric features: 23
2024-12-19 12:59:36,461 - __main__ - INFO - Number of categorical features: 3
2024-12-19 12:59:36,464 - __main__ - INFO - Training stacked model...
2024-12-19 12:59:36,501 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:59:36,512 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:59:36,518 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:59:36,524 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:59:36,530 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:59:36,537 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:59:36,543 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:59:36,552 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:59:36,562 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:59:36,568 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:59:36,581 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:59:36,609 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:59:36,630 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:59:36,639 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:59:36,641 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:59:36,644 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:59:36,671 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:59:38,232 - py4j.clientserver - INFO - Error while sending or receiving.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer
2024-12-19 12:59:38,233 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:59:38,233 - root - INFO - Exception while sending command.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 506, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending
2024-12-19 12:59:38,236 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 12:59:39,457 - __main__ - INFO - Model Performance:
2024-12-19 12:59:39,458 - __main__ - INFO - RÂ² score: -382.1244
2024-12-19 12:59:39,458 - __main__ - INFO - MSE: 7083544.9982
2024-12-19 12:59:39,458 - __main__ - INFO - RMSE: 2661.4930
2024-12-19 12:59:39,458 - __main__ - INFO - MAE: 2061.1841
2024-12-19 12:59:39,461 - __main__ - WARNING - Feature importance length mismatch: 3 vs 41
2024-12-19 12:59:39,464 - __main__ - INFO - 
Top 10 Most Important Features:
2024-12-19 12:59:39,464 - __main__ - INFO -                  feature  importance  importance_percentage
0           AveragePrice    0.569925              56.992526
2              AvgRating    0.397162              39.716232
1  AvgDiscountPercentage    0.032912               3.291242
2024-12-19 12:59:39,652 - __main__ - INFO - Model saved to /home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/src/models/training/trained_models/sales_predictor.joblib
2024-12-19 12:59:40,043 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:00:04,087 - __main__ - INFO - Starting enhanced model training process...
2024-12-19 13:00:13,689 - __main__ - INFO - Successfully loaded tables:
2024-12-19 13:00:13,690 - __main__ - INFO - Revenue: (13, 6)
2024-12-19 13:00:13,690 - __main__ - INFO - Discount: (13, 7)
2024-12-19 13:00:13,690 - __main__ - INFO - Price Correlation: (13, 6)
2024-12-19 13:00:13,690 - __main__ - INFO - Reviews: (13, 7)
2024-12-19 13:00:13,690 - __main__ - INFO - Found categories: ['BLANKETS', 'BOOKS', 'CLOTHING', 'ELECTRONICS', 'HOME & KITCHEN', 'MAKEUP', 'MOBILE PHONE ACCESSORIES', 'MOTOR VEHICLE PARTS', 'NAIL CARE', 'SKIN CARE', 'TOYS & GAMES', 'UNDERWEAR', 'VITAMINS AND SUPPLEMENTS']
2024-12-19 13:00:13,695 - __main__ - INFO - Final merged dataset shape: (13, 23)
2024-12-19 13:00:13,695 - __main__ - INFO - Available columns: ['Category', 'TotalRevenue', 'TotalSales', 'AveragePrice', 'ProductCount', 'AvgDiscountPercentage', 'AvgDiscountPercentage_disc', 'TotalDiscountedRevenue', 'PotentialRevenue', 'AvgSales', 'RevenueLossFromDiscount', 'DiscountROI', 'PriceRatingCorrelation', 'AvgPrice', 'AvgRating', 'AvgReviews', 'PriceRatingRelationship', 'TotalReviews', 'TotalSales_review', 'AvgRating_review', 'HighRatingCount', 'ReviewToSalesRatio', 'CustomerEngagementLevel']
2024-12-19 13:00:13,952 - __main__ - INFO - Created advanced features. Shape: (13, 44)
2024-12-19 13:00:13,952 - __main__ - INFO - Number of numeric features: 23
2024-12-19 13:00:13,952 - __main__ - INFO - Number of categorical features: 3
2024-12-19 13:00:13,954 - __main__ - INFO - Training stacked model...
2024-12-19 13:00:13,986 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:00:14,000 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:00:14,009 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:00:14,033 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:00:14,035 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:00:14,047 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:00:14,052 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:00:14,059 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:00:14,065 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:00:14,074 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:00:14,084 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:00:14,092 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:00:14,108 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:00:14,118 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:00:14,135 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:00:14,137 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:00:14,142 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:00:15,738 - py4j.clientserver - INFO - Error while sending or receiving.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer
2024-12-19 13:00:15,740 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:00:15,740 - root - INFO - Exception while sending command.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 506, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending
2024-12-19 13:00:15,747 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:00:17,466 - __main__ - INFO - Model Performance:
2024-12-19 13:00:17,466 - __main__ - INFO - RÂ² score: -382.1244
2024-12-19 13:00:17,466 - __main__ - INFO - MSE: 7083544.9982
2024-12-19 13:00:17,466 - __main__ - INFO - RMSE: 2661.4930
2024-12-19 13:00:17,467 - __main__ - INFO - MAE: 2061.1841
2024-12-19 13:00:17,467 - __main__ - WARNING - Feature importance length mismatch: 3 vs 41
2024-12-19 13:00:17,468 - __main__ - INFO - 
Top 10 Most Important Features:
2024-12-19 13:00:17,468 - __main__ - INFO -                  feature  importance  importance_percentage
0           AveragePrice    0.569925              56.992526
2              AvgRating    0.397162              39.716232
1  AvgDiscountPercentage    0.032912               3.291242
2024-12-19 13:00:17,584 - __main__ - INFO - Model saved to /home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/src/models/training/trained_models/sales_predictor.joblib
2024-12-19 13:00:17,929 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:00:31,107 - __main__ - INFO - Starting enhanced model training process...
2024-12-19 13:00:45,281 - __main__ - INFO - Successfully loaded tables:
2024-12-19 13:00:45,281 - __main__ - INFO - Revenue: (13, 6)
2024-12-19 13:00:45,281 - __main__ - INFO - Discount: (13, 7)
2024-12-19 13:00:45,281 - __main__ - INFO - Price Correlation: (13, 6)
2024-12-19 13:00:45,281 - __main__ - INFO - Reviews: (13, 7)
2024-12-19 13:00:45,282 - __main__ - INFO - Found categories: ['BLANKETS', 'BOOKS', 'CLOTHING', 'ELECTRONICS', 'HOME & KITCHEN', 'MAKEUP', 'MOBILE PHONE ACCESSORIES', 'MOTOR VEHICLE PARTS', 'NAIL CARE', 'SKIN CARE', 'TOYS & GAMES', 'UNDERWEAR', 'VITAMINS AND SUPPLEMENTS']
2024-12-19 13:00:45,287 - __main__ - INFO - Final merged dataset shape: (13, 23)
2024-12-19 13:00:45,288 - __main__ - INFO - Available columns: ['Category', 'TotalRevenue', 'TotalSales', 'AveragePrice', 'ProductCount', 'AvgDiscountPercentage', 'AvgDiscountPercentage_disc', 'TotalDiscountedRevenue', 'PotentialRevenue', 'AvgSales', 'RevenueLossFromDiscount', 'DiscountROI', 'PriceRatingCorrelation', 'AvgPrice', 'AvgRating', 'AvgReviews', 'PriceRatingRelationship', 'TotalReviews', 'TotalSales_review', 'AvgRating_review', 'HighRatingCount', 'ReviewToSalesRatio', 'CustomerEngagementLevel']
2024-12-19 13:00:45,471 - __main__ - INFO - Created advanced features. Shape: (13, 44)
2024-12-19 13:00:45,472 - __main__ - INFO - Number of numeric features: 23
2024-12-19 13:00:45,472 - __main__ - INFO - Number of categorical features: 3
2024-12-19 13:00:45,475 - __main__ - INFO - Training stacked model...
2024-12-19 13:00:45,519 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:00:45,533 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:00:45,540 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:00:45,546 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:00:45,553 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:00:45,560 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:00:45,565 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:00:45,571 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:00:45,579 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:00:45,584 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:00:45,591 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:00:45,599 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:00:45,607 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:00:45,616 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:00:45,634 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:00:45,637 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:00:45,656 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:00:45,847 - py4j.clientserver - INFO - Error while sending or receiving.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer
2024-12-19 13:00:45,848 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:00:45,849 - root - INFO - Exception while sending command.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 506, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending
2024-12-19 13:00:45,860 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:00:48,303 - __main__ - INFO - Model Performance:
2024-12-19 13:00:48,303 - __main__ - INFO - RÂ² score: -382.1244
2024-12-19 13:00:48,303 - __main__ - INFO - MSE: 7083544.9982
2024-12-19 13:00:48,303 - __main__ - INFO - RMSE: 2661.4930
2024-12-19 13:00:48,303 - __main__ - INFO - MAE: 2061.1841
2024-12-19 13:00:48,304 - __main__ - WARNING - Feature importance length mismatch: 3 vs 41
2024-12-19 13:00:48,305 - __main__ - INFO - 
Top 10 Most Important Features:
2024-12-19 13:00:48,305 - __main__ - INFO -                  feature  importance  importance_percentage
0           AveragePrice    0.569925              56.992526
2              AvgRating    0.397162              39.716232
1  AvgDiscountPercentage    0.032912               3.291242
2024-12-19 13:00:48,426 - __main__ - INFO - Model saved to /home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/src/models/training/trained_models/sales_predictor.joblib
2024-12-19 13:00:48,774 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:01:16,068 - __main__ - INFO - Starting enhanced model training process...
2024-12-19 13:01:26,477 - __main__ - INFO - Successfully loaded tables:
2024-12-19 13:01:26,477 - __main__ - INFO - Revenue: (13, 6)
2024-12-19 13:01:26,477 - __main__ - INFO - Discount: (13, 7)
2024-12-19 13:01:26,477 - __main__ - INFO - Price Correlation: (13, 6)
2024-12-19 13:01:26,477 - __main__ - INFO - Reviews: (13, 7)
2024-12-19 13:01:26,477 - __main__ - INFO - Found categories: ['BLANKETS', 'BOOKS', 'CLOTHING', 'ELECTRONICS', 'HOME & KITCHEN', 'MAKEUP', 'MOBILE PHONE ACCESSORIES', 'MOTOR VEHICLE PARTS', 'NAIL CARE', 'SKIN CARE', 'TOYS & GAMES', 'UNDERWEAR', 'VITAMINS AND SUPPLEMENTS']
2024-12-19 13:01:26,482 - __main__ - INFO - Final merged dataset shape: (13, 23)
2024-12-19 13:01:26,482 - __main__ - INFO - Available columns: ['Category', 'TotalRevenue', 'TotalSales', 'AveragePrice', 'ProductCount', 'AvgDiscountPercentage', 'AvgDiscountPercentage_disc', 'TotalDiscountedRevenue', 'PotentialRevenue', 'AvgSales', 'RevenueLossFromDiscount', 'DiscountROI', 'PriceRatingCorrelation', 'AvgPrice', 'AvgRating', 'AvgReviews', 'PriceRatingRelationship', 'TotalReviews', 'TotalSales_review', 'AvgRating_review', 'HighRatingCount', 'ReviewToSalesRatio', 'CustomerEngagementLevel']
2024-12-19 13:01:26,580 - __main__ - INFO - Created advanced features. Shape: (13, 44)
2024-12-19 13:01:26,581 - __main__ - INFO - Number of numeric features: 23
2024-12-19 13:01:26,581 - __main__ - INFO - Number of categorical features: 3
2024-12-19 13:01:26,583 - __main__ - INFO - Training stacked model...
2024-12-19 13:01:26,613 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:01:26,623 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:01:26,627 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:01:26,631 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:01:26,635 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:01:26,639 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:01:26,644 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:01:26,649 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:01:26,654 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:01:26,660 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:01:26,666 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:01:26,673 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:01:26,681 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:01:26,688 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:01:26,718 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:01:26,736 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:01:26,738 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:01:26,918 - py4j.clientserver - INFO - Error while sending or receiving.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer
2024-12-19 13:01:26,919 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:01:26,920 - root - INFO - Exception while sending command.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 506, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending
2024-12-19 13:01:26,926 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:01:29,053 - __main__ - INFO - Model Performance:
2024-12-19 13:01:29,053 - __main__ - INFO - RÂ² score: -382.1244
2024-12-19 13:01:29,053 - __main__ - INFO - MSE: 7083544.9982
2024-12-19 13:01:29,053 - __main__ - INFO - RMSE: 2661.4930
2024-12-19 13:01:29,053 - __main__ - INFO - MAE: 2061.1841
2024-12-19 13:01:29,054 - __main__ - WARNING - Feature importance length mismatch: 3 vs 41
2024-12-19 13:01:29,055 - __main__ - INFO - 
Top 10 Most Important Features:
2024-12-19 13:01:29,055 - __main__ - INFO -                  feature  importance  importance_percentage
0           AveragePrice    0.569925              56.992526
2              AvgRating    0.397162              39.716232
1  AvgDiscountPercentage    0.032912               3.291242
2024-12-19 13:01:29,164 - __main__ - INFO - Model saved to /home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/src/models/training/trained_models/sales_predictor.joblib
2024-12-19 13:01:29,478 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:01:37,838 - __main__ - INFO - Starting enhanced model training process...
2024-12-19 13:01:47,123 - __main__ - INFO - Successfully loaded tables:
2024-12-19 13:01:47,123 - __main__ - INFO - Revenue: (13, 6)
2024-12-19 13:01:47,123 - __main__ - INFO - Discount: (13, 7)
2024-12-19 13:01:47,123 - __main__ - INFO - Price Correlation: (13, 6)
2024-12-19 13:01:47,123 - __main__ - INFO - Reviews: (13, 7)
2024-12-19 13:01:47,124 - __main__ - INFO - Found categories: ['BLANKETS', 'BOOKS', 'CLOTHING', 'ELECTRONICS', 'HOME & KITCHEN', 'MAKEUP', 'MOBILE PHONE ACCESSORIES', 'MOTOR VEHICLE PARTS', 'NAIL CARE', 'SKIN CARE', 'TOYS & GAMES', 'UNDERWEAR', 'VITAMINS AND SUPPLEMENTS']
2024-12-19 13:01:47,128 - __main__ - INFO - Final merged dataset shape: (13, 23)
2024-12-19 13:01:47,129 - __main__ - INFO - Available columns: ['Category', 'TotalRevenue', 'TotalSales', 'AveragePrice', 'ProductCount', 'AvgDiscountPercentage', 'AvgDiscountPercentage_disc', 'TotalDiscountedRevenue', 'PotentialRevenue', 'AvgSales', 'RevenueLossFromDiscount', 'DiscountROI', 'PriceRatingCorrelation', 'AvgPrice', 'AvgRating', 'AvgReviews', 'PriceRatingRelationship', 'TotalReviews', 'TotalSales_review', 'AvgRating_review', 'HighRatingCount', 'ReviewToSalesRatio', 'CustomerEngagementLevel']
2024-12-19 13:01:47,671 - __main__ - INFO - Created advanced features. Shape: (13, 44)
2024-12-19 13:01:47,671 - __main__ - INFO - Number of numeric features: 23
2024-12-19 13:01:47,671 - __main__ - INFO - Number of categorical features: 3
2024-12-19 13:01:47,674 - __main__ - INFO - Training stacked model...
2024-12-19 13:01:47,747 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:01:47,752 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:01:47,757 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:01:47,763 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:01:47,770 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:01:47,776 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:01:47,783 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:01:47,803 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:01:47,814 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:01:47,826 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:01:47,835 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:01:47,844 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:01:47,860 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:01:48,743 - py4j.clientserver - INFO - Error while sending or receiving.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer
2024-12-19 13:01:48,744 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:01:48,744 - root - INFO - Exception while sending command.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 506, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending
2024-12-19 13:01:48,746 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:01:49,995 - __main__ - INFO - Model Performance:
2024-12-19 13:01:49,995 - __main__ - INFO - RÂ² score: -382.1244
2024-12-19 13:01:49,996 - __main__ - INFO - MSE: 7083544.9982
2024-12-19 13:01:49,996 - __main__ - INFO - RMSE: 2661.4930
2024-12-19 13:01:49,996 - __main__ - INFO - MAE: 2061.1841
2024-12-19 13:01:49,996 - __main__ - WARNING - Feature importance length mismatch: 3 vs 41
2024-12-19 13:01:49,997 - __main__ - INFO - 
Top 10 Most Important Features:
2024-12-19 13:01:49,998 - __main__ - INFO -                  feature  importance  importance_percentage
0           AveragePrice    0.569925              56.992526
2              AvgRating    0.397162              39.716232
1  AvgDiscountPercentage    0.032912               3.291242
2024-12-19 13:01:50,109 - __main__ - INFO - Model saved to /home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/src/models/training/trained_models/sales_predictor.joblib
2024-12-19 13:01:50,411 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:03:22,645 - __main__ - INFO - Starting enhanced model training process...
2024-12-19 13:03:28,634 - __main__ - INFO - Successfully loaded tables:
2024-12-19 13:03:28,634 - __main__ - INFO - Revenue: (13, 6)
2024-12-19 13:03:28,634 - __main__ - INFO - Discount: (13, 7)
2024-12-19 13:03:28,634 - __main__ - INFO - Price Correlation: (13, 6)
2024-12-19 13:03:28,634 - __main__ - INFO - Reviews: (13, 7)
2024-12-19 13:03:28,635 - __main__ - INFO - Found categories: ['BLANKETS', 'BOOKS', 'CLOTHING', 'ELECTRONICS', 'HOME & KITCHEN', 'MAKEUP', 'MOBILE PHONE ACCESSORIES', 'MOTOR VEHICLE PARTS', 'NAIL CARE', 'SKIN CARE', 'TOYS & GAMES', 'UNDERWEAR', 'VITAMINS AND SUPPLEMENTS']
2024-12-19 13:03:28,639 - __main__ - INFO - Final merged dataset shape: (13, 23)
2024-12-19 13:03:28,639 - __main__ - INFO - Available columns: ['Category', 'TotalRevenue', 'TotalSales', 'AveragePrice', 'ProductCount', 'AvgDiscountPercentage', 'AvgDiscountPercentage_disc', 'TotalDiscountedRevenue', 'PotentialRevenue', 'AvgSales', 'RevenueLossFromDiscount', 'DiscountROI', 'PriceRatingCorrelation', 'AvgPrice', 'AvgRating', 'AvgReviews', 'PriceRatingRelationship', 'TotalReviews', 'TotalSales_review', 'AvgRating_review', 'HighRatingCount', 'ReviewToSalesRatio', 'CustomerEngagementLevel']
2024-12-19 13:03:28,809 - __main__ - INFO - Created advanced features. Shape: (13, 44)
2024-12-19 13:03:28,809 - __main__ - INFO - Number of numeric features: 23
2024-12-19 13:03:28,809 - __main__ - INFO - Number of categorical features: 3
2024-12-19 13:03:28,811 - __main__ - INFO - Training stacked model...
2024-12-19 13:03:28,836 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:03:28,845 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:03:28,849 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:03:28,853 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:03:28,857 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:03:28,863 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:03:28,868 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:03:28,873 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:03:28,879 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:03:28,885 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:03:28,891 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:03:28,898 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:03:28,906 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:03:28,914 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:03:28,936 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:03:28,946 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:03:28,955 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:03:29,373 - py4j.clientserver - INFO - Error while sending or receiving.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer
2024-12-19 13:03:29,374 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:03:29,375 - root - INFO - Exception while sending command.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 506, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending
2024-12-19 13:03:29,379 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:03:31,159 - __main__ - INFO - Model Performance:
2024-12-19 13:03:31,160 - __main__ - INFO - RÂ² score: -382.1244
2024-12-19 13:03:31,160 - __main__ - INFO - MSE: 7083544.9982
2024-12-19 13:03:31,160 - __main__ - INFO - RMSE: 2661.4930
2024-12-19 13:03:31,160 - __main__ - INFO - MAE: 2061.1841
2024-12-19 13:03:31,161 - __main__ - WARNING - Feature importance length mismatch: 3 vs 41
2024-12-19 13:03:31,162 - __main__ - INFO - 
Top 10 Most Important Features:
2024-12-19 13:03:31,163 - __main__ - INFO -                  feature  importance  importance_percentage
0           AveragePrice    0.569925              56.992526
2              AvgRating    0.397162              39.716232
1  AvgDiscountPercentage    0.032912               3.291242
2024-12-19 13:03:31,274 - __main__ - INFO - Model saved to /home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/src/models/training/trained_models/sales_predictor.joblib
2024-12-19 13:03:31,596 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:05:09,153 - __main__ - INFO - Starting enhanced model training process...
2024-12-19 13:05:14,863 - __main__ - INFO - Successfully loaded tables:
2024-12-19 13:05:14,863 - __main__ - INFO - Revenue: (13, 6)
2024-12-19 13:05:14,863 - __main__ - INFO - Discount: (13, 7)
2024-12-19 13:05:14,863 - __main__ - INFO - Price Correlation: (13, 6)
2024-12-19 13:05:14,863 - __main__ - INFO - Reviews: (13, 7)
2024-12-19 13:05:14,863 - __main__ - INFO - Found categories: ['BLANKETS', 'BOOKS', 'CLOTHING', 'ELECTRONICS', 'HOME & KITCHEN', 'MAKEUP', 'MOBILE PHONE ACCESSORIES', 'MOTOR VEHICLE PARTS', 'NAIL CARE', 'SKIN CARE', 'TOYS & GAMES', 'UNDERWEAR', 'VITAMINS AND SUPPLEMENTS']
2024-12-19 13:05:14,868 - __main__ - INFO - Final merged dataset shape: (13, 23)
2024-12-19 13:05:14,868 - __main__ - INFO - Available columns: ['Category', 'TotalRevenue', 'TotalSales', 'AveragePrice', 'ProductCount', 'AvgDiscountPercentage', 'AvgDiscountPercentage_disc', 'TotalDiscountedRevenue', 'PotentialRevenue', 'AvgSales', 'RevenueLossFromDiscount', 'DiscountROI', 'PriceRatingCorrelation', 'AvgPrice', 'AvgRating', 'AvgReviews', 'PriceRatingRelationship', 'TotalReviews', 'TotalSales_review', 'AvgRating_review', 'HighRatingCount', 'ReviewToSalesRatio', 'CustomerEngagementLevel']
2024-12-19 13:05:15,134 - __main__ - INFO - Created advanced features. Shape: (13, 44)
2024-12-19 13:05:15,135 - __main__ - INFO - Number of numeric features: 23
2024-12-19 13:05:15,135 - __main__ - INFO - Number of categorical features: 3
2024-12-19 13:05:15,137 - __main__ - INFO - Training stacked model...
2024-12-19 13:05:15,161 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:05:15,169 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:05:15,172 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:05:15,176 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:05:15,179 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:05:15,183 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:05:15,187 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:05:15,192 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:05:15,197 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:05:15,203 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:05:15,208 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:05:15,213 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:05:15,219 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:05:15,225 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:05:15,231 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:05:15,259 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:05:15,281 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:05:15,780 - py4j.clientserver - INFO - Error while sending or receiving.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer
2024-12-19 13:05:15,781 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:05:15,782 - root - INFO - Exception while sending command.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 506, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending
2024-12-19 13:05:15,787 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:05:17,672 - __main__ - INFO - Model Performance:
2024-12-19 13:05:17,673 - __main__ - INFO - RÂ² score: -382.1244
2024-12-19 13:05:17,673 - __main__ - INFO - MSE: 7083544.9982
2024-12-19 13:05:17,673 - __main__ - INFO - RMSE: 2661.4930
2024-12-19 13:05:17,673 - __main__ - INFO - MAE: 2061.1841
2024-12-19 13:05:17,674 - __main__ - WARNING - Feature importance length mismatch: 3 vs 41
2024-12-19 13:05:17,676 - __main__ - INFO - 
Top 10 Most Important Features:
2024-12-19 13:05:17,676 - __main__ - INFO -                  feature  importance  importance_percentage
0           AveragePrice    0.569925              56.992526
2              AvgRating    0.397162              39.716232
1  AvgDiscountPercentage    0.032912               3.291242
2024-12-19 13:05:17,801 - __main__ - INFO - Model saved to /home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/src/models/training/trained_models/sales_predictor.joblib
2024-12-19 13:05:18,141 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:06:50,628 - __main__ - INFO - Starting enhanced model training process...
2024-12-19 13:06:56,913 - __main__ - INFO - Successfully loaded tables:
2024-12-19 13:06:56,914 - __main__ - INFO - Revenue: (13, 6)
2024-12-19 13:06:56,914 - __main__ - INFO - Discount: (13, 7)
2024-12-19 13:06:56,914 - __main__ - INFO - Price Correlation: (13, 6)
2024-12-19 13:06:56,914 - __main__ - INFO - Reviews: (13, 7)
2024-12-19 13:06:56,914 - __main__ - INFO - Found categories: ['BLANKETS', 'BOOKS', 'CLOTHING', 'ELECTRONICS', 'HOME & KITCHEN', 'MAKEUP', 'MOBILE PHONE ACCESSORIES', 'MOTOR VEHICLE PARTS', 'NAIL CARE', 'SKIN CARE', 'TOYS & GAMES', 'UNDERWEAR', 'VITAMINS AND SUPPLEMENTS']
2024-12-19 13:06:56,919 - __main__ - INFO - Final merged dataset shape: (13, 23)
2024-12-19 13:06:56,919 - __main__ - INFO - Available columns: ['Category', 'TotalRevenue', 'TotalSales', 'AveragePrice', 'ProductCount', 'AvgDiscountPercentage', 'AvgDiscountPercentage_disc', 'TotalDiscountedRevenue', 'PotentialRevenue', 'AvgSales', 'RevenueLossFromDiscount', 'DiscountROI', 'PriceRatingCorrelation', 'AvgPrice', 'AvgRating', 'AvgReviews', 'PriceRatingRelationship', 'TotalReviews', 'TotalSales_review', 'AvgRating_review', 'HighRatingCount', 'ReviewToSalesRatio', 'CustomerEngagementLevel']
2024-12-19 13:06:57,321 - __main__ - INFO - Created advanced features. Shape: (13, 44)
2024-12-19 13:06:57,321 - __main__ - INFO - Number of numeric features: 23
2024-12-19 13:06:57,321 - __main__ - INFO - Number of categorical features: 3
2024-12-19 13:06:57,323 - __main__ - INFO - Training stacked model...
2024-12-19 13:06:57,348 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:06:57,356 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:06:57,358 - py4j.clientserver - INFO - Error while sending or receiving.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer
2024-12-19 13:06:57,371 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:06:57,377 - root - INFO - Exception while sending command.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 506, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending
2024-12-19 13:06:57,398 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:06:57,446 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:06:57,451 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:06:57,458 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:06:57,471 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:06:58,426 - py4j.clientserver - INFO - Error while sending or receiving.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer
2024-12-19 13:06:58,426 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:06:58,427 - root - INFO - Exception while sending command.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 506, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending
2024-12-19 13:06:58,428 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:06:59,805 - __main__ - INFO - Model Performance:
2024-12-19 13:06:59,805 - __main__ - INFO - RÂ² score: -382.1244
2024-12-19 13:06:59,805 - __main__ - INFO - MSE: 7083544.9982
2024-12-19 13:06:59,805 - __main__ - INFO - RMSE: 2661.4930
2024-12-19 13:06:59,806 - __main__ - INFO - MAE: 2061.1841
2024-12-19 13:06:59,806 - __main__ - WARNING - Feature importance length mismatch: 3 vs 41
2024-12-19 13:06:59,807 - __main__ - INFO - 
Top 10 Most Important Features:
2024-12-19 13:06:59,807 - __main__ - INFO -                  feature  importance  importance_percentage
0           AveragePrice    0.569925              56.992526
2              AvgRating    0.397162              39.716232
1  AvgDiscountPercentage    0.032912               3.291242
2024-12-19 13:06:59,902 - __main__ - INFO - Model saved to /home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/src/models/training/trained_models/sales_predictor.joblib
2024-12-19 13:07:00,214 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:08:28,935 - __main__ - INFO - Starting enhanced model training process...
2024-12-19 13:08:34,803 - __main__ - INFO - Successfully loaded tables:
2024-12-19 13:08:34,803 - __main__ - INFO - Revenue: (13, 6)
2024-12-19 13:08:34,803 - __main__ - INFO - Discount: (13, 7)
2024-12-19 13:08:34,803 - __main__ - INFO - Price Correlation: (13, 6)
2024-12-19 13:08:34,803 - __main__ - INFO - Reviews: (13, 7)
2024-12-19 13:08:34,804 - __main__ - INFO - Found categories: ['BLANKETS', 'BOOKS', 'CLOTHING', 'ELECTRONICS', 'HOME & KITCHEN', 'MAKEUP', 'MOBILE PHONE ACCESSORIES', 'MOTOR VEHICLE PARTS', 'NAIL CARE', 'SKIN CARE', 'TOYS & GAMES', 'UNDERWEAR', 'VITAMINS AND SUPPLEMENTS']
2024-12-19 13:08:34,808 - __main__ - INFO - Final merged dataset shape: (13, 23)
2024-12-19 13:08:34,808 - __main__ - INFO - Available columns: ['Category', 'TotalRevenue', 'TotalSales', 'AveragePrice', 'ProductCount', 'AvgDiscountPercentage', 'AvgDiscountPercentage_disc', 'TotalDiscountedRevenue', 'PotentialRevenue', 'AvgSales', 'RevenueLossFromDiscount', 'DiscountROI', 'PriceRatingCorrelation', 'AvgPrice', 'AvgRating', 'AvgReviews', 'PriceRatingRelationship', 'TotalReviews', 'TotalSales_review', 'AvgRating_review', 'HighRatingCount', 'ReviewToSalesRatio', 'CustomerEngagementLevel']
2024-12-19 13:08:35,055 - __main__ - INFO - Created advanced features. Shape: (13, 44)
2024-12-19 13:08:35,055 - __main__ - INFO - Number of numeric features: 23
2024-12-19 13:08:35,055 - __main__ - INFO - Number of categorical features: 3
2024-12-19 13:08:35,057 - __main__ - INFO - Training stacked model...
2024-12-19 13:08:35,083 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:08:35,092 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:08:35,096 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:08:35,100 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:08:35,104 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:08:35,109 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:08:35,114 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:08:35,119 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:08:35,124 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:08:35,131 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:08:35,135 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:08:35,140 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:08:35,146 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:08:35,159 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:08:35,178 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:08:35,185 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:08:35,185 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:08:35,661 - py4j.clientserver - INFO - Error while sending or receiving.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer
2024-12-19 13:08:35,663 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:08:35,663 - root - INFO - Exception while sending command.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 506, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending
2024-12-19 13:08:35,668 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:08:37,514 - __main__ - INFO - Model Performance:
2024-12-19 13:08:37,515 - __main__ - INFO - RÂ² score: -382.1244
2024-12-19 13:08:37,515 - __main__ - INFO - MSE: 7083544.9982
2024-12-19 13:08:37,515 - __main__ - INFO - RMSE: 2661.4930
2024-12-19 13:08:37,515 - __main__ - INFO - MAE: 2061.1841
2024-12-19 13:08:37,516 - __main__ - WARNING - Feature importance length mismatch: 3 vs 41
2024-12-19 13:08:37,517 - __main__ - INFO - 
Top 10 Most Important Features:
2024-12-19 13:08:37,517 - __main__ - INFO -                  feature  importance  importance_percentage
0           AveragePrice    0.569925              56.992526
2              AvgRating    0.397162              39.716232
1  AvgDiscountPercentage    0.032912               3.291242
2024-12-19 13:08:37,621 - __main__ - INFO - Model saved to /home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/src/models/training/trained_models/sales_predictor.joblib
2024-12-19 13:08:37,914 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:09:39,617 - __main__ - INFO - Starting enhanced model training process...
2024-12-19 13:09:43,324 - __main__ - WARNING - Error reading as Delta format: [PATH_NOT_FOUND] Path does not exist: file:/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/src/data/gold/revenue_per_category_parquet.
2024-12-19 13:09:43,324 - __main__ - INFO - Trying to read as parquet format...
2024-12-19 13:09:43,330 - __main__ - ERROR - Error in load_data: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2024-12-19 13:09:43,394 - __main__ - ERROR - Error in model training: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2024-12-19 13:09:43,394 - __main__ - ERROR - Error in main: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2024-12-19 13:09:43,400 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:09:44,280 - __main__ - INFO - Starting enhanced model training process...
2024-12-19 13:09:47,656 - __main__ - WARNING - Error reading as Delta format: [PATH_NOT_FOUND] Path does not exist: file:/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/src/data/gold/revenue_per_category_parquet.
2024-12-19 13:09:47,656 - __main__ - INFO - Trying to read as parquet format...
2024-12-19 13:09:47,661 - __main__ - ERROR - Error in load_data: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2024-12-19 13:09:47,833 - __main__ - ERROR - Error in model training: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2024-12-19 13:09:47,833 - __main__ - ERROR - Error in main: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2024-12-19 13:09:47,838 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:10:09,654 - __main__ - INFO - Starting enhanced model training process...
2024-12-19 13:10:13,305 - __main__ - WARNING - Error reading as Delta format: [PATH_NOT_FOUND] Path does not exist: file:/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/src/data/gold/revenue_per_category_parquet.
2024-12-19 13:10:13,305 - __main__ - INFO - Trying to read as parquet format...
2024-12-19 13:10:13,311 - __main__ - ERROR - Error in load_data: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2024-12-19 13:10:13,417 - __main__ - ERROR - Error in model training: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2024-12-19 13:10:13,417 - __main__ - ERROR - Error in main: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2024-12-19 13:10:13,421 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:10:15,073 - __main__ - INFO - Starting enhanced model training process...
2024-12-19 13:10:18,809 - __main__ - WARNING - Error reading as Delta format: [PATH_NOT_FOUND] Path does not exist: file:/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/src/data/gold/revenue_per_category_parquet.
2024-12-19 13:10:18,809 - __main__ - INFO - Trying to read as parquet format...
2024-12-19 13:10:18,814 - __main__ - ERROR - Error in load_data: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2024-12-19 13:10:18,986 - __main__ - ERROR - Error in model training: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2024-12-19 13:10:18,986 - __main__ - ERROR - Error in main: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2024-12-19 13:10:18,991 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:10:19,999 - __main__ - INFO - Starting enhanced model training process...
2024-12-19 13:10:23,656 - __main__ - WARNING - Error reading as Delta format: [PATH_NOT_FOUND] Path does not exist: file:/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/src/data/gold/revenue_per_category_parquet.
2024-12-19 13:10:23,656 - __main__ - INFO - Trying to read as parquet format...
2024-12-19 13:10:23,661 - __main__ - ERROR - Error in load_data: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2024-12-19 13:10:24,200 - __main__ - ERROR - Error in model training: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2024-12-19 13:10:24,200 - __main__ - ERROR - Error in main: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2024-12-19 13:10:24,203 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:10:50,727 - __main__ - INFO - Starting enhanced model training process...
2024-12-19 13:10:54,361 - __main__ - WARNING - Error reading as Delta format: [PATH_NOT_FOUND] Path does not exist: file:/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/src/data/gold/revenue_per_category_parquet.
2024-12-19 13:10:54,362 - __main__ - INFO - Trying to read as parquet format...
2024-12-19 13:10:54,367 - __main__ - ERROR - Error in load_data: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2024-12-19 13:10:54,452 - __main__ - ERROR - Error in model training: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2024-12-19 13:10:54,453 - __main__ - ERROR - Error in main: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2024-12-19 13:10:54,457 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:11:16,208 - __main__ - INFO - Starting enhanced model training process...
2024-12-19 13:11:19,358 - __main__ - WARNING - Error reading as Delta format: [PATH_NOT_FOUND] Path does not exist: file:/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/src/data/gold/revenue_per_category_parquet.
2024-12-19 13:11:19,358 - __main__ - INFO - Trying to read as parquet format...
2024-12-19 13:11:19,363 - __main__ - ERROR - Error in load_data: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2024-12-19 13:11:19,577 - __main__ - ERROR - Error in model training: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2024-12-19 13:11:19,577 - __main__ - ERROR - Error in main: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2024-12-19 13:11:19,581 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:11:20,562 - __main__ - INFO - Starting enhanced model training process...
2024-12-19 13:11:23,939 - __main__ - WARNING - Error reading as Delta format: [PATH_NOT_FOUND] Path does not exist: file:/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/src/data/gold/revenue_per_category_parquet.
2024-12-19 13:11:23,940 - __main__ - INFO - Trying to read as parquet format...
2024-12-19 13:11:23,945 - __main__ - ERROR - Error in load_data: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2024-12-19 13:11:24,020 - __main__ - ERROR - Error in model training: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2024-12-19 13:11:24,020 - __main__ - ERROR - Error in main: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2024-12-19 13:11:24,024 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:11:26,388 - __main__ - INFO - Starting enhanced model training process...
2024-12-19 13:11:29,928 - __main__ - WARNING - Error reading as Delta format: [PATH_NOT_FOUND] Path does not exist: file:/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/src/data/gold/revenue_per_category_parquet.
2024-12-19 13:11:29,928 - __main__ - INFO - Trying to read as parquet format...
2024-12-19 13:11:29,934 - __main__ - ERROR - Error in load_data: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2024-12-19 13:11:30,025 - __main__ - ERROR - Error in model training: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2024-12-19 13:11:30,026 - __main__ - ERROR - Error in main: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2024-12-19 13:11:30,030 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:11:31,530 - __main__ - INFO - Starting enhanced model training process...
2024-12-19 13:11:38,806 - __main__ - WARNING - Error reading as Delta format: [PATH_NOT_FOUND] Path does not exist: file:/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/src/data/gold/revenue_per_category_parquet.
2024-12-19 13:11:38,807 - __main__ - INFO - Trying to read as parquet format...
2024-12-19 13:11:38,812 - __main__ - ERROR - Error in load_data: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2024-12-19 13:11:38,896 - __main__ - ERROR - Error in model training: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2024-12-19 13:11:38,897 - __main__ - ERROR - Error in main: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2024-12-19 13:11:38,902 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:11:58,023 - __main__ - INFO - Starting enhanced model training process...
2024-12-19 13:12:01,692 - __main__ - WARNING - Error reading as Delta format: [PATH_NOT_FOUND] Path does not exist: file:/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/src/data/gold/revenue_per_category_parquet.
2024-12-19 13:12:01,692 - __main__ - INFO - Trying to read as parquet format...
2024-12-19 13:12:01,697 - __main__ - ERROR - Error in load_data: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2024-12-19 13:12:01,803 - __main__ - ERROR - Error in model training: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2024-12-19 13:12:01,804 - __main__ - ERROR - Error in main: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2024-12-19 13:12:01,808 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:12:20,682 - __main__ - INFO - Starting enhanced model training process...
2024-12-19 13:12:24,204 - __main__ - WARNING - Error reading as Delta format: [PATH_NOT_FOUND] Path does not exist: file:/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/src/data/gold/revenue_per_category_parquet.
2024-12-19 13:12:24,204 - __main__ - INFO - Trying to read as parquet format...
2024-12-19 13:12:24,209 - __main__ - ERROR - Error in load_data: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2024-12-19 13:12:28,058 - __main__ - ERROR - Error in model training: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2024-12-19 13:12:28,059 - __main__ - ERROR - Error in main: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2024-12-19 13:12:28,063 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:12:32,865 - __main__ - INFO - Starting enhanced model training process...
2024-12-19 13:12:36,709 - __main__ - WARNING - Error reading as Delta format: [PATH_NOT_FOUND] Path does not exist: file:/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/src/data/gold/revenue_per_category_parquet.
2024-12-19 13:12:36,710 - __main__ - INFO - Trying to read as parquet format...
2024-12-19 13:12:36,715 - __main__ - ERROR - Error in load_data: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2024-12-19 13:12:37,158 - __main__ - ERROR - Error in model training: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2024-12-19 13:12:37,158 - __main__ - ERROR - Error in main: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2024-12-19 13:12:37,162 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:12:38,899 - __main__ - INFO - Starting enhanced model training process...
2024-12-19 13:12:42,604 - __main__ - WARNING - Error reading as Delta format: [PATH_NOT_FOUND] Path does not exist: file:/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/src/data/gold/revenue_per_category_parquet.
2024-12-19 13:12:42,605 - __main__ - INFO - Trying to read as parquet format...
2024-12-19 13:12:42,610 - __main__ - ERROR - Error in load_data: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2024-12-19 13:12:42,073 - __main__ - ERROR - Error in model training: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2024-12-19 13:12:42,073 - __main__ - ERROR - Error in main: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2024-12-19 13:12:42,078 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:12:46,118 - __main__ - INFO - Starting enhanced model training process...
2024-12-19 13:12:49,852 - __main__ - WARNING - Error reading as Delta format: [PATH_NOT_FOUND] Path does not exist: file:/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/src/data/gold/revenue_per_category_parquet.
2024-12-19 13:12:49,852 - __main__ - INFO - Trying to read as parquet format...
2024-12-19 13:12:49,857 - __main__ - ERROR - Error in load_data: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2024-12-19 13:12:49,908 - __main__ - ERROR - Error in model training: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2024-12-19 13:12:49,908 - __main__ - ERROR - Error in main: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2024-12-19 13:12:49,913 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:13:07,901 - __main__ - INFO - Starting enhanced model training process...
2024-12-19 13:13:11,611 - __main__ - WARNING - Error reading as Delta format: [PATH_NOT_FOUND] Path does not exist: file:/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/src/data/gold/revenue_per_category_parquet.
2024-12-19 13:13:11,612 - __main__ - INFO - Trying to read as parquet format...
2024-12-19 13:13:11,617 - __main__ - ERROR - Error in load_data: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2024-12-19 13:13:11,685 - __main__ - ERROR - Error in model training: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2024-12-19 13:13:11,685 - __main__ - ERROR - Error in main: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2024-12-19 13:13:11,689 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:13:29,512 - __main__ - INFO - Starting enhanced model training process...
2024-12-19 13:13:33,086 - __main__ - WARNING - Error reading as Delta format: [PATH_NOT_FOUND] Path does not exist: file:/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/src/data/gold/revenue_per_category_parquet.
2024-12-19 13:13:33,086 - __main__ - INFO - Trying to read as parquet format...
2024-12-19 13:13:33,091 - __main__ - ERROR - Error in load_data: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2024-12-19 13:13:33,200 - __main__ - ERROR - Error in model training: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2024-12-19 13:13:33,200 - __main__ - ERROR - Error in main: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2024-12-19 13:13:33,206 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:13:39,708 - __main__ - INFO - Starting enhanced model training process...
2024-12-19 13:13:43,460 - __main__ - WARNING - Error reading as Delta format: [PATH_NOT_FOUND] Path does not exist: file:/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/src/data/gold/revenue_per_category_parquet.
2024-12-19 13:13:43,461 - __main__ - INFO - Trying to read as parquet format...
2024-12-19 13:13:43,466 - __main__ - ERROR - Error in load_data: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2024-12-19 13:13:43,995 - __main__ - ERROR - Error in model training: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2024-12-19 13:13:43,995 - __main__ - ERROR - Error in main: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2024-12-19 13:13:44,000 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:13:51,517 - __main__ - INFO - Starting enhanced model training process...
2024-12-19 13:13:55,264 - __main__ - WARNING - Error reading as Delta format: [PATH_NOT_FOUND] Path does not exist: file:/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/src/data/gold/revenue_per_category_parquet.
2024-12-19 13:13:55,264 - __main__ - INFO - Trying to read as parquet format...
2024-12-19 13:13:55,270 - __main__ - ERROR - Error in load_data: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2024-12-19 13:13:55,329 - __main__ - ERROR - Error in model training: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2024-12-19 13:13:55,329 - __main__ - ERROR - Error in main: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2024-12-19 13:13:55,334 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:13:57,249 - __main__ - INFO - Starting enhanced model training process...
2024-12-19 13:14:01,137 - __main__ - WARNING - Error reading as Delta format: [PATH_NOT_FOUND] Path does not exist: file:/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/src/data/gold/revenue_per_category_parquet.
2024-12-19 13:14:01,137 - __main__ - INFO - Trying to read as parquet format...
2024-12-19 13:14:01,143 - __main__ - ERROR - Error in load_data: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2024-12-19 13:14:01,197 - __main__ - ERROR - Error in model training: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2024-12-19 13:14:01,198 - __main__ - ERROR - Error in main: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2024-12-19 13:14:01,203 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:14:14,397 - __main__ - INFO - Starting enhanced model training process...
2024-12-19 13:14:17,841 - __main__ - WARNING - Error reading as Delta format: [PATH_NOT_FOUND] Path does not exist: file:/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/src/data/gold/revenue_per_category_parquet.
2024-12-19 13:14:17,842 - __main__ - INFO - Trying to read as parquet format...
2024-12-19 13:14:17,847 - __main__ - ERROR - Error in load_data: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2024-12-19 13:14:17,937 - __main__ - ERROR - Error in model training: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2024-12-19 13:14:17,938 - __main__ - ERROR - Error in main: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2024-12-19 13:14:17,942 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:14:18,906 - __main__ - INFO - Starting enhanced model training process...
2024-12-19 13:14:26,082 - __main__ - WARNING - Error reading as Delta format: [PATH_NOT_FOUND] Path does not exist: file:/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/src/data/gold/revenue_per_category_parquet.
2024-12-19 13:14:26,082 - __main__ - INFO - Trying to read as parquet format...
2024-12-19 13:14:26,087 - __main__ - ERROR - Error in load_data: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2024-12-19 13:14:26,594 - __main__ - ERROR - Error in model training: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2024-12-19 13:14:26,594 - __main__ - ERROR - Error in main: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2024-12-19 13:14:26,598 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:14:39,459 - __main__ - INFO - Starting enhanced model training process...
2024-12-19 13:14:43,274 - __main__ - WARNING - Error reading as Delta format: [PATH_NOT_FOUND] Path does not exist: file:/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/src/data/gold/revenue_per_category_parquet.
2024-12-19 13:14:43,274 - __main__ - INFO - Trying to read as parquet format...
2024-12-19 13:14:43,280 - __main__ - ERROR - Error in load_data: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2024-12-19 13:14:43,352 - __main__ - ERROR - Error in model training: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2024-12-19 13:14:43,352 - __main__ - ERROR - Error in main: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2024-12-19 13:14:43,357 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:14:49,320 - __main__ - INFO - Starting enhanced model training process...
2024-12-19 13:14:53,500 - __main__ - WARNING - Error reading as Delta format: [PATH_NOT_FOUND] Path does not exist: file:/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/src/data/gold/revenue_per_category_parquet.
2024-12-19 13:14:53,501 - __main__ - INFO - Trying to read as parquet format...
2024-12-19 13:14:53,506 - __main__ - ERROR - Error in load_data: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2024-12-19 13:14:57,254 - __main__ - ERROR - Error in model training: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2024-12-19 13:14:57,254 - __main__ - ERROR - Error in main: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2024-12-19 13:14:57,259 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:15:02,676 - __main__ - INFO - Starting enhanced model training process...
2024-12-19 13:15:06,096 - __main__ - WARNING - Error reading as Delta format: [PATH_NOT_FOUND] Path does not exist: file:/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/src/data/gold/revenue_per_category_parquet.
2024-12-19 13:15:06,097 - __main__ - INFO - Trying to read as parquet format...
2024-12-19 13:15:06,102 - __main__ - ERROR - Error in load_data: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2024-12-19 13:15:06,169 - __main__ - ERROR - Error in model training: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2024-12-19 13:15:06,169 - __main__ - ERROR - Error in main: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2024-12-19 13:15:06,173 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:15:08,550 - __main__ - INFO - Starting enhanced model training process...
2024-12-19 13:15:12,008 - __main__ - WARNING - Error reading as Delta format: [PATH_NOT_FOUND] Path does not exist: file:/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/src/data/gold/revenue_per_category_parquet.
2024-12-19 13:15:12,009 - __main__ - INFO - Trying to read as parquet format...
2024-12-19 13:15:12,014 - __main__ - ERROR - Error in load_data: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2024-12-19 13:15:12,143 - __main__ - ERROR - Error in model training: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2024-12-19 13:15:12,143 - __main__ - ERROR - Error in main: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2024-12-19 13:15:12,147 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:15:21,975 - __main__ - INFO - Starting enhanced model training process...
2024-12-19 13:15:26,477 - __main__ - WARNING - Error reading as Delta format: [PATH_NOT_FOUND] Path does not exist: file:/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/src/data/gold/revenue_per_category_parquet.
2024-12-19 13:15:26,478 - __main__ - INFO - Trying to read as parquet format...
2024-12-19 13:15:26,484 - __main__ - ERROR - Error in load_data: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2024-12-19 13:15:26,847 - __main__ - ERROR - Error in model training: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2024-12-19 13:15:26,847 - __main__ - ERROR - Error in main: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2024-12-19 13:15:26,852 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:15:34,004 - __main__ - INFO - Starting enhanced model training process...
2024-12-19 13:15:37,516 - __main__ - WARNING - Error reading as Delta format: [PATH_NOT_FOUND] Path does not exist: file:/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/src/data/gold/revenue_per_category_parquet.
2024-12-19 13:15:37,517 - __main__ - INFO - Trying to read as parquet format...
2024-12-19 13:15:37,522 - __main__ - ERROR - Error in load_data: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2024-12-19 13:15:37,678 - __main__ - ERROR - Error in model training: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2024-12-19 13:15:37,679 - __main__ - ERROR - Error in main: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2024-12-19 13:15:37,682 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:15:46,328 - __main__ - INFO - Starting enhanced model training process...
2024-12-19 13:15:49,693 - __main__ - WARNING - Error reading as Delta format: [PATH_NOT_FOUND] Path does not exist: file:/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/src/data/gold/revenue_per_category_parquet.
2024-12-19 13:15:49,693 - __main__ - INFO - Trying to read as parquet format...
2024-12-19 13:15:49,698 - __main__ - ERROR - Error in load_data: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2024-12-19 13:15:49,842 - __main__ - ERROR - Error in model training: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2024-12-19 13:15:49,842 - __main__ - ERROR - Error in main: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2024-12-19 13:15:49,847 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:15:50,666 - __main__ - INFO - Starting enhanced model training process...
2024-12-19 13:15:55,018 - __main__ - WARNING - Error reading as Delta format: [PATH_NOT_FOUND] Path does not exist: file:/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/src/data/gold/revenue_per_category_parquet.
2024-12-19 13:15:55,018 - __main__ - INFO - Trying to read as parquet format...
2024-12-19 13:15:55,025 - __main__ - ERROR - Error in load_data: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2024-12-19 13:15:55,483 - __main__ - ERROR - Error in model training: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2024-12-19 13:15:55,483 - __main__ - ERROR - Error in main: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2024-12-19 13:15:55,487 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:15:57,755 - __main__ - INFO - Starting enhanced model training process...
2024-12-19 13:16:04,832 - __main__ - WARNING - Error reading as Delta format: [PATH_NOT_FOUND] Path does not exist: file:/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/src/data/gold/revenue_per_category_parquet.
2024-12-19 13:16:04,832 - __main__ - INFO - Trying to read as parquet format...
2024-12-19 13:16:04,838 - __main__ - ERROR - Error in load_data: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2024-12-19 13:16:05,332 - __main__ - ERROR - Error in model training: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2024-12-19 13:16:05,332 - __main__ - ERROR - Error in main: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2024-12-19 13:16:05,336 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:16:14,028 - __main__ - INFO - Starting enhanced model training process...
2024-12-19 13:16:18,912 - __main__ - WARNING - Error reading as Delta format: [PATH_NOT_FOUND] Path does not exist: file:/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/src/data/gold/revenue_per_category_parquet.
2024-12-19 13:16:18,912 - __main__ - INFO - Trying to read as parquet format...
2024-12-19 13:16:18,919 - __main__ - ERROR - Error in load_data: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2024-12-19 13:16:19,283 - __main__ - ERROR - Error in model training: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2024-12-19 13:16:19,283 - __main__ - ERROR - Error in main: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2024-12-19 13:16:19,287 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:16:32,245 - __main__ - INFO - Starting enhanced model training process...
2024-12-19 13:16:39,798 - __main__ - WARNING - Error reading as Delta format: [PATH_NOT_FOUND] Path does not exist: file:/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/src/data/gold/revenue_per_category_parquet.
2024-12-19 13:16:39,798 - __main__ - INFO - Trying to read as parquet format...
2024-12-19 13:16:39,807 - __main__ - ERROR - Error in load_data: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2024-12-19 13:16:40,193 - __main__ - ERROR - Error in model training: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2024-12-19 13:16:40,193 - __main__ - ERROR - Error in main: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2024-12-19 13:16:40,198 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:16:45,272 - __main__ - INFO - Starting enhanced model training process...
2024-12-19 13:16:51,167 - __main__ - WARNING - Error reading as Delta format: [PATH_NOT_FOUND] Path does not exist: file:/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/src/data/gold/revenue_per_category_parquet.
2024-12-19 13:16:51,168 - __main__ - INFO - Trying to read as parquet format...
2024-12-19 13:16:51,175 - __main__ - ERROR - Error in load_data: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2024-12-19 13:16:51,679 - __main__ - ERROR - Error in model training: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2024-12-19 13:16:51,679 - __main__ - ERROR - Error in main: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2024-12-19 13:16:51,684 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:16:53,295 - __main__ - INFO - Starting enhanced model training process...
2024-12-19 13:16:58,285 - __main__ - WARNING - Error reading as Delta format: [PATH_NOT_FOUND] Path does not exist: file:/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/src/data/gold/revenue_per_category_parquet.
2024-12-19 13:16:58,285 - __main__ - INFO - Trying to read as parquet format...
2024-12-19 13:16:58,293 - __main__ - ERROR - Error in load_data: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2024-12-19 13:16:58,833 - __main__ - ERROR - Error in model training: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2024-12-19 13:16:58,833 - __main__ - ERROR - Error in main: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2024-12-19 13:16:58,838 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:17:03,064 - __main__ - INFO - Starting enhanced model training process...
2024-12-19 13:17:15,599 - __main__ - INFO - Successfully loaded tables:
2024-12-19 13:17:15,599 - __main__ - INFO - Revenue: (3, 6)
2024-12-19 13:17:15,600 - __main__ - INFO - Discount: (3, 7)
2024-12-19 13:17:15,600 - __main__ - INFO - Price Correlation: (3, 6)
2024-12-19 13:17:15,600 - __main__ - INFO - Reviews: (3, 7)
2024-12-19 13:17:15,601 - __main__ - INFO - Found categories: ['MOTOR VEHICLE PARTS', 'NAIL CARE', 'UNDERWEAR']
2024-12-19 13:17:15,614 - __main__ - INFO - Final merged dataset shape: (3, 23)
2024-12-19 13:17:15,615 - __main__ - INFO - Available columns: ['Category', 'TotalRevenue', 'TotalSales', 'AveragePrice', 'ProductCount', 'AvgDiscountPercentage', 'AvgDiscountPercentage_disc', 'TotalDiscountedRevenue', 'PotentialRevenue', 'AvgSales', 'RevenueLossFromDiscount', 'DiscountROI', 'PriceRatingCorrelation', 'AvgPrice', 'AvgRating', 'AvgReviews', 'PriceRatingRelationship', 'TotalReviews', 'TotalSales_review', 'AvgRating_review', 'HighRatingCount', 'ReviewToSalesRatio', 'CustomerEngagementLevel']
2024-12-19 13:17:15,766 - __main__ - INFO - Created advanced features. Shape: (3, 44)
2024-12-19 13:17:15,767 - __main__ - INFO - Number of numeric features: 23
2024-12-19 13:17:15,767 - __main__ - INFO - Number of categorical features: 3
2024-12-19 13:17:15,770 - __main__ - INFO - Training stacked model...
2024-12-19 13:17:15,829 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:17:15,841 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:17:15,847 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:17:15,852 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:17:15,858 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:17:15,864 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:17:15,871 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:17:15,877 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:17:15,884 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:17:15,892 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:17:15,893 - py4j.clientserver - INFO - Error while sending or receiving.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer
2024-12-19 13:17:15,905 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:17:15,906 - root - INFO - Exception while sending command.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 506, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending
2024-12-19 13:17:15,947 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:17:15,965 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:17:15,993 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:17:16,950 - py4j.clientserver - INFO - Error while sending or receiving.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer
2024-12-19 13:17:16,950 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:17:16,950 - root - INFO - Exception while sending command.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 506, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending
2024-12-19 13:17:16,952 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:17:17,269 - __main__ - ERROR - Error in model training: Cannot have number of splits n_splits=5 greater than the number of samples: n_samples=2.
2024-12-19 13:17:17,269 - __main__ - ERROR - Error in main: Cannot have number of splits n_splits=5 greater than the number of samples: n_samples=2.
2024-12-19 13:17:17,274 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:17:22,972 - __main__ - INFO - Starting enhanced model training process...
2024-12-19 13:17:34,118 - __main__ - INFO - Successfully loaded tables:
2024-12-19 13:17:34,118 - __main__ - INFO - Revenue: (3, 6)
2024-12-19 13:17:34,119 - __main__ - INFO - Discount: (3, 7)
2024-12-19 13:17:34,119 - __main__ - INFO - Price Correlation: (3, 6)
2024-12-19 13:17:34,119 - __main__ - INFO - Reviews: (3, 7)
2024-12-19 13:17:34,119 - __main__ - INFO - Found categories: ['MOTOR VEHICLE PARTS', 'NAIL CARE', 'UNDERWEAR']
2024-12-19 13:17:34,125 - __main__ - INFO - Final merged dataset shape: (3, 23)
2024-12-19 13:17:34,125 - __main__ - INFO - Available columns: ['Category', 'TotalRevenue', 'TotalSales', 'AveragePrice', 'ProductCount', 'AvgDiscountPercentage', 'AvgDiscountPercentage_disc', 'TotalDiscountedRevenue', 'PotentialRevenue', 'AvgSales', 'RevenueLossFromDiscount', 'DiscountROI', 'PriceRatingCorrelation', 'AvgPrice', 'AvgRating', 'AvgReviews', 'PriceRatingRelationship', 'TotalReviews', 'TotalSales_review', 'AvgRating_review', 'HighRatingCount', 'ReviewToSalesRatio', 'CustomerEngagementLevel']
2024-12-19 13:17:34,550 - __main__ - INFO - Created advanced features. Shape: (3, 44)
2024-12-19 13:17:34,550 - __main__ - INFO - Number of numeric features: 23
2024-12-19 13:17:34,550 - __main__ - INFO - Number of categorical features: 3
2024-12-19 13:17:34,554 - __main__ - INFO - Training stacked model...
2024-12-19 13:17:34,605 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:17:34,624 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:17:34,654 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:17:34,659 - py4j.clientserver - INFO - Error while sending or receiving.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer
2024-12-19 13:17:34,753 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:17:34,786 - root - INFO - Exception while sending command.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 506, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending
2024-12-19 13:17:34,866 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:17:35,536 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:17:38,323 - __main__ - ERROR - Error in model training: Cannot have number of splits n_splits=5 greater than the number of samples: n_samples=2.
2024-12-19 13:17:38,324 - __main__ - ERROR - Error in main: Cannot have number of splits n_splits=5 greater than the number of samples: n_samples=2.
2024-12-19 13:17:38,329 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:17:44,133 - __main__ - INFO - Starting enhanced model training process...
2024-12-19 13:17:53,130 - __main__ - INFO - Successfully loaded tables:
2024-12-19 13:17:53,130 - __main__ - INFO - Revenue: (3, 6)
2024-12-19 13:17:53,131 - __main__ - INFO - Discount: (3, 7)
2024-12-19 13:17:53,131 - __main__ - INFO - Price Correlation: (3, 6)
2024-12-19 13:17:53,131 - __main__ - INFO - Reviews: (3, 7)
2024-12-19 13:17:53,131 - __main__ - INFO - Found categories: ['MOTOR VEHICLE PARTS', 'NAIL CARE', 'UNDERWEAR']
2024-12-19 13:17:53,140 - __main__ - INFO - Final merged dataset shape: (3, 23)
2024-12-19 13:17:53,140 - __main__ - INFO - Available columns: ['Category', 'TotalRevenue', 'TotalSales', 'AveragePrice', 'ProductCount', 'AvgDiscountPercentage', 'AvgDiscountPercentage_disc', 'TotalDiscountedRevenue', 'PotentialRevenue', 'AvgSales', 'RevenueLossFromDiscount', 'DiscountROI', 'PriceRatingCorrelation', 'AvgPrice', 'AvgRating', 'AvgReviews', 'PriceRatingRelationship', 'TotalReviews', 'TotalSales_review', 'AvgRating_review', 'HighRatingCount', 'ReviewToSalesRatio', 'CustomerEngagementLevel']
2024-12-19 13:17:53,715 - __main__ - INFO - Created advanced features. Shape: (3, 44)
2024-12-19 13:17:53,715 - __main__ - INFO - Number of numeric features: 23
2024-12-19 13:17:53,715 - __main__ - INFO - Number of categorical features: 3
2024-12-19 13:17:53,719 - __main__ - INFO - Training stacked model...
2024-12-19 13:17:53,801 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:17:53,821 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:17:53,829 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:17:53,847 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:17:53,848 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:17:53,858 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:17:53,868 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:17:53,880 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:17:53,906 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:17:53,915 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:17:53,916 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:17:53,922 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:17:53,929 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:17:53,958 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:17:53,969 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:17:53,976 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:17:53,989 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:17:54,077 - py4j.clientserver - INFO - Error while sending or receiving.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer
2024-12-19 13:17:54,080 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:17:54,080 - root - INFO - Exception while sending command.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 506, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending
2024-12-19 13:17:54,100 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:17:55,654 - __main__ - ERROR - Error in model training: Cannot have number of splits n_splits=5 greater than the number of samples: n_samples=2.
2024-12-19 13:17:55,654 - __main__ - ERROR - Error in main: Cannot have number of splits n_splits=5 greater than the number of samples: n_samples=2.
2024-12-19 13:17:55,658 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:17:59,587 - __main__ - INFO - Starting enhanced model training process...
2024-12-19 13:18:05,785 - __main__ - WARNING - Error reading as Delta format: An error occurred while calling o38.parquet.
: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 0.0 failed 1 times, most recent failure: Lost task 0.0 in stage 0.0 (TID 0) (10.255.255.254 executor driver): org.apache.spark.SparkException: Exception thrown in awaitResult: 
	at org.apache.spark.util.SparkThreadUtils$.awaitResult(SparkThreadUtils.scala:56)
	at org.apache.spark.util.ThreadUtils$.awaitResult(ThreadUtils.scala:310)
	at org.apache.spark.util.ThreadUtils$.parmap(ThreadUtils.scala:383)
	at org.apache.spark.sql.execution.datasources.parquet.ParquetFileFormat$.readParquetFootersInParallel(ParquetFileFormat.scala:443)
	at org.apache.spark.sql.execution.datasources.parquet.ParquetFileFormat$.$anonfun$mergeSchemasInParallel$1(ParquetFileFormat.scala:493)
	at org.apache.spark.sql.execution.datasources.parquet.ParquetFileFormat$.$anonfun$mergeSchemasInParallel$1$adapted(ParquetFileFormat.scala:485)
	at org.apache.spark.sql.execution.datasources.SchemaMergeUtils$.$anonfun$mergeSchemasInParallel$2(SchemaMergeUtils.scala:79)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitions$2(RDD.scala:855)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitions$2$adapted(RDD.scala:855)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)
	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)
	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:161)
	at org.apache.spark.scheduler.Task.run(Task.scala:141)
	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: java.io.FileNotFoundException: File file:/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/src/data/gold/revenue_per_category_parquet/part-00000-d81387af-9386-4eba-aaf1-75ed20c0fc94-c000.snappy.parquet does not exist
	at org.apache.hadoop.fs.RawLocalFileSystem.deprecatedGetFileStatus(RawLocalFileSystem.java:779)
	at org.apache.hadoop.fs.RawLocalFileSystem.getFileLinkStatusInternal(RawLocalFileSystem.java:1100)
	at org.apache.hadoop.fs.RawLocalFileSystem.getFileStatus(RawLocalFileSystem.java:769)
	at org.apache.hadoop.fs.FilterFileSystem.getFileStatus(FilterFileSystem.java:462)
	at org.apache.hadoop.fs.ChecksumFileSystem$ChecksumFSInputChecker.<init>(ChecksumFileSystem.java:160)
	at org.apache.hadoop.fs.ChecksumFileSystem.open(ChecksumFileSystem.java:372)
	at org.apache.hadoop.fs.FileSystem.open(FileSystem.java:976)
	at org.apache.parquet.hadoop.util.HadoopInputFile.newStream(HadoopInputFile.java:69)
	at org.apache.parquet.hadoop.ParquetFileReader.<init>(ParquetFileReader.java:796)
	at org.apache.parquet.hadoop.ParquetFileReader.open(ParquetFileReader.java:666)
	at org.apache.spark.sql.execution.datasources.parquet.ParquetFooterReader.readFooter(ParquetFooterReader.java:85)
	at org.apache.spark.sql.execution.datasources.parquet.ParquetFooterReader.readFooter(ParquetFooterReader.java:76)
	at org.apache.spark.sql.execution.datasources.parquet.ParquetFileFormat$.$anonfun$readParquetFootersInParallel$1(ParquetFileFormat.scala:450)
	at org.apache.spark.util.ThreadUtils$.$anonfun$parmap$2(ThreadUtils.scala:380)
	at scala.concurrent.Future$.$anonfun$apply$1(Future.scala:659)
	at scala.util.Success.$anonfun$map$1(Try.scala:255)
	at scala.util.Success.map(Try.scala:213)
	at scala.concurrent.Future.$anonfun$map$1(Future.scala:292)
	at scala.concurrent.impl.Promise.liftedTree1$1(Promise.scala:33)
	at scala.concurrent.impl.Promise.$anonfun$transform$1(Promise.scala:33)
	at scala.concurrent.impl.CallbackRunnable.run(Promise.scala:64)
	at java.base/java.util.concurrent.ForkJoinTask$RunnableExecuteAction.exec(ForkJoinTask.java:1395)
	at java.base/java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:373)
	at java.base/java.util.concurrent.ForkJoinPool$WorkQueue.topLevelExec(ForkJoinPool.java:1182)
	at java.base/java.util.concurrent.ForkJoinPool.scan(ForkJoinPool.java:1655)
	at java.base/java.util.concurrent.ForkJoinPool.runWorker(ForkJoinPool.java:1622)
	at java.base/java.util.concurrent.ForkJoinWorkerThread.run(ForkJoinWorkerThread.java:165)

Driver stacktrace:
	at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2844)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2780)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2779)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2779)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1242)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1242)
	at scala.Option.foreach(Option.scala:407)
	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1242)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:3048)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2982)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2971)
	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)
	at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:984)
	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2398)
	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2419)
	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2438)
	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2463)
	at org.apache.spark.rdd.RDD.$anonfun$collect$1(RDD.scala:1046)
	at org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:151)
	at org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:112)
	at org.apache.spark.rdd.RDD.withScope(RDD.scala:407)
	at org.apache.spark.rdd.RDD.collect(RDD.scala:1045)
	at org.apache.spark.sql.execution.datasources.SchemaMergeUtils$.mergeSchemasInParallel(SchemaMergeUtils.scala:73)
	at org.apache.spark.sql.execution.datasources.parquet.ParquetFileFormat$.mergeSchemasInParallel(ParquetFileFormat.scala:497)
	at org.apache.spark.sql.execution.datasources.parquet.ParquetUtils$.inferSchema(ParquetUtils.scala:132)
	at org.apache.spark.sql.execution.datasources.parquet.ParquetFileFormat.inferSchema(ParquetFileFormat.scala:79)
	at org.apache.spark.sql.execution.datasources.DataSource.$anonfun$getOrInferFileFormatSchema$11(DataSource.scala:208)
	at scala.Option.orElse(Option.scala:447)
	at org.apache.spark.sql.execution.datasources.DataSource.getOrInferFileFormatSchema(DataSource.scala:205)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:407)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:229)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$2(DataFrameReader.scala:211)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:211)
	at org.apache.spark.sql.DataFrameReader.parquet(DataFrameReader.scala:563)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: org.apache.spark.SparkException: Exception thrown in awaitResult: 
	at org.apache.spark.util.SparkThreadUtils$.awaitResult(SparkThreadUtils.scala:56)
	at org.apache.spark.util.ThreadUtils$.awaitResult(ThreadUtils.scala:310)
	at org.apache.spark.util.ThreadUtils$.parmap(ThreadUtils.scala:383)
	at org.apache.spark.sql.execution.datasources.parquet.ParquetFileFormat$.readParquetFootersInParallel(ParquetFileFormat.scala:443)
	at org.apache.spark.sql.execution.datasources.parquet.ParquetFileFormat$.$anonfun$mergeSchemasInParallel$1(ParquetFileFormat.scala:493)
	at org.apache.spark.sql.execution.datasources.parquet.ParquetFileFormat$.$anonfun$mergeSchemasInParallel$1$adapted(ParquetFileFormat.scala:485)
	at org.apache.spark.sql.execution.datasources.SchemaMergeUtils$.$anonfun$mergeSchemasInParallel$2(SchemaMergeUtils.scala:79)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitions$2(RDD.scala:855)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitions$2$adapted(RDD.scala:855)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)
	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)
	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:161)
	at org.apache.spark.scheduler.Task.run(Task.scala:141)
	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	... 1 more
Caused by: java.io.FileNotFoundException: File file:/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/src/data/gold/revenue_per_category_parquet/part-00000-d81387af-9386-4eba-aaf1-75ed20c0fc94-c000.snappy.parquet does not exist
	at org.apache.hadoop.fs.RawLocalFileSystem.deprecatedGetFileStatus(RawLocalFileSystem.java:779)
	at org.apache.hadoop.fs.RawLocalFileSystem.getFileLinkStatusInternal(RawLocalFileSystem.java:1100)
	at org.apache.hadoop.fs.RawLocalFileSystem.getFileStatus(RawLocalFileSystem.java:769)
	at org.apache.hadoop.fs.FilterFileSystem.getFileStatus(FilterFileSystem.java:462)
	at org.apache.hadoop.fs.ChecksumFileSystem$ChecksumFSInputChecker.<init>(ChecksumFileSystem.java:160)
	at org.apache.hadoop.fs.ChecksumFileSystem.open(ChecksumFileSystem.java:372)
	at org.apache.hadoop.fs.FileSystem.open(FileSystem.java:976)
	at org.apache.parquet.hadoop.util.HadoopInputFile.newStream(HadoopInputFile.java:69)
	at org.apache.parquet.hadoop.ParquetFileReader.<init>(ParquetFileReader.java:796)
	at org.apache.parquet.hadoop.ParquetFileReader.open(ParquetFileReader.java:666)
	at org.apache.spark.sql.execution.datasources.parquet.ParquetFooterReader.readFooter(ParquetFooterReader.java:85)
	at org.apache.spark.sql.execution.datasources.parquet.ParquetFooterReader.readFooter(ParquetFooterReader.java:76)
	at org.apache.spark.sql.execution.datasources.parquet.ParquetFileFormat$.$anonfun$readParquetFootersInParallel$1(ParquetFileFormat.scala:450)
	at org.apache.spark.util.ThreadUtils$.$anonfun$parmap$2(ThreadUtils.scala:380)
	at scala.concurrent.Future$.$anonfun$apply$1(Future.scala:659)
	at scala.util.Success.$anonfun$map$1(Try.scala:255)
	at scala.util.Success.map(Try.scala:213)
	at scala.concurrent.Future.$anonfun$map$1(Future.scala:292)
	at scala.concurrent.impl.Promise.liftedTree1$1(Promise.scala:33)
	at scala.concurrent.impl.Promise.$anonfun$transform$1(Promise.scala:33)
	at scala.concurrent.impl.CallbackRunnable.run(Promise.scala:64)
	at java.base/java.util.concurrent.ForkJoinTask$RunnableExecuteAction.exec(ForkJoinTask.java:1395)
	at java.base/java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:373)
	at java.base/java.util.concurrent.ForkJoinPool$WorkQueue.topLevelExec(ForkJoinPool.java:1182)
	at java.base/java.util.concurrent.ForkJoinPool.scan(ForkJoinPool.java:1655)
	at java.base/java.util.concurrent.ForkJoinPool.runWorker(ForkJoinPool.java:1622)
	at java.base/java.util.concurrent.ForkJoinWorkerThread.run(ForkJoinWorkerThread.java:165)

2024-12-19 13:18:05,786 - __main__ - INFO - Trying to read as parquet format...
2024-12-19 13:18:05,793 - __main__ - ERROR - Error in load_data: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2024-12-19 13:18:06,018 - __main__ - ERROR - Error in model training: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2024-12-19 13:18:06,018 - __main__ - ERROR - Error in main: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2024-12-19 13:18:06,067 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:18:17,738 - __main__ - INFO - Starting enhanced model training process...
2024-12-19 13:18:26,580 - __main__ - INFO - Successfully loaded tables:
2024-12-19 13:18:26,581 - __main__ - INFO - Revenue: (5, 6)
2024-12-19 13:18:26,581 - __main__ - INFO - Discount: (5, 7)
2024-12-19 13:18:26,581 - __main__ - INFO - Price Correlation: (5, 6)
2024-12-19 13:18:26,581 - __main__ - INFO - Reviews: (5, 7)
2024-12-19 13:18:26,581 - __main__ - INFO - Found categories: ['BLANKETS', 'MOBILE PHONE ACCESSORIES', 'MOTOR VEHICLE PARTS', 'NAIL CARE', 'UNDERWEAR']
2024-12-19 13:18:26,586 - __main__ - INFO - Final merged dataset shape: (5, 23)
2024-12-19 13:18:26,587 - __main__ - INFO - Available columns: ['Category', 'TotalRevenue', 'TotalSales', 'AveragePrice', 'ProductCount', 'AvgDiscountPercentage', 'AvgDiscountPercentage_disc', 'TotalDiscountedRevenue', 'PotentialRevenue', 'AvgSales', 'RevenueLossFromDiscount', 'DiscountROI', 'PriceRatingCorrelation', 'AvgPrice', 'AvgRating', 'AvgReviews', 'PriceRatingRelationship', 'TotalReviews', 'TotalSales_review', 'AvgRating_review', 'HighRatingCount', 'ReviewToSalesRatio', 'CustomerEngagementLevel']
2024-12-19 13:18:27,103 - __main__ - INFO - Created advanced features. Shape: (5, 44)
2024-12-19 13:18:27,103 - __main__ - INFO - Number of numeric features: 23
2024-12-19 13:18:27,103 - __main__ - INFO - Number of categorical features: 3
2024-12-19 13:18:27,106 - __main__ - INFO - Training stacked model...
2024-12-19 13:18:27,149 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:18:27,159 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:18:27,164 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:18:27,168 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:18:27,174 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:18:27,181 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:18:27,188 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:18:27,195 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:18:27,208 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:18:27,210 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:18:27,217 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:18:27,245 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:18:27,245 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:18:27,247 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:18:27,265 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:18:27,286 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:18:27,305 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:18:28,588 - __main__ - ERROR - Error in model training: Cannot have number of splits n_splits=5 greater than the number of samples: n_samples=4.
2024-12-19 13:18:28,589 - __main__ - ERROR - Error in main: Cannot have number of splits n_splits=5 greater than the number of samples: n_samples=4.
2024-12-19 13:18:28,592 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:18:33,135 - __main__ - INFO - Starting enhanced model training process...
2024-12-19 13:18:43,589 - __main__ - INFO - Successfully loaded tables:
2024-12-19 13:18:43,590 - __main__ - INFO - Revenue: (5, 6)
2024-12-19 13:18:43,590 - __main__ - INFO - Discount: (5, 7)
2024-12-19 13:18:43,590 - __main__ - INFO - Price Correlation: (5, 6)
2024-12-19 13:18:43,590 - __main__ - INFO - Reviews: (5, 7)
2024-12-19 13:18:43,590 - __main__ - INFO - Found categories: ['BLANKETS', 'MOBILE PHONE ACCESSORIES', 'MOTOR VEHICLE PARTS', 'NAIL CARE', 'UNDERWEAR']
2024-12-19 13:18:43,596 - __main__ - INFO - Final merged dataset shape: (5, 23)
2024-12-19 13:18:43,597 - __main__ - INFO - Available columns: ['Category', 'TotalRevenue', 'TotalSales', 'AveragePrice', 'ProductCount', 'AvgDiscountPercentage', 'AvgDiscountPercentage_disc', 'TotalDiscountedRevenue', 'PotentialRevenue', 'AvgSales', 'RevenueLossFromDiscount', 'DiscountROI', 'PriceRatingCorrelation', 'AvgPrice', 'AvgRating', 'AvgReviews', 'PriceRatingRelationship', 'TotalReviews', 'TotalSales_review', 'AvgRating_review', 'HighRatingCount', 'ReviewToSalesRatio', 'CustomerEngagementLevel']
2024-12-19 13:18:43,674 - __main__ - INFO - Created advanced features. Shape: (5, 44)
2024-12-19 13:18:43,674 - __main__ - INFO - Number of numeric features: 23
2024-12-19 13:18:43,674 - __main__ - INFO - Number of categorical features: 3
2024-12-19 13:18:43,680 - __main__ - INFO - Training stacked model...
2024-12-19 13:18:43,714 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:18:43,726 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:18:43,732 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:18:43,744 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:18:43,751 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:18:43,757 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:18:43,764 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:18:43,771 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:18:43,779 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:18:43,788 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:18:43,797 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:18:43,809 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:18:43,855 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:18:43,863 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:18:43,886 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:18:43,918 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:18:43,935 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:18:44,105 - py4j.clientserver - INFO - Error while sending or receiving.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer
2024-12-19 13:18:44,112 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:18:44,113 - root - INFO - Exception while sending command.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 506, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending
2024-12-19 13:18:44,138 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:18:45,459 - __main__ - ERROR - Error in model training: Cannot have number of splits n_splits=5 greater than the number of samples: n_samples=4.
2024-12-19 13:18:45,459 - __main__ - ERROR - Error in main: Cannot have number of splits n_splits=5 greater than the number of samples: n_samples=4.
2024-12-19 13:18:45,461 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:18:54,298 - __main__ - INFO - Starting enhanced model training process...
2024-12-19 13:19:04,533 - __main__ - INFO - Successfully loaded tables:
2024-12-19 13:19:04,533 - __main__ - INFO - Revenue: (5, 6)
2024-12-19 13:19:04,533 - __main__ - INFO - Discount: (5, 7)
2024-12-19 13:19:04,533 - __main__ - INFO - Price Correlation: (5, 6)
2024-12-19 13:19:04,534 - __main__ - INFO - Reviews: (5, 7)
2024-12-19 13:19:04,534 - __main__ - INFO - Found categories: ['BLANKETS', 'MOBILE PHONE ACCESSORIES', 'MOTOR VEHICLE PARTS', 'NAIL CARE', 'UNDERWEAR']
2024-12-19 13:19:04,539 - __main__ - INFO - Final merged dataset shape: (5, 23)
2024-12-19 13:19:04,540 - __main__ - INFO - Available columns: ['Category', 'TotalRevenue', 'TotalSales', 'AveragePrice', 'ProductCount', 'AvgDiscountPercentage', 'AvgDiscountPercentage_disc', 'TotalDiscountedRevenue', 'PotentialRevenue', 'AvgSales', 'RevenueLossFromDiscount', 'DiscountROI', 'PriceRatingCorrelation', 'AvgPrice', 'AvgRating', 'AvgReviews', 'PriceRatingRelationship', 'TotalReviews', 'TotalSales_review', 'AvgRating_review', 'HighRatingCount', 'ReviewToSalesRatio', 'CustomerEngagementLevel']
2024-12-19 13:19:04,865 - __main__ - INFO - Created advanced features. Shape: (5, 44)
2024-12-19 13:19:04,865 - __main__ - INFO - Number of numeric features: 23
2024-12-19 13:19:04,865 - __main__ - INFO - Number of categorical features: 3
2024-12-19 13:19:04,868 - __main__ - INFO - Training stacked model...
2024-12-19 13:19:04,903 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:19:04,916 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:19:04,922 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:19:04,928 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:19:04,935 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:19:04,941 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:19:04,947 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:19:04,957 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:19:04,966 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:19:04,980 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:19:04,985 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:19:05,002 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:19:05,019 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:19:05,025 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:19:05,075 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:19:05,077 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:19:05,096 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:19:06,740 - py4j.clientserver - INFO - Error while sending or receiving.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer
2024-12-19 13:19:06,742 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:19:06,742 - root - INFO - Exception while sending command.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 506, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending
2024-12-19 13:19:06,746 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:19:08,008 - __main__ - ERROR - Error in model training: Cannot have number of splits n_splits=5 greater than the number of samples: n_samples=4.
2024-12-19 13:19:08,009 - __main__ - ERROR - Error in main: Cannot have number of splits n_splits=5 greater than the number of samples: n_samples=4.
2024-12-19 13:19:08,012 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:19:10,550 - __main__ - INFO - Starting enhanced model training process...
2024-12-19 13:19:24,343 - __main__ - INFO - Successfully loaded tables:
2024-12-19 13:19:24,343 - __main__ - INFO - Revenue: (8, 6)
2024-12-19 13:19:24,343 - __main__ - INFO - Discount: (8, 7)
2024-12-19 13:19:24,343 - __main__ - INFO - Price Correlation: (5, 6)
2024-12-19 13:19:24,344 - __main__ - INFO - Reviews: (5, 7)
2024-12-19 13:19:24,344 - __main__ - INFO - Found categories: ['BLANKETS', 'CLOTHING', 'ELECTRONICS', 'HOME & KITCHEN', 'MOBILE PHONE ACCESSORIES', 'MOTOR VEHICLE PARTS', 'NAIL CARE', 'UNDERWEAR']
2024-12-19 13:19:24,350 - __main__ - INFO - Final merged dataset shape: (5, 23)
2024-12-19 13:19:24,350 - __main__ - INFO - Available columns: ['Category', 'TotalRevenue', 'TotalSales', 'AveragePrice', 'ProductCount', 'AvgDiscountPercentage', 'AvgDiscountPercentage_disc', 'TotalDiscountedRevenue', 'PotentialRevenue', 'AvgSales', 'RevenueLossFromDiscount', 'DiscountROI', 'PriceRatingCorrelation', 'AvgPrice', 'AvgRating', 'AvgReviews', 'PriceRatingRelationship', 'TotalReviews', 'TotalSales_review', 'AvgRating_review', 'HighRatingCount', 'ReviewToSalesRatio', 'CustomerEngagementLevel']
2024-12-19 13:19:24,655 - __main__ - INFO - Created advanced features. Shape: (5, 44)
2024-12-19 13:19:24,655 - __main__ - INFO - Number of numeric features: 23
2024-12-19 13:19:24,655 - __main__ - INFO - Number of categorical features: 3
2024-12-19 13:19:24,659 - __main__ - INFO - Training stacked model...
2024-12-19 13:19:24,700 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:19:24,714 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:19:24,721 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:19:24,730 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:19:24,738 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:19:24,746 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:19:24,754 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:19:24,762 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:19:24,770 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:19:24,784 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:19:24,793 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:19:24,802 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:19:24,815 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:19:24,830 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:19:24,842 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:19:24,848 - py4j.clientserver - INFO - Error while sending or receiving.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer
2024-12-19 13:19:24,851 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:19:24,851 - root - INFO - Exception while sending command.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 506, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending
2024-12-19 13:19:24,854 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:19:24,854 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:19:24,920 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:19:25,856 - py4j.clientserver - INFO - Error while sending or receiving.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer
2024-12-19 13:19:25,857 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:19:25,857 - root - INFO - Exception while sending command.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 506, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending
2024-12-19 13:19:25,859 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:19:26,796 - __main__ - ERROR - Error in model training: Cannot have number of splits n_splits=5 greater than the number of samples: n_samples=4.
2024-12-19 13:19:26,797 - __main__ - ERROR - Error in main: Cannot have number of splits n_splits=5 greater than the number of samples: n_samples=4.
2024-12-19 13:19:26,800 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:19:31,605 - __main__ - INFO - Starting enhanced model training process...
2024-12-19 13:19:39,506 - __main__ - INFO - Successfully loaded tables:
2024-12-19 13:19:39,506 - __main__ - INFO - Revenue: (8, 6)
2024-12-19 13:19:39,506 - __main__ - INFO - Discount: (8, 7)
2024-12-19 13:19:39,506 - __main__ - INFO - Price Correlation: (8, 6)
2024-12-19 13:19:39,506 - __main__ - INFO - Reviews: (8, 7)
2024-12-19 13:19:39,507 - __main__ - INFO - Found categories: ['BLANKETS', 'CLOTHING', 'ELECTRONICS', 'HOME & KITCHEN', 'MOBILE PHONE ACCESSORIES', 'MOTOR VEHICLE PARTS', 'NAIL CARE', 'UNDERWEAR']
2024-12-19 13:19:39,512 - __main__ - INFO - Final merged dataset shape: (8, 23)
2024-12-19 13:19:39,512 - __main__ - INFO - Available columns: ['Category', 'TotalRevenue', 'TotalSales', 'AveragePrice', 'ProductCount', 'AvgDiscountPercentage', 'AvgDiscountPercentage_disc', 'TotalDiscountedRevenue', 'PotentialRevenue', 'AvgSales', 'RevenueLossFromDiscount', 'DiscountROI', 'PriceRatingCorrelation', 'AvgPrice', 'AvgRating', 'AvgReviews', 'PriceRatingRelationship', 'TotalReviews', 'TotalSales_review', 'AvgRating_review', 'HighRatingCount', 'ReviewToSalesRatio', 'CustomerEngagementLevel']
2024-12-19 13:19:39,770 - __main__ - INFO - Created advanced features. Shape: (8, 44)
2024-12-19 13:19:39,771 - __main__ - INFO - Number of numeric features: 23
2024-12-19 13:19:39,771 - __main__ - INFO - Number of categorical features: 3
2024-12-19 13:19:39,775 - __main__ - INFO - Training stacked model...
2024-12-19 13:19:39,812 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:19:39,828 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:19:39,834 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:19:39,842 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:19:39,850 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:19:39,859 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:19:39,869 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:19:39,878 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:19:39,885 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:19:39,904 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:19:39,910 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:19:39,924 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:19:39,930 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:19:39,946 - py4j.clientserver - INFO - Error while sending or receiving.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer
2024-12-19 13:19:39,949 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:19:39,950 - root - INFO - Exception while sending command.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 506, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending
2024-12-19 13:19:39,950 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:19:39,950 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:19:40,006 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:19:43,319 - __main__ - INFO - Model Performance:
2024-12-19 13:19:43,319 - __main__ - INFO - RÂ² score: -2.2568
2024-12-19 13:19:43,319 - __main__ - INFO - MSE: 211770.3001
2024-12-19 13:19:43,320 - __main__ - INFO - RMSE: 460.1851
2024-12-19 13:19:43,320 - __main__ - INFO - MAE: 426.0124
2024-12-19 13:19:43,322 - __main__ - WARNING - Feature importance length mismatch: 3 vs 36
2024-12-19 13:19:43,325 - __main__ - INFO - 
Top 10 Most Important Features:
2024-12-19 13:19:43,326 - __main__ - INFO -                  feature  importance  importance_percentage
0           AveragePrice    0.992132              99.213177
1  AvgDiscountPercentage    0.005227               0.522700
2              AvgRating    0.002641               0.264123
2024-12-19 13:19:43,550 - __main__ - INFO - Model saved to /home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/src/models/training/trained_models/sales_predictor.joblib
2024-12-19 13:19:44,144 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:20:32,823 - __main__ - INFO - Starting enhanced model training process...
2024-12-19 13:20:41,587 - __main__ - INFO - Successfully loaded tables:
2024-12-19 13:20:41,587 - __main__ - INFO - Revenue: (10, 6)
2024-12-19 13:20:41,587 - __main__ - INFO - Discount: (10, 7)
2024-12-19 13:20:41,588 - __main__ - INFO - Price Correlation: (10, 6)
2024-12-19 13:20:41,588 - __main__ - INFO - Reviews: (10, 7)
2024-12-19 13:20:41,588 - __main__ - INFO - Found categories: ['BLANKETS', 'BOOKS', 'CLOTHING', 'ELECTRONICS', 'HOME & KITCHEN', 'MOBILE PHONE ACCESSORIES', 'MOTOR VEHICLE PARTS', 'NAIL CARE', 'TOYS & GAMES', 'UNDERWEAR']
2024-12-19 13:20:41,594 - __main__ - INFO - Final merged dataset shape: (10, 23)
2024-12-19 13:20:41,594 - __main__ - INFO - Available columns: ['Category', 'TotalRevenue', 'TotalSales', 'AveragePrice', 'ProductCount', 'AvgDiscountPercentage', 'AvgDiscountPercentage_disc', 'TotalDiscountedRevenue', 'PotentialRevenue', 'AvgSales', 'RevenueLossFromDiscount', 'DiscountROI', 'PriceRatingCorrelation', 'AvgPrice', 'AvgRating', 'AvgReviews', 'PriceRatingRelationship', 'TotalReviews', 'TotalSales_review', 'AvgRating_review', 'HighRatingCount', 'ReviewToSalesRatio', 'CustomerEngagementLevel']
2024-12-19 13:20:41,962 - __main__ - INFO - Created advanced features. Shape: (10, 44)
2024-12-19 13:20:41,962 - __main__ - INFO - Number of numeric features: 23
2024-12-19 13:20:41,962 - __main__ - INFO - Number of categorical features: 3
2024-12-19 13:20:41,964 - __main__ - INFO - Training stacked model...
2024-12-19 13:20:41,997 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:20:42,010 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:20:42,015 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:20:42,022 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:20:42,029 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:20:42,036 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:20:42,042 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:20:42,048 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:20:42,057 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:20:42,064 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:20:42,072 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:20:42,079 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:20:42,102 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:20:42,105 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:20:42,121 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:20:42,124 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:20:42,129 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:20:42,505 - py4j.clientserver - INFO - Error while sending or receiving.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer
2024-12-19 13:20:42,506 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:20:42,506 - root - INFO - Exception while sending command.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 506, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending
2024-12-19 13:20:42,510 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:20:44,815 - __main__ - INFO - Model Performance:
2024-12-19 13:20:44,816 - __main__ - INFO - RÂ² score: -6.5263
2024-12-19 13:20:44,816 - __main__ - INFO - MSE: 611321.8769
2024-12-19 13:20:44,816 - __main__ - INFO - RMSE: 781.8708
2024-12-19 13:20:44,816 - __main__ - INFO - MAE: 663.6911
2024-12-19 13:20:44,816 - __main__ - WARNING - Feature importance length mismatch: 3 vs 38
2024-12-19 13:20:44,818 - __main__ - INFO - 
Top 10 Most Important Features:
2024-12-19 13:20:44,818 - __main__ - INFO -                  feature  importance  importance_percentage
0           AveragePrice    0.876891              87.689075
2              AvgRating    0.101835              10.183456
1  AvgDiscountPercentage    0.021275               2.127469
2024-12-19 13:20:44,931 - __main__ - INFO - Model saved to /home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/src/models/training/trained_models/sales_predictor.joblib
2024-12-19 13:20:45,306 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:20:50,776 - __main__ - INFO - Starting enhanced model training process...
2024-12-19 13:21:05,060 - __main__ - INFO - Successfully loaded tables:
2024-12-19 13:21:05,061 - __main__ - INFO - Revenue: (10, 6)
2024-12-19 13:21:05,061 - __main__ - INFO - Discount: (10, 7)
2024-12-19 13:21:05,061 - __main__ - INFO - Price Correlation: (10, 6)
2024-12-19 13:21:05,061 - __main__ - INFO - Reviews: (10, 7)
2024-12-19 13:21:05,061 - __main__ - INFO - Found categories: ['BLANKETS', 'BOOKS', 'CLOTHING', 'ELECTRONICS', 'HOME & KITCHEN', 'MOBILE PHONE ACCESSORIES', 'MOTOR VEHICLE PARTS', 'NAIL CARE', 'TOYS & GAMES', 'UNDERWEAR']
2024-12-19 13:21:05,067 - __main__ - INFO - Final merged dataset shape: (10, 23)
2024-12-19 13:21:05,067 - __main__ - INFO - Available columns: ['Category', 'TotalRevenue', 'TotalSales', 'AveragePrice', 'ProductCount', 'AvgDiscountPercentage', 'AvgDiscountPercentage_disc', 'TotalDiscountedRevenue', 'PotentialRevenue', 'AvgSales', 'RevenueLossFromDiscount', 'DiscountROI', 'PriceRatingCorrelation', 'AvgPrice', 'AvgRating', 'AvgReviews', 'PriceRatingRelationship', 'TotalReviews', 'TotalSales_review', 'AvgRating_review', 'HighRatingCount', 'ReviewToSalesRatio', 'CustomerEngagementLevel']
2024-12-19 13:21:05,462 - __main__ - INFO - Created advanced features. Shape: (10, 44)
2024-12-19 13:21:05,463 - __main__ - INFO - Number of numeric features: 23
2024-12-19 13:21:05,463 - __main__ - INFO - Number of categorical features: 3
2024-12-19 13:21:05,467 - __main__ - INFO - Training stacked model...
2024-12-19 13:21:05,503 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:21:05,517 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:21:05,523 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:21:05,530 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:21:05,537 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:21:05,545 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:21:05,553 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:21:05,561 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:21:05,569 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:21:05,577 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:21:05,586 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:21:05,596 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:21:05,605 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:21:05,631 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:21:05,651 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:21:05,664 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:21:05,689 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:21:07,091 - py4j.clientserver - INFO - Error while sending or receiving.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer
2024-12-19 13:21:07,092 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:21:07,092 - root - INFO - Exception while sending command.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 506, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending
2024-12-19 13:21:07,095 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:21:08,747 - __main__ - INFO - Model Performance:
2024-12-19 13:21:08,748 - __main__ - INFO - RÂ² score: -6.5263
2024-12-19 13:21:08,748 - __main__ - INFO - MSE: 611321.8769
2024-12-19 13:21:08,748 - __main__ - INFO - RMSE: 781.8708
2024-12-19 13:21:08,748 - __main__ - INFO - MAE: 663.6911
2024-12-19 13:21:08,749 - __main__ - WARNING - Feature importance length mismatch: 3 vs 38
2024-12-19 13:21:08,751 - __main__ - INFO - 
Top 10 Most Important Features:
2024-12-19 13:21:08,751 - __main__ - INFO -                  feature  importance  importance_percentage
0           AveragePrice    0.876891              87.689075
2              AvgRating    0.101835              10.183456
1  AvgDiscountPercentage    0.021275               2.127469
2024-12-19 13:21:08,889 - __main__ - INFO - Model saved to /home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/src/models/training/trained_models/sales_predictor.joblib
2024-12-19 13:21:09,275 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:21:41,273 - __main__ - INFO - Starting enhanced model training process...
2024-12-19 13:21:49,118 - __main__ - INFO - Successfully loaded tables:
2024-12-19 13:21:49,119 - __main__ - INFO - Revenue: (13, 6)
2024-12-19 13:21:49,119 - __main__ - INFO - Discount: (13, 7)
2024-12-19 13:21:49,119 - __main__ - INFO - Price Correlation: (13, 6)
2024-12-19 13:21:49,119 - __main__ - INFO - Reviews: (13, 7)
2024-12-19 13:21:49,119 - __main__ - INFO - Found categories: ['BLANKETS', 'BOOKS', 'CLOTHING', 'ELECTRONICS', 'HOME & KITCHEN', 'MAKEUP', 'MOBILE PHONE ACCESSORIES', 'MOTOR VEHICLE PARTS', 'NAIL CARE', 'SKIN CARE', 'TOYS & GAMES', 'UNDERWEAR', 'VITAMINS AND SUPPLEMENTS']
2024-12-19 13:21:49,125 - __main__ - INFO - Final merged dataset shape: (13, 23)
2024-12-19 13:21:49,125 - __main__ - INFO - Available columns: ['Category', 'TotalRevenue', 'TotalSales', 'AveragePrice', 'ProductCount', 'AvgDiscountPercentage', 'AvgDiscountPercentage_disc', 'TotalDiscountedRevenue', 'PotentialRevenue', 'AvgSales', 'RevenueLossFromDiscount', 'DiscountROI', 'PriceRatingCorrelation', 'AvgPrice', 'AvgRating', 'AvgReviews', 'PriceRatingRelationship', 'TotalReviews', 'TotalSales_review', 'AvgRating_review', 'HighRatingCount', 'ReviewToSalesRatio', 'CustomerEngagementLevel']
2024-12-19 13:21:49,270 - __main__ - INFO - Created advanced features. Shape: (13, 44)
2024-12-19 13:21:49,270 - __main__ - INFO - Number of numeric features: 23
2024-12-19 13:21:49,270 - __main__ - INFO - Number of categorical features: 3
2024-12-19 13:21:49,273 - __main__ - INFO - Training stacked model...
2024-12-19 13:21:49,302 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:21:49,315 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:21:49,321 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:21:49,327 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:21:49,334 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:21:49,342 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:21:49,349 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:21:49,356 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:21:49,364 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:21:49,372 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:21:49,382 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:21:49,407 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:21:49,423 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:21:49,425 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:21:49,427 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:21:49,432 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:21:49,467 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:21:49,828 - py4j.clientserver - INFO - Error while sending or receiving.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer
2024-12-19 13:21:49,830 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:21:49,830 - root - INFO - Exception while sending command.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 506, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending
2024-12-19 13:21:49,837 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:21:52,207 - __main__ - INFO - Model Performance:
2024-12-19 13:21:52,207 - __main__ - INFO - RÂ² score: -382.1244
2024-12-19 13:21:52,207 - __main__ - INFO - MSE: 7083544.9982
2024-12-19 13:21:52,207 - __main__ - INFO - RMSE: 2661.4930
2024-12-19 13:21:52,207 - __main__ - INFO - MAE: 2061.1841
2024-12-19 13:21:52,208 - __main__ - WARNING - Feature importance length mismatch: 3 vs 41
2024-12-19 13:21:52,209 - __main__ - INFO - 
Top 10 Most Important Features:
2024-12-19 13:21:52,209 - __main__ - INFO -                  feature  importance  importance_percentage
0           AveragePrice    0.569925              56.992526
2              AvgRating    0.397162              39.716232
1  AvgDiscountPercentage    0.032912               3.291242
2024-12-19 13:21:52,317 - __main__ - INFO - Model saved to /home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/src/models/training/trained_models/sales_predictor.joblib
2024-12-19 13:21:52,641 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:21:59,305 - __main__ - INFO - Starting enhanced model training process...
2024-12-19 13:22:13,798 - __main__ - INFO - Successfully loaded tables:
2024-12-19 13:22:13,799 - __main__ - INFO - Revenue: (13, 6)
2024-12-19 13:22:13,799 - __main__ - INFO - Discount: (13, 7)
2024-12-19 13:22:13,799 - __main__ - INFO - Price Correlation: (13, 6)
2024-12-19 13:22:13,799 - __main__ - INFO - Reviews: (13, 7)
2024-12-19 13:22:13,800 - __main__ - INFO - Found categories: ['BLANKETS', 'BOOKS', 'CLOTHING', 'ELECTRONICS', 'HOME & KITCHEN', 'MAKEUP', 'MOBILE PHONE ACCESSORIES', 'MOTOR VEHICLE PARTS', 'NAIL CARE', 'SKIN CARE', 'TOYS & GAMES', 'UNDERWEAR', 'VITAMINS AND SUPPLEMENTS']
2024-12-19 13:22:13,809 - __main__ - INFO - Final merged dataset shape: (13, 23)
2024-12-19 13:22:13,810 - __main__ - INFO - Available columns: ['Category', 'TotalRevenue', 'TotalSales', 'AveragePrice', 'ProductCount', 'AvgDiscountPercentage', 'AvgDiscountPercentage_disc', 'TotalDiscountedRevenue', 'PotentialRevenue', 'AvgSales', 'RevenueLossFromDiscount', 'DiscountROI', 'PriceRatingCorrelation', 'AvgPrice', 'AvgRating', 'AvgReviews', 'PriceRatingRelationship', 'TotalReviews', 'TotalSales_review', 'AvgRating_review', 'HighRatingCount', 'ReviewToSalesRatio', 'CustomerEngagementLevel']
2024-12-19 13:22:14,276 - __main__ - INFO - Created advanced features. Shape: (13, 44)
2024-12-19 13:22:14,277 - __main__ - INFO - Number of numeric features: 23
2024-12-19 13:22:14,277 - __main__ - INFO - Number of categorical features: 3
2024-12-19 13:22:14,280 - __main__ - INFO - Training stacked model...
2024-12-19 13:22:14,325 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:22:14,327 - py4j.clientserver - INFO - Error while receiving.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 516, in send_command
    raise Py4JNetworkError("Answer from Java side is empty")
py4j.protocol.Py4JNetworkError: Answer from Java side is empty
2024-12-19 13:22:14,335 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:22:14,336 - root - ERROR - Exception while sending command.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 516, in send_command
    raise Py4JNetworkError("Answer from Java side is empty")
py4j.protocol.Py4JNetworkError: Answer from Java side is empty

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 539, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending or receiving
2024-12-19 13:22:14,338 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:22:14,471 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:22:14,494 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:22:14,502 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:22:14,511 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:22:14,545 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:22:14,611 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:22:14,632 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:22:14,652 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:22:14,685 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:22:14,698 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:22:16,456 - py4j.clientserver - INFO - Error while sending or receiving.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer
2024-12-19 13:22:16,457 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:22:16,457 - root - INFO - Exception while sending command.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 506, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending
2024-12-19 13:22:16,459 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:22:18,364 - __main__ - INFO - Model Performance:
2024-12-19 13:22:18,364 - __main__ - INFO - RÂ² score: -382.1244
2024-12-19 13:22:18,364 - __main__ - INFO - MSE: 7083544.9982
2024-12-19 13:22:18,364 - __main__ - INFO - RMSE: 2661.4930
2024-12-19 13:22:18,365 - __main__ - INFO - MAE: 2061.1841
2024-12-19 13:22:18,366 - __main__ - WARNING - Feature importance length mismatch: 3 vs 41
2024-12-19 13:22:18,368 - __main__ - INFO - 
Top 10 Most Important Features:
2024-12-19 13:22:18,368 - __main__ - INFO -                  feature  importance  importance_percentage
0           AveragePrice    0.569925              56.992526
2              AvgRating    0.397162              39.716232
1  AvgDiscountPercentage    0.032912               3.291242
2024-12-19 13:22:18,489 - __main__ - INFO - Model saved to /home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/src/models/training/trained_models/sales_predictor.joblib
2024-12-19 13:22:18,906 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:22:53,901 - __main__ - INFO - Starting enhanced model training process...
2024-12-19 13:23:05,170 - __main__ - INFO - Successfully loaded tables:
2024-12-19 13:23:05,170 - __main__ - INFO - Revenue: (13, 6)
2024-12-19 13:23:05,171 - __main__ - INFO - Discount: (13, 7)
2024-12-19 13:23:05,171 - __main__ - INFO - Price Correlation: (13, 6)
2024-12-19 13:23:05,171 - __main__ - INFO - Reviews: (13, 7)
2024-12-19 13:23:05,171 - __main__ - INFO - Found categories: ['BLANKETS', 'BOOKS', 'CLOTHING', 'ELECTRONICS', 'HOME & KITCHEN', 'MAKEUP', 'MOBILE PHONE ACCESSORIES', 'MOTOR VEHICLE PARTS', 'NAIL CARE', 'SKIN CARE', 'TOYS & GAMES', 'UNDERWEAR', 'VITAMINS AND SUPPLEMENTS']
2024-12-19 13:23:05,177 - __main__ - INFO - Final merged dataset shape: (13, 23)
2024-12-19 13:23:05,178 - __main__ - INFO - Available columns: ['Category', 'TotalRevenue', 'TotalSales', 'AveragePrice', 'ProductCount', 'AvgDiscountPercentage', 'AvgDiscountPercentage_disc', 'TotalDiscountedRevenue', 'PotentialRevenue', 'AvgSales', 'RevenueLossFromDiscount', 'DiscountROI', 'PriceRatingCorrelation', 'AvgPrice', 'AvgRating', 'AvgReviews', 'PriceRatingRelationship', 'TotalReviews', 'TotalSales_review', 'AvgRating_review', 'HighRatingCount', 'ReviewToSalesRatio', 'CustomerEngagementLevel']
2024-12-19 13:23:05,376 - __main__ - INFO - Created advanced features. Shape: (13, 44)
2024-12-19 13:23:05,376 - __main__ - INFO - Number of numeric features: 23
2024-12-19 13:23:05,376 - __main__ - INFO - Number of categorical features: 3
2024-12-19 13:23:05,378 - __main__ - INFO - Training stacked model...
2024-12-19 13:23:05,410 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:23:05,421 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:23:05,426 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:23:05,432 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:23:05,439 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:23:05,447 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:23:05,454 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:23:05,461 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:23:05,469 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:23:05,488 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:23:05,493 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:23:05,502 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:23:05,504 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:23:05,524 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:23:05,544 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:23:05,567 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:23:05,582 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:23:05,675 - py4j.clientserver - INFO - Error while sending or receiving.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer
2024-12-19 13:23:05,683 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:23:05,683 - root - INFO - Exception while sending command.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 506, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending
2024-12-19 13:23:05,714 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:23:08,665 - __main__ - INFO - Model Performance:
2024-12-19 13:23:08,665 - __main__ - INFO - RÂ² score: -382.1244
2024-12-19 13:23:08,665 - __main__ - INFO - MSE: 7083544.9982
2024-12-19 13:23:08,666 - __main__ - INFO - RMSE: 2661.4930
2024-12-19 13:23:08,666 - __main__ - INFO - MAE: 2061.1841
2024-12-19 13:23:08,667 - __main__ - WARNING - Feature importance length mismatch: 3 vs 41
2024-12-19 13:23:08,670 - __main__ - INFO - 
Top 10 Most Important Features:
2024-12-19 13:23:08,670 - __main__ - INFO -                  feature  importance  importance_percentage
0           AveragePrice    0.569925              56.992526
2              AvgRating    0.397162              39.716232
1  AvgDiscountPercentage    0.032912               3.291242
2024-12-19 13:23:08,817 - __main__ - INFO - Model saved to /home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/src/models/training/trained_models/sales_predictor.joblib
2024-12-19 13:23:09,335 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:24:07,343 - __main__ - INFO - Starting enhanced model training process...
2024-12-19 13:24:17,781 - __main__ - INFO - Successfully loaded tables:
2024-12-19 13:24:17,781 - __main__ - INFO - Revenue: (13, 6)
2024-12-19 13:24:17,781 - __main__ - INFO - Discount: (13, 7)
2024-12-19 13:24:17,781 - __main__ - INFO - Price Correlation: (13, 6)
2024-12-19 13:24:17,781 - __main__ - INFO - Reviews: (13, 7)
2024-12-19 13:24:17,782 - __main__ - INFO - Found categories: ['BLANKETS', 'BOOKS', 'CLOTHING', 'ELECTRONICS', 'HOME & KITCHEN', 'MAKEUP', 'MOBILE PHONE ACCESSORIES', 'MOTOR VEHICLE PARTS', 'NAIL CARE', 'SKIN CARE', 'TOYS & GAMES', 'UNDERWEAR', 'VITAMINS AND SUPPLEMENTS']
2024-12-19 13:24:17,789 - __main__ - INFO - Final merged dataset shape: (13, 23)
2024-12-19 13:24:17,789 - __main__ - INFO - Available columns: ['Category', 'TotalRevenue', 'TotalSales', 'AveragePrice', 'ProductCount', 'AvgDiscountPercentage', 'AvgDiscountPercentage_disc', 'TotalDiscountedRevenue', 'PotentialRevenue', 'AvgSales', 'RevenueLossFromDiscount', 'DiscountROI', 'PriceRatingCorrelation', 'AvgPrice', 'AvgRating', 'AvgReviews', 'PriceRatingRelationship', 'TotalReviews', 'TotalSales_review', 'AvgRating_review', 'HighRatingCount', 'ReviewToSalesRatio', 'CustomerEngagementLevel']
2024-12-19 13:24:17,998 - __main__ - INFO - Created advanced features. Shape: (13, 44)
2024-12-19 13:24:17,998 - __main__ - INFO - Number of numeric features: 23
2024-12-19 13:24:17,998 - __main__ - INFO - Number of categorical features: 3
2024-12-19 13:24:18,002 - __main__ - INFO - Training stacked model...
2024-12-19 13:24:18,057 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:24:18,079 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:24:18,086 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:24:18,094 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:24:18,103 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:24:18,112 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:24:18,122 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:24:18,143 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:24:18,145 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:24:18,153 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:24:18,174 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:24:18,183 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:24:18,193 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:24:18,203 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:24:18,213 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:24:18,234 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:24:18,234 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:24:18,584 - py4j.clientserver - INFO - Error while sending or receiving.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer
2024-12-19 13:24:18,586 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:24:18,586 - root - INFO - Exception while sending command.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 506, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending
2024-12-19 13:24:18,606 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:24:23,426 - __main__ - INFO - Model Performance:
2024-12-19 13:24:23,426 - __main__ - INFO - RÂ² score: -382.1244
2024-12-19 13:24:23,426 - __main__ - INFO - MSE: 7083544.9982
2024-12-19 13:24:23,426 - __main__ - INFO - RMSE: 2661.4930
2024-12-19 13:24:23,426 - __main__ - INFO - MAE: 2061.1841
2024-12-19 13:24:23,427 - __main__ - WARNING - Feature importance length mismatch: 3 vs 41
2024-12-19 13:24:23,429 - __main__ - INFO - 
Top 10 Most Important Features:
2024-12-19 13:24:23,429 - __main__ - INFO -                  feature  importance  importance_percentage
0           AveragePrice    0.569925              56.992526
2              AvgRating    0.397162              39.716232
1  AvgDiscountPercentage    0.032912               3.291242
2024-12-19 13:24:23,582 - __main__ - INFO - Model saved to /home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/src/models/training/trained_models/sales_predictor.joblib
2024-12-19 13:24:23,998 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:25:08,497 - __main__ - INFO - Starting enhanced model training process...
2024-12-19 13:25:16,402 - __main__ - INFO - Successfully loaded tables:
2024-12-19 13:25:16,402 - __main__ - INFO - Revenue: (13, 6)
2024-12-19 13:25:16,402 - __main__ - INFO - Discount: (13, 7)
2024-12-19 13:25:16,402 - __main__ - INFO - Price Correlation: (13, 6)
2024-12-19 13:25:16,402 - __main__ - INFO - Reviews: (13, 7)
2024-12-19 13:25:16,403 - __main__ - INFO - Found categories: ['BLANKETS', 'BOOKS', 'CLOTHING', 'ELECTRONICS', 'HOME & KITCHEN', 'MAKEUP', 'MOBILE PHONE ACCESSORIES', 'MOTOR VEHICLE PARTS', 'NAIL CARE', 'SKIN CARE', 'TOYS & GAMES', 'UNDERWEAR', 'VITAMINS AND SUPPLEMENTS']
2024-12-19 13:25:16,412 - __main__ - INFO - Final merged dataset shape: (13, 23)
2024-12-19 13:25:16,412 - __main__ - INFO - Available columns: ['Category', 'TotalRevenue', 'TotalSales', 'AveragePrice', 'ProductCount', 'AvgDiscountPercentage', 'AvgDiscountPercentage_disc', 'TotalDiscountedRevenue', 'PotentialRevenue', 'AvgSales', 'RevenueLossFromDiscount', 'DiscountROI', 'PriceRatingCorrelation', 'AvgPrice', 'AvgRating', 'AvgReviews', 'PriceRatingRelationship', 'TotalReviews', 'TotalSales_review', 'AvgRating_review', 'HighRatingCount', 'ReviewToSalesRatio', 'CustomerEngagementLevel']
2024-12-19 13:25:16,742 - __main__ - INFO - Created advanced features. Shape: (13, 44)
2024-12-19 13:25:16,743 - __main__ - INFO - Number of numeric features: 23
2024-12-19 13:25:16,743 - __main__ - INFO - Number of categorical features: 3
2024-12-19 13:25:16,746 - __main__ - INFO - Training stacked model...
2024-12-19 13:25:16,797 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:25:16,818 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:25:16,823 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:25:16,831 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:25:16,848 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:25:16,848 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:25:16,857 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:25:16,868 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:25:16,874 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:25:16,882 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:25:16,891 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:25:16,900 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:25:16,918 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:25:16,928 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:25:16,953 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:25:16,957 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:25:16,983 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:25:18,533 - py4j.clientserver - INFO - Error while sending or receiving.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer
2024-12-19 13:25:18,535 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:25:18,535 - root - INFO - Exception while sending command.
Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [Errno 104] Connection reset by peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/venv/lib/python3.11/site-packages/py4j/clientserver.py", line 506, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending
2024-12-19 13:25:18,537 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-19 13:25:20,643 - __main__ - INFO - Model Performance:
2024-12-19 13:25:20,644 - __main__ - INFO - RÂ² score: -382.1244
2024-12-19 13:25:20,644 - __main__ - INFO - MSE: 7083544.9982
2024-12-19 13:25:20,644 - __main__ - INFO - RMSE: 2661.4930
2024-12-19 13:25:20,644 - __main__ - INFO - MAE: 2061.1841
2024-12-19 13:25:20,646 - __main__ - WARNING - Feature importance length mismatch: 3 vs 41
2024-12-19 13:25:20,649 - __main__ - INFO - 
Top 10 Most Important Features:
2024-12-19 13:25:20,650 - __main__ - INFO -                  feature  importance  importance_percentage
0           AveragePrice    0.569925              56.992526
2              AvgRating    0.397162              39.716232
1  AvgDiscountPercentage    0.032912               3.291242
2024-12-19 13:25:20,872 - __main__ - INFO - Model saved to /home/zaki/kuliah/Bigdata/FP-5/data-lakehouse-fp-big-data/src/models/training/trained_models/sales_predictor.joblib
2024-12-19 13:25:21,455 - py4j.clientserver - INFO - Closing down clientserver connection
